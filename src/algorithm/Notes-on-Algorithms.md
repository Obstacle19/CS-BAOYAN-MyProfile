# Acwing\_ç®—æ³•åŸºç¡€è¯¾\_ç¬”è®°

<font size=5>***Yoo, I'm MiTaoMao***ğŸ‘‹</font>

[TOC]

# åŸºç¡€ç®—æ³•

## 1. å¿«é€Ÿæ’åº

### 1.1 å¿«é€Ÿæ’åº

> **é¢˜ç›®**

ç»™å®šä½ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°æ•°åˆ—ã€‚

è¯·ä½ ä½¿ç”¨å½’å¹¶æ’åºå¯¹è¿™ä¸ªæ•°åˆ—æŒ‰ç…§ä»å°åˆ°å¤§è¿›è¡Œæ’åºã€‚

å¹¶å°†æ’å¥½åºçš„æ•°åˆ—æŒ‰é¡ºåºè¾“å‡ºã€‚

**è¾“å…¥æ ¼å¼**

è¾“å…¥å…±ä¸¤è¡Œï¼Œç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼ˆæ‰€æœ‰æ•´æ•°å‡åœ¨ $1âˆ¼10^9$ èŒƒå›´å†…ï¼‰ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°åˆ—ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…±ä¸€è¡Œï¼ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ’å¥½åºçš„æ•°åˆ—ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
3 1 2 4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 2 3 4 5
```

> **è§£æ**

é¦–å…ˆè®¾å®šä¸€ä¸ª**åˆ†ç•Œå€¼**ï¼ˆè¿™é‡Œé€‰çš„æ˜¯**ä¸­ç‚¹**é‚£ä¸ªæ•°ï¼‰ï¼Œé€šè¿‡è¯¥åˆ†ç•Œå€¼å°†æ•°ç»„åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ã€‚ï¼ˆåˆ†ç•Œå€¼ä¹Ÿå¯ä»¥ç§»åŠ¨ï¼ï¼‰

**å°†å¤§äºæˆ–ç­‰äºåˆ†ç•Œå€¼çš„æ•°æ®é›†ä¸­åˆ°æ•°ç»„å³è¾¹ï¼Œå°äºåˆ†ç•Œå€¼çš„æ•°æ®é›†ä¸­åˆ°æ•°ç»„çš„å·¦è¾¹**ã€‚æ­¤æ—¶ï¼Œå·¦è¾¹éƒ¨åˆ†ä¸­å„å…ƒç´ éƒ½å°äºåˆ†ç•Œå€¼ï¼Œè€Œå³è¾¹éƒ¨åˆ†ä¸­å„å…ƒç´ éƒ½å¤§äºæˆ–ç­‰äºåˆ†ç•Œå€¼ã€‚

å·¦è¾¹å’Œå³è¾¹çš„æ•°æ®å¯ä»¥ç‹¬ç«‹æ’åºã€‚å¯¹äºå·¦ä¾§çš„æ•°ç»„æ•°æ®ï¼Œåˆå¯ä»¥å–ä¸€ä¸ªåˆ†ç•Œå€¼ï¼Œå°†è¯¥éƒ¨åˆ†æ•°æ®åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼ŒåŒæ ·åœ¨å·¦è¾¹æ”¾ç½®è¾ƒå°å€¼ï¼Œå³è¾¹æ”¾ç½®è¾ƒå¤§å€¼ã€‚å³ä¾§çš„æ•°ç»„æ•°æ®ä¹Ÿå¯ä»¥åšç±»ä¼¼å¤„ç†ã€‚é‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 100010;
int q[N];
void quick_sort(int q[], int l, int r)
{
    if (l >= r) return;
    int i = l - 1, j = r + 1, x = q[l + r >> 1]; // é€‰å–åˆ†ç•Œçº¿ã€‚è¿™é‡Œé€‰æ•°ç»„ä¸­é—´é‚£ä¸ªæ•°
    while (i < j)
    {
        do i ++; while (q[i] < x);
        do j --; while (q[j] > x);
        if (i < j) swap(q[i], q[j]);
    }
    quick_sort(q, l, j); // æ³¨æ„è¾¹ç•Œæ˜¯ j ,æ¢æˆ i ä¼šæŠ¥é”™
    quick_sort(q, j + 1, r);
}
int main()
{
    int n;
    cin >> n;
    for (int i = 0; i < n; i ++) cin >> q[i];
    quick_sort(q, 0, n - 1);
    for (int i = 0; i < n; i ++) cout << q[i] << " ";
    return 0;
}
```

## 2. å½’å¹¶æ’åº

### 2.1 å½’å¹¶æ’åº

> **é¢˜ç›®**

ç»™å®šä½ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°æ•°åˆ—ã€‚

è¯·ä½ ä½¿ç”¨å½’å¹¶æ’åºå¯¹è¿™ä¸ªæ•°åˆ—æŒ‰ç…§ä»å°åˆ°å¤§è¿›è¡Œæ’åºã€‚

å¹¶å°†æ’å¥½åºçš„æ•°åˆ—æŒ‰é¡ºåºè¾“å‡ºã€‚

**è¾“å…¥æ ¼å¼**

è¾“å…¥å…±ä¸¤è¡Œï¼Œç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼ˆæ‰€æœ‰æ•´æ•°å‡åœ¨ $1âˆ¼10^9$ èŒƒå›´å†…ï¼‰ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°åˆ—ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…±ä¸€è¡Œï¼ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ’å¥½åºçš„æ•°åˆ—ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
3 1 2 4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 2 3 4 5
```

> **è§£æ**

ç®—æ³•æ€æƒ³ï¼š**åˆ†æ²»æ³•**ã€**åŒæŒ‡é’ˆç®—æ³•**

- ç®—æ³•ç¬¬äºŒæ­¥ `é€’å½’å¤„ç†å­é—®é¢˜` ä¸º `åˆ†æ²»æ³•`
- ç®—æ³•ç¬¬ä¸‰æ­¥ `åˆå¹¶å­é—®é¢˜` ä¸­çš„ `i = l, j = mid + 1` ä¸º `åŒæŒ‡é’ˆç®—æ³•`

![3.gif](/figs/merge_sort)

> **ä»£ç æ¨¡æ¿**

```c++
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1e5 + 10;
int a[N], tmp[N];
void merge_sort(int q[], int l, int r)
{
	// é€’å½’çš„ç»ˆæ­¢æƒ…å†µ
    if (l >= r) return; 
    // ç¬¬ä¸€æ­¥ï¼šåˆ†æˆå­é—®é¢˜ 
    int mid = l + r >> 1;
    // ç¬¬äºŒæ­¥ï¼šé€’å½’å¤„ç†å­é—®é¢˜ 
    merge_sort(q, l, mid), merge_sort(q, mid + 1, r); // ç›´åˆ°æŠŠä¸¤ä¸ªåŒºé—´ä¹‹é—´çš„æ¯”è¾ƒç»†åˆ†æˆä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„æ¯”è¾ƒ
	// ç¬¬ä¸‰æ­¥ï¼šåˆå¹¶å­é—®é¢˜ 
    int k = 0, i = l, j = mid + 1;
    while (i <= mid && j <= r) // è¿™æ—¶å€™ï¼Œé—®é¢˜ç®€åŒ–æˆäº†ä¸¤ä¸ªå„è‡ªæœ‰åºé€’å¢çš„å­åŒºé—´ä¹‹é—´çš„æ’åº 
        if (q[i] <= q[j]) tmp[k ++ ] = q[i ++];
        else tmp[k ++] = q[j ++];
    while (i <= mid) tmp[k ++] = q[i ++]; // å³åŠéƒ¨åˆ†éƒ½å¡«å……åˆ°äº†tmpä¸­ï¼Œè€Œå·¦åŠéƒ¨åˆ†æœªå¡«å……å®Œæ¯• 
    while (j <= r) tmp[k ++] = q[j ++]; // å·¦åŠéƒ¨åˆ†éƒ½å¡«å……åˆ°äº†tmpä¸­ï¼Œè€Œå³åŠéƒ¨åˆ†æœªå¡«å……å®Œæ¯• 
    for (i = l, j = 0; i <= r; i ++, j ++) q[i] = tmp[j]; // å°†tmpæœ‰åºå¡«å……åˆ°qæ•°ç»„ä¸­ 
}
int main()
{
    ll n;
    cin>>n;
    for (int i = 0; i < n; i ++ ) cin>>a[i];
    merge_sort(a, 0, n - 1);
    for (int i = 0; i < n; i ++ ) cout<<a[i]<<" ";
    return 0;
}
```

## 3. äºŒåˆ†

### 3.1 æ•°çš„èŒƒå›´

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªæŒ‰ç…§å‡åºæ’åˆ—çš„é•¿åº¦ä¸º $n$ çš„æ•´æ•°æ•°ç»„ï¼Œä»¥åŠ $q$ ä¸ªæŸ¥è¯¢ã€‚

å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªå…ƒç´  $k$ çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ï¼ˆä½ç½®ä» $0$ å¼€å§‹è®¡æ•°ï¼‰ã€‚

å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨è¯¥å…ƒç´ ï¼Œåˆ™è¿”å› `-1 -1`ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $q$ï¼Œè¡¨ç¤ºæ•°ç»„é•¿åº¦å’Œè¯¢é—®ä¸ªæ•°ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼ˆå‡åœ¨ $1âˆ¼10000$ èŒƒå›´å†…ï¼‰ï¼Œè¡¨ç¤ºå®Œæ•´æ•°ç»„ã€‚

æ¥ä¸‹æ¥ $q$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $k$ï¼Œè¡¨ç¤ºä¸€ä¸ªè¯¢é—®å…ƒç´ ã€‚

**è¾“å‡ºæ ¼å¼**

å…± $q$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€æ±‚å…ƒç´ çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ã€‚

å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨è¯¥å…ƒç´ ï¼Œåˆ™è¿”å› `-1 -1`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100000$
$1â‰¤qâ‰¤10000$
$1â‰¤kâ‰¤10000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
6 3
1 2 2 3 3 4
3
4
5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3 4
5 5
-1 -1
```

> **ä»£ç æ¨¡æ¿**

```c++
#include <bits/stdc++.h>
using namespace std;
const int N = 100010;
int a[N];
int bsearch_1(int l, int r, int x) //æŸ¥æ‰¾é¦–æ¬¡å‡ºç°ï¼ˆæœ€å·¦è¾¹ï¼‰
{
	while(l < r)
	{
		int mid = l + r >> 1;
		if(a[mid] >= x)
		{
			r = mid;
		}
		else l = mid + 1;
	}
	return l;
}
int bsearch_2(int l, int r, int x) //æŸ¥æ‰¾æœ€åä¸€æ¬¡å‡ºç°ï¼ˆæœ€å³è¾¹ï¼‰
{
	while(l < r)
	{
		int mid = l + r + 1 >> 1;
		if(a[mid] <= x)
		{
			l = mid;
		}
		else r = mid - 1;
	}
	return l;
}
int main()
{
	int n, q, k, left, right;
	cin >> n >> q;
	for(int i = 0; i < n; i ++)
	{
		cin >> a[i];
	}
	while(q --)
	{
		cin >> k;
		left = bsearch_1(0, n - 1, k);
		right = bsearch_2(0, n - 1, k);
		if(a[left] != k)
		{
			cout << "-1 -1" << endl;
			continue;
		}
		cout << left << " " << right << endl;
	}
	return 0;
} 
```

**åº“å‡½æ•°æ³•ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int a[N];
int main()
{
	int n, q, k, left, right;
	cin >> n >> q;
	for(int i = 0; i < n; i ++) cin >> a[i];
	while(q --)
	{
		cin >> k;
		left = lower_bound(a, a + n, k) - a;
		right = upper_bound(a, a + n, k) - a - 1;
		if(a[left] != k)
		{
			cout << "-1 -1" << endl;
			continue;
		}
		cout << left << " " << right << endl;
	}
	return 0;
} 
```

### 3.2 æ•°çš„ä¸‰æ¬¡æ–¹æ ¹

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªæµ®ç‚¹æ•° $n$ï¼Œæ±‚å®ƒçš„ä¸‰æ¬¡æ–¹æ ¹ã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæµ®ç‚¹æ•° $n$ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºé—®é¢˜çš„è§£ã€‚

æ³¨æ„ï¼Œç»“æœä¿ç•™ $6$ ä½å°æ•°ã€‚

**æ•°æ®èŒƒå›´**

$âˆ’10000â‰¤nâ‰¤10000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
1000.00
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
10.000000
```

> **ä»£ç æ¨¡æ¿**

```c++
#include <bits/stdc++.h>
using namespace std;
int main()
{
	double x;
	cin >> x;
	double l = -10000, r = 10000;
	while(r - l > 1e-8)
	{
		double mid = (l + r) / 2;
		if(pow(mid, 3) >= x)
		{
			r = mid;
		}
		else l = mid;
	}
	cout << fixed << setprecision(6) << l << endl;
	system("pause");
	return 0;
 } 
```

## 4. å‰ç¼€å’Œä¸å·®åˆ†

### 4.1 å‰ç¼€å’Œ

> **é¢˜ç›®**

è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ—ã€‚

æ¥ä¸‹æ¥å†è¾“å…¥ $m$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®è¾“å…¥ä¸€å¯¹ $l,r$ã€‚

å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºåŸåºåˆ—ä¸­ä»ç¬¬ $l$ ä¸ªæ•°åˆ°ç¬¬ $r$ ä¸ªæ•°çš„å’Œã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°æ•°åˆ—ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $l$ å’Œ $r$ï¼Œè¡¨ç¤ºä¸€ä¸ªè¯¢é—®çš„åŒºé—´èŒƒå›´ã€‚

**è¾“å‡ºæ ¼å¼**

å…± $m$ è¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªè¯¢é—®çš„ç»“æœã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤lâ‰¤râ‰¤n,$
$1â‰¤n,mâ‰¤100000,$
$âˆ’1000â‰¤æ•°åˆ—ä¸­å…ƒç´ çš„å€¼â‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5 3
2 1 3 6 4
1 2
1 3
2 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
6
10
```

> **è§£æ**

**ä¸€ç»´å‰ç¼€å’Œ**ï¼š

$S[i]=a[1]+a[2]+â€¦â€¦+a[2]$

$a[l]+â€¦â€¦+a[r]=S[r]-S[l-1]$

- å¦‚ä½•æ±‚ $S_i$ï¼š`for i = 1; i <= n; i ++`

  â€‹                     $S[i]=S[i-1]+a_i$ ï¼ˆé»˜è®¤ $S[0]=0$ ï¼‰

- ä½œç”¨ï¼š$[l,r]$ ä¸€æ®µæ•°çš„å’Œä¸ºï¼š $S_r-S_{l-1}$

  â€‹            $S_r=a_1+a_2+â€¦â€¦+a_{l-1}+a_l+â€¦â€¦+a_r$

  â€‹            $S_{l-1}=a_1+a_2+â€¦â€¦+a_{l-1}$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n, m;
int a[N], s[N];
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++)
    {
    	cin >> a[i];
    	s[i] = a[i] + s[i - 1];
	}
    while (m --)
    {
        int l, r;
        cin >> l >> r;
        cout << s[r] - s[l - 1] << endl; // åŒºé—´å’Œçš„è®¡ç®—
    }
    return 0;
}
```

### 4.2 å­çŸ©é˜µçš„å’Œ

> **é¢˜ç›®**

è¾“å…¥ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„æ•´æ•°çŸ©é˜µï¼Œå†è¾“å…¥ $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®åŒ…å«å››ä¸ªæ•´æ•° $x_1,y_1,x_2,y_2$ï¼Œè¡¨ç¤ºä¸€ä¸ªå­çŸ©é˜µçš„å·¦ä¸Šè§’åæ ‡å’Œå³ä¸‹è§’åæ ‡ã€‚

å¯¹äºæ¯ä¸ªè¯¢é—®è¾“å‡ºå­çŸ©é˜µä¸­æ‰€æœ‰æ•°çš„å’Œã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $nï¼Œmï¼Œq$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $m$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°çŸ©é˜µã€‚

æ¥ä¸‹æ¥ $q$ è¡Œï¼Œæ¯è¡ŒåŒ…å«å››ä¸ªæ•´æ•° $x_1,y_1,x_2,y_2$ï¼Œè¡¨ç¤ºä¸€ç»„è¯¢é—®ã€‚

**è¾“å‡ºæ ¼å¼**

å…± $q$ è¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªè¯¢é—®çš„ç»“æœã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤1000,$
$1â‰¤qâ‰¤200000,$
$1â‰¤x_1â‰¤x_2â‰¤n,$
$1â‰¤y_1â‰¤y_2â‰¤m,$
$âˆ’1000â‰¤çŸ©é˜µå†…å…ƒç´ çš„å€¼â‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 4 3
1 7 2 4
3 6 2 8
2 1 2 3
1 1 2 2
2 1 3 4
1 3 3 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
17
27
21
```

> **è§£æ**

**äºŒç»´å‰ç¼€å’Œ**ï¼š

$S[i][j]=ç¬¬iè¡Œç¬¬jåˆ—æ ¼å­å·¦ä¸Šéƒ¨åˆ†æ‰€æœ‰å…ƒç´ çš„å’Œ$

$ä»¥(x_1,y_1)ä¸ºå·¦ä¸Šè§’ï¼Œ(x_2,y_2)ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µçš„å’Œä¸ºï¼šS[x_2,y_2]-S[x_1-1,y2]-S[x_2,y_1-1]+S[x_1-1,y_1-1]$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N=1010;
int s[N][N];
int n,m,q;
int main()
{
	cin >> n >> m >> q;
	for(int i = 1; i <= n; i ++)
	{
		for(int j = 1; j <= m; j ++)
		{
			cin >> s[i][j];
			s[i][j] += s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1];
		}
	}
	while(q --)
	{
		int x1, x2, y1, y2;
		cin >> x1 >> y1 >> x2 >> y2;
		cout << s[x2][y2] - s[x1 - 1][y2] - s[x2][y1 - 1] + s[x1 - 1][y1 - 1] << endl; 
	}
	return 0;
}
```

### 4.3 å·®åˆ†

> **é¢˜ç›®**

è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ—ã€‚

æ¥ä¸‹æ¥è¾“å…¥ $m$ ä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œåŒ…å«ä¸‰ä¸ªæ•´æ•° $l,r,c$ï¼Œè¡¨ç¤ºå°†åºåˆ—ä¸­ $[l,r]$ ä¹‹é—´çš„æ¯ä¸ªæ•°åŠ ä¸Š $c$ã€‚

è¯·ä½ è¾“å‡ºè¿›è¡Œå®Œæ‰€æœ‰æ“ä½œåçš„åºåˆ—ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°åºåˆ—ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $lï¼Œrï¼Œc$ï¼Œè¡¨ç¤ºä¸€ä¸ªæ“ä½œã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€ç»ˆåºåˆ—ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤100000,$
$1â‰¤lâ‰¤râ‰¤n,$
$âˆ’1000â‰¤câ‰¤1000,$
$âˆ’1000â‰¤æ•´æ•°åºåˆ—ä¸­å…ƒç´ çš„å€¼â‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
6 3
1 2 2 1 2 1
1 3 1
3 5 1
1 6 1
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3 4 5 3 4 2
```

> **è§£æ**

**ä¸€ç»´å·®åˆ†**ï¼š

æ„é€  $b_1,b_2â€¦â€¦b_n$

ä½¿å¾— $a_i=b_1+b_2+â€¦â€¦+b_i$ ï¼Œ$b$ ç§°ä¸º $a$ çš„å·®åˆ†ï¼Œ$a$ ä¸º $b$ çš„å‰ç¼€å’Œ

å³ $b_1=a_1,b_2=a_2-a_1,b_3=a_3-a_2 â€¦â€¦ b_n=a_n-a_{n-1}$

ç»™åŒºé—´ $[l,r]$ ä¸­çš„æ¯ä¸ªæ•°åŠ ä¸Š $c$ ï¼Œåªéœ€è¦ä¿®æ”¹ä¸¤ä¸ªæ•°ï¼š`b[l] += c, b[r + 1] -= c`

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n, m;
int a[N], b[N];
void insert(int l, int r, int c)
{
	b[l] += c, b[r + 1] -= c;
}
int main()
{
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> a[i];
		insert(i, i, a[i]); // b å˜æˆ a çš„å·®åˆ† 
	}
	while(m --)
	{
		int l, r, c;
		cin >> l >> r >> c;
		insert(l, r, c); // å¯¹å·®åˆ†æ•°ç»„ b è¿›è¡Œæ“ä½œ 
	}
	for(int i = 1; i <= n; i ++)
	{
		b[i] += b[i - 1]; // å°† b å˜ä¸ºè‡ªå·±çš„å‰ç¼€å’Œ 
		cout << b[i] << " ";
	}
	return 0;
}
```

### 4.4 å·®åˆ†çŸ©é˜µ

> **é¢˜ç›®**

è¾“å…¥ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„æ•´æ•°çŸ©é˜µï¼Œå†è¾“å…¥ $q$ ä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œåŒ…å«äº”ä¸ªæ•´æ•° $x_1,y_1,x_2,y_2,c$ï¼Œå…¶ä¸­ $(x_1,y_1)$ å’Œ $(x_2,y_2)$ è¡¨ç¤ºä¸€ä¸ªå­çŸ©é˜µçš„å·¦ä¸Šè§’åæ ‡å’Œå³ä¸‹è§’åæ ‡ã€‚

æ¯ä¸ªæ“ä½œéƒ½è¦å°†é€‰ä¸­çš„å­çŸ©é˜µä¸­çš„æ¯ä¸ªå…ƒç´ çš„å€¼åŠ ä¸Š $c$ã€‚

è¯·ä½ å°†è¿›è¡Œå®Œæ‰€æœ‰æ“ä½œåçš„çŸ©é˜µè¾“å‡ºã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n,m,q$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $m$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°çŸ©é˜µã€‚

æ¥ä¸‹æ¥ $q$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $5$ ä¸ªæ•´æ•° $x_1,y_1,x_2,y_2,c$ï¼Œè¡¨ç¤ºä¸€ä¸ªæ“ä½œã€‚

**è¾“å‡ºæ ¼å¼**

å…± $n$ è¡Œï¼Œæ¯è¡Œ $m$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€æœ‰æ“ä½œè¿›è¡Œå®Œæ¯•åçš„æœ€ç»ˆçŸ©é˜µã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤1000,$
$1â‰¤qâ‰¤100000,$
$1â‰¤x_1â‰¤x_2â‰¤n,$
$1â‰¤y_1â‰¤y_2â‰¤m,$
$âˆ’1000â‰¤câ‰¤1000,$
$âˆ’1000â‰¤çŸ©é˜µå†…å…ƒç´ çš„å€¼â‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 4 3
1 2 2 1
3 2 2 1
1 1 1 1
1 1 2 2 1
1 3 2 3 2
3 1 3 4 1
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2 3 4 1
4 3 4 1
2 2 2 2
```

> **è§£æ**

**äºŒç»´å·®åˆ†**ï¼š

ç»™ä»¥ $(x_1,y_1)$ ä¸ºå·¦ä¸Šè§’ï¼Œ $(x_2,y_2)$ ä¸ºå³ä¸‹è§’çš„å­çŸ©é˜µä¸­æ‰€æœ‰å…ƒç´ åŠ ä¸Š $c$ ï¼š

$S[x_1,y_1]+=c,$
$S[x_2+1,y_1]-=c,$
$S[x_1,y_2+1]-=c,$
$S[x_2+1,y_2+1]+=c$

<img src="/figs/difference_matrix" alt="difference_matrix" style="zoom:50%;" />

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 1010;
int n, m, q;
int a[N][N], b[N][N];
void insert(int x1, int y1, int x2, int y2, int c)
{
    b[x1][y1] += c;
    b[x2 + 1][y1] -= c;
    b[x1][y2 + 1] -= c;
    b[x2 + 1][y2 + 1] += c;
}
int main()
{
    cin >> n >> m >> q;
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++ )
    	{
    		cin >> a[i][j];
		}
	}
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++ )
    	{
    		insert(i, j, i, j, a[i][j]);
		}
	}
    while (q --)
    {
        int x1, y1, x2, y2, c;
        cin >> x1 >> y1 >> x2 >> y2 >> c;
        insert(x1, y1, x2, y2, c);
    }
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++ )
    	{
    		b[i][j] += b[i - 1][j] + b[i][j - 1] - b[i - 1][j - 1]; // b å˜ä¸ºè‡ªå·±çš„å‰ç¼€å’Œ 
		}
	}
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++ )
    	{
    		cout << b[i][j] << " ";
		}
		cout << endl;
	}
   return 0;
}
```

## 5. ä½è¿ç®—

### 5.1 äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°åˆ—ï¼Œè¯·ä½ æ±‚å‡ºæ•°åˆ—ä¸­æ¯ä¸ªæ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ $1$ çš„ä¸ªæ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°åˆ—ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œå…¶ä¸­çš„ç¬¬ $i$ ä¸ªæ•°è¡¨ç¤ºæ•°åˆ—ä¸­çš„ç¬¬ $i$ ä¸ªæ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ $1$ çš„ä¸ªæ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100000,$
$0â‰¤æ•°åˆ—ä¸­å…ƒç´ çš„å€¼â‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
1 2 3 4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 1 2 1 2
```

> **è§£æ**

ä½è¿ç®—ï¼š

**æ±‚ $n$ çš„ç¬¬ $k$ ä½æ•°å­—**ï¼š$n>>k\&1$

**è¿”å› $n$ çš„æœ€åä¸€ä½ $1$** ï¼š$lowbit(n)=n\&n$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
int lowbit(int x){
	return x & -x;
}
int main()
{
	int n;
	cin >> n;
	while(n --)
	{
		int x; 
		cin >> x;
		int res = 0;
		while(x)
		{
			x -= lowbit(x);
			res ++;
		}
		cout << res << " ";
	}
	return 0;
} 
```

### 5.2 64ä½æ•´æ•°ä¹˜æ³•

> **é¢˜ç›®**

æ±‚ $a$ ä¹˜ $b$ å¯¹ $p$ å–æ¨¡çš„å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $a$ï¼Œç¬¬äºŒè¡Œè¾“å…¥æ•´æ•° $b$ï¼Œç¬¬ä¸‰è¡Œè¾“å…¥æ•´æ•° $p$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º`a * b mod p`çš„å€¼ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤a,b,pâ‰¤10^{18}$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
4
5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
ll qadd(ll a, ll b, ll p) // quick add
{
    ll res = 0;
    while (b)
    {
        if (b & 1) res = (res + a) % p;
        a = (a + a) % p;
        b >>= 1;
    }
    return res;
}
int main()
{
    ll a, b, p;
    cin >> a >> b >> p;
    cout << qadd(a, b, p) << endl;
    return 0;
}
```

# æ•°æ®ç»“æ„

## 1. å•é“¾è¡¨

### 1.1 å•é“¾è¡¨

> **é¢˜ç›®**

å®ç°ä¸€ä¸ªå•é“¾è¡¨ï¼Œé“¾è¡¨åˆå§‹ä¸ºç©ºï¼Œæ”¯æŒä¸‰ç§æ“ä½œï¼š

1. å‘é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•°ï¼›
2. åˆ é™¤ç¬¬ $k$ ä¸ªæ’å…¥çš„æ•°åé¢çš„ä¸€ä¸ªæ•°ï¼›
3. åœ¨ç¬¬ $k$ ä¸ªæ’å…¥çš„æ•°åæ’å…¥ä¸€ä¸ªæ•°ã€‚

ç°åœ¨è¦å¯¹è¯¥é“¾è¡¨è¿›è¡Œ $M$ æ¬¡æ“ä½œï¼Œè¿›è¡Œå®Œæ‰€æœ‰æ“ä½œåï¼Œä»å¤´åˆ°å°¾è¾“å‡ºæ•´ä¸ªé“¾è¡¨ã€‚

**æ³¨æ„**ï¼šé¢˜ç›®ä¸­ç¬¬ $k$ ä¸ªæ’å…¥çš„æ•°å¹¶ä¸æ˜¯æŒ‡å½“å‰é“¾è¡¨çš„ç¬¬ $k$ ä¸ªæ•°ã€‚ä¾‹å¦‚æ“ä½œè¿‡ç¨‹ä¸­ä¸€å…±æ’å…¥äº† $n$ ä¸ªæ•°ï¼Œåˆ™æŒ‰ç…§æ’å…¥çš„æ—¶é—´é¡ºåºï¼Œè¿™ $n$ ä¸ªæ•°ä¾æ¬¡ä¸ºï¼šç¬¬ $1$ ä¸ªæ’å…¥çš„æ•°ï¼Œç¬¬ $2$ ä¸ªæ’å…¥çš„æ•°ï¼Œâ€¦ç¬¬ $n$ ä¸ªæ’å…¥çš„æ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $M$ï¼Œè¡¨ç¤ºæ“ä½œæ¬¡æ•°ã€‚

æ¥ä¸‹æ¥ $M$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ“ä½œå‘½ä»¤ï¼Œæ“ä½œå‘½ä»¤å¯èƒ½ä¸ºä»¥ä¸‹å‡ ç§ï¼š

1. `H x`ï¼Œè¡¨ç¤ºå‘é“¾è¡¨å¤´æ’å…¥ä¸€ä¸ªæ•° $x$ã€‚
2. `D k`ï¼Œè¡¨ç¤ºåˆ é™¤ç¬¬ $k$ ä¸ªæ’å…¥çš„æ•°åé¢çš„æ•°ï¼ˆå½“ $k$ ä¸º $0$ æ—¶ï¼Œè¡¨ç¤ºåˆ é™¤å¤´ç»“ç‚¹ï¼‰ã€‚
3. `I k x`ï¼Œè¡¨ç¤ºåœ¨ç¬¬ $k$ ä¸ªæ’å…¥çš„æ•°åé¢æ’å…¥ä¸€ä¸ªæ•° $x$ï¼ˆæ­¤æ“ä½œä¸­ $k$ å‡å¤§äº 00ï¼‰ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼Œå°†æ•´ä¸ªé“¾è¡¨ä»å¤´åˆ°å°¾è¾“å‡ºã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Mâ‰¤100000$
æ‰€æœ‰æ“ä½œä¿è¯åˆæ³•ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
10
H 9
I 1 1
D 1
D 0
H 6
I 3 6
I 4 5
I 4 5
I 3 4
D 6
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
6 4 6 5
```

> **è§£æ**

å®ç°æ–¹å¼ä¸º**ç”¨æ•°ç»„æ¨¡æ‹Ÿé“¾è¡¨ä¸é‚»æ¥è¡¨**ã€‚å¦‚æœç”¨ç»“æ„ä½“å’ŒæŒ‡é’ˆå®ç°é“¾è¡¨çš„è¯ï¼Œä¼šéå¸¸æ…¢ï¼ˆé¢è¯•ä¸­å¸¸ç”¨ç»“æ„ä½“å’ŒæŒ‡é’ˆï¼Œæœºè¯•ä¸­è¿˜æ˜¯ç”¨æ•°ç»„ï¼‰

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
// head è¡¨ç¤ºå¤´ç»“ç‚¹çš„ä¸‹æ ‡
// e[i] è¡¨ç¤ºèŠ‚ç‚¹ i çš„å€¼
// ne[i] è¡¨ç¤ºèŠ‚ç‚¹ i çš„ next æŒ‡é’ˆæ˜¯å¤šå°‘
// idx å­˜å‚¨å½“å‰å·²ç»ç”¨åˆ°äº†å“ªä¸ªç‚¹
int head, e[N], ne[N], idx;
// åˆå§‹åŒ–
void init()
{
    head = -1;
    idx = 0;
}
// å°† x æ’åˆ°å¤´ç»“ç‚¹
void add_to_head(int x)
{
    e[idx] = x, ne[idx] = head, head = idx ++;
}
// å°† x æ’åˆ°ä¸‹æ ‡æ˜¯ k çš„ç‚¹åé¢
void add(int k, int x)
{
    e[idx] = x, ne[idx] = ne[k], ne[k] = idx ++;
}
// å°†ä¸‹æ ‡æ˜¯ k çš„ç‚¹åé¢çš„ç‚¹åˆ æ‰
void remove(int k)
{
    ne[k] = ne[ne[k]];
}
int main()
{
    int m;
    cin >> m;
    init();
    while (m --)
    {
        int k, x;
        char op;
        cin >> op;
        if (op == 'H')
        {
            cin >> x;
            add_to_head(x);
        }
        else if (op == 'D')
        {
            cin >> k;
            if (!k) head = ne[head];
            else remove(k - 1);
        }
        else
        {
            cin >> k >> x;
            add(k - 1, x);
        }
    }
    for (int i = head; i != -1; i = ne[i]) cout << e[i] << ' ';
    cout << endl;
    return 0;
}
```

## 2. å•è°ƒæ ˆ

### 2.1 å•è°ƒæ ˆ

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„æ•´æ•°æ•°åˆ—ï¼Œè¾“å‡ºæ¯ä¸ªæ•°å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„æ•°ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¾“å‡º $âˆ’1$ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºæ•°åˆ—é•¿åº¦ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $N$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°æ•°åˆ—ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å« $N$ ä¸ªæ•´æ•°ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªæ•°è¡¨ç¤ºç¬¬ $i$ ä¸ªæ•°çš„å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„æ•°ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¾“å‡º $âˆ’1$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5$
$1â‰¤æ•°åˆ—ä¸­å…ƒç´ â‰¤10^9$S

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
3 4 2 7 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
-1 3 -1 2 2
```

> **è§£æ**

å•è°ƒæ ˆå³æ ˆé‡Œé¢çš„å…ƒç´ å…·æœ‰**å•è°ƒæ€§**

å¯¹äºè¿™é¢˜ç”¨**å•è°ƒé€’å¢æ ˆ**ï¼Œå½“è¯¥å…ƒç´ å¯ä»¥å…¥æ ˆçš„æ—¶å€™ï¼Œæ ˆé¡¶å…ƒç´ å°±æ˜¯å®ƒå·¦ä¾§ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„å…ƒç´ 

è¿™ä¸ªå•è°ƒé€’å¢æ ˆæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

- ä»æ ˆåº•å…ƒç´ åˆ°æ ˆé¡¶å…ƒç´ å•è°ƒé€’å¢
- éå†å®Œæ¯•æ•°ç»„ä¸‹æ ‡ $i$ æ—¶ï¼Œ $a[i]$ ä¸€å®šåœ¨æ ˆé¡¶

åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªä»æ ˆåº•å…ƒç´ åˆ°æ ˆé¡¶å…ƒç´ å•è°ƒé€’å¢çš„æ ˆï¼Œæ¯æ¬¡ä¸ç¬¦åˆå•è°ƒæ€§å°±å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæœ€åè¾“å‡ºæ ˆé¡¶å…ƒç´ å³å¯

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int stk[N], tt; // tt ä¸ºæ ˆé¡¶æŒ‡é’ˆ
int main() // å› ä¸ºè¿™é¢˜æ˜¯æ‰¾å‡ºå·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”ä»–å°çš„æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢ï¼ˆä¸å¯ä»¥ç›¸ç­‰ï¼‰çš„å•è°ƒæ ˆ 
{
    int n;
    cin >> n;
    while (n --)
    {
        int x;
        cin >> x;
        while (tt && stk[tt] >= x) tt --; // å¦‚æœæ ˆé¡¶å…ƒç´ æ¯”æƒ³è¦æ–°å…¥æ ˆçš„å…ƒç´ è¿˜å¤§æˆ–è€…ç›¸ç­‰ï¼Œé‚£ä¹ˆä¸€ç›´å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œç›´åˆ°æ ˆé¡¶å…ƒç´ æ¯”å®ƒå°
        if (!tt) cout << "-1" << " "; // å¦‚æœ tt å‡åˆ° 0 äº†ï¼Œè¯´æ˜æ ˆç©ºäº†ï¼Œæ²¡æœ‰æ–°å…¥æ ˆçš„å…ƒç´ è¿˜å°çš„äº†
        else cout << stk[tt] << " "; // å¦‚æœ tt > 0 ï¼Œè¾“å‡º tt ä½ç½®çš„å…ƒç´ ï¼ˆæ ˆé¡¶å…ƒç´ ï¼‰å³ä¸ºç­”æ¡ˆ
        stk[++ tt] = x; // æƒ³è¦æ–°å…¥æ ˆçš„å…ƒç´ å¯ä»¥å…¥æ ˆäº†
    }
    return 0;
}
```

## 3. å•è°ƒé˜Ÿåˆ—

### 3.1 æ»‘åŠ¨çª—å£

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªå¤§å°ä¸º $nâ‰¤10^6$ çš„æ•°ç»„ã€‚

æœ‰ä¸€ä¸ªå¤§å°ä¸º $k$ çš„æ»‘åŠ¨çª—å£ï¼Œå®ƒä»æ•°ç»„çš„æœ€å·¦è¾¹ç§»åŠ¨åˆ°æœ€å³è¾¹ã€‚

ä½ åªèƒ½åœ¨çª—å£ä¸­çœ‹åˆ° $k$ ä¸ªæ•°å­—ã€‚

æ¯æ¬¡æ»‘åŠ¨çª—å£å‘å³ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

è¯¥æ•°ç»„ä¸º `[1 3 -1 -3 5 3 6 7]`ï¼Œ$k$ ä¸º $3$ã€‚

|      çª—å£ä½ç½®       | æœ€å°å€¼ | æœ€å¤§å€¼ |
| :-----------------: | :----: | :----: |
| [1 3 -1] -3 5 3 6 7 |   -1   |   3    |
| 1 [3 -1 -3] 5 3 6 7 |   -3   |   3    |
| 1 3 [-1 -3 5] 3 6 7 |   -3   |   5    |
| 1 3 -1 [-3 5 3] 6 7 |   -3   |   5    |
| 1 3 -1 -3 [5 3 6] 7 |   3    |   6    |
| 1 3 -1 -3 5 [3 6 7] |   3    |   7    |

ä½ çš„ä»»åŠ¡æ˜¯ç¡®å®šæ»‘åŠ¨çª—å£ä½äºæ¯ä¸ªä½ç½®æ—¶ï¼Œçª—å£ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚

**è¾“å…¥æ ¼å¼**

è¾“å…¥åŒ…å«ä¸¤è¡Œã€‚

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $k$ï¼Œåˆ†åˆ«ä»£è¡¨æ•°ç»„é•¿åº¦å’Œæ»‘åŠ¨çª—å£çš„é•¿åº¦ã€‚

ç¬¬äºŒè¡Œæœ‰ $n$ ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ•°ç»„çš„å…·ä½“æ•°å€¼ã€‚

åŒè¡Œæ•°æ®ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºåŒ…å«ä¸¤ä¸ªã€‚

ç¬¬ä¸€è¡Œè¾“å‡ºï¼Œä»å·¦è‡³å³ï¼Œæ¯ä¸ªä½ç½®æ»‘åŠ¨çª—å£ä¸­çš„æœ€å°å€¼ã€‚

ç¬¬äºŒè¡Œè¾“å‡ºï¼Œä»å·¦è‡³å³ï¼Œæ¯ä¸ªä½ç½®æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
8 3
1 3 -1 -3 5 3 6 7
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
-1 -3 -3 -3 3 3
3 3 5 5 6 7
```

> **è§£æ**

ä»¥**æŸ¥æ‰¾æœ€å°å€¼**ä¸ºä¾‹ï¼š

å¦‚æœ**å•è°ƒé˜Ÿåˆ—**ä¸­å­˜åœ¨ä¸¤ä¸ªå…ƒç´ ï¼Œæ»¡è¶³ $a[i] > a[j]$ ä¸” $i < j$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸ä¼šå– $a[i]$ ä½œä¸ºæœ€å°å€¼äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å°† $a[i]$ åˆ æ‰ï¼Œä»¥ç»´æŠ¤å•è°ƒé˜Ÿåˆ—çš„å•è°ƒé€’å¢æ€§ï¼ˆå¹¶éä¸¥æ ¼é€’å¢ï¼Œè€Œæ˜¯**å•è°ƒä¸å‡**ï¼‰

å•è°ƒé˜Ÿåˆ—ä¸­å…ƒç´ ç´¢å¼•ä¸å…ƒç´ å€¼å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="./figs/monotonic_queue" alt="img" style="zoom:80%;" />

æ¯æ¬¡æ»‘åŠ¨æ—¶ï¼Œé˜Ÿå¤´å…ƒç´ éƒ½ä¼šæ»‘å‡ºçª—å£èŒƒå›´ã€‚å…ˆåˆ¤æ–­é˜Ÿå¤´å…ƒç´ æ˜¯å¦è¿˜åœ¨å•è°ƒé˜Ÿåˆ—ä¸­ï¼Œè‹¥æ»¡è¶³ `q.front() == a[i - k]` ï¼Œåˆ™é˜Ÿå¤´å…ƒç´ å‡ºé˜Ÿï¼›å¦åˆ™è¯´æ˜é˜Ÿå¤´å…ƒç´ ä¹‹å‰å·²ç»å‡ºé˜Ÿè¿‡äº†ï¼Œæ— éœ€å†æ¬¡å‡ºé˜Ÿã€‚

æ­¤æ—¶é˜Ÿåˆ—ä¸­å‰©ä¸‹çš„å…ƒç´ å•è°ƒé€’å¢ï¼Œæ‰€ä»¥**é˜Ÿå¤´å°±æ˜¯æ•´ä¸ªé˜Ÿåˆ—ä¸­çš„æœ€å°å€¼**ï¼Œå¯ä»¥ç”¨ $O(1)$ çš„æ—¶é—´æ‰¾åˆ°

æŸ¥æ‰¾æœ€å¤§å€¼åŸç†åŒä¸Šï¼Œå°†å¤§äºå·æ”¹æˆå°äºå·å³å¯ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 1000010;
int a[N];
int main()
{
    int n, k;
    cin >> n >> k;
    for (int i = 1; i <= n; i ++) cin >> a[i]; // è¯»å…¥åŸæ•°ç»„ 
    deque<int> q; // ä½¿ç”¨ STL åŒç«¯é˜Ÿåˆ—æ¨¡æ‹Ÿå•è°ƒé˜Ÿåˆ— 
    // æœ€å°å€¼æƒ…å†µ 
    for(int i = 1; i <= n; i ++)
    {
        while(q.size() && q.back() > a[i]) q.pop_back(); // è‹¥æ–°è¿›å…¥çª—å£çš„å€¼å°äºé˜Ÿå°¾å…ƒç´ ï¼Œåˆ™é˜Ÿå°¾å‡ºé˜Ÿåˆ—ã€‚æ³¨æ„æ˜¯ä¸¥æ ¼å°äº 
        q.push_back(a[i]); // å°†æ–°è¿›å…¥çš„å…ƒç´ å…¥é˜Ÿ
        if(i - k >= 1 && q.front() == a[i - k]) q.pop_front(); // è‹¥é˜Ÿå¤´æ»‘å‡ºäº†çª—å£ï¼Œé˜Ÿå¤´å‡ºé˜Ÿã€‚å› ä¸ºä¹‹å‰æ˜¯ä¸¥æ ¼å°äºï¼Œæ‰€ä»¥é¿å…äº†è¯¯åˆ  
        if(i >= k) cout << q.front() << " "; // å½“çª—å£å½¢æˆï¼Œè¾“å‡ºé˜Ÿå¤´å¯¹åº”çš„å€¼
    }
    q.clear();
    cout << endl;
    // æœ€å¤§å€¼æƒ…å†µï¼ŒåŸç†åŒä¸Š 
    for(int i = 1; i <= n; i ++)
    {
        while(q.size() && q.back() < a[i]) q.pop_back();
        q.push_back(a[i]);
        if(i - k >= 1 && a[i - k] == q.front()) q.pop_front(); 
        if(i >= k) cout << q.front() << " ";
    }
    return 0; 
}
```

## 4. KMP

### 4.1 KMPå­—ç¬¦ä¸²

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $S$ï¼Œä»¥åŠä¸€ä¸ªæ¨¡å¼ä¸² $P$ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²ä¸­åªåŒ…å«å¤§å°å†™è‹±æ–‡å­—æ¯ä»¥åŠé˜¿æ‹‰ä¼¯æ•°å­—ã€‚

æ¨¡å¼ä¸² $P$ åœ¨å­—ç¬¦ä¸² $S$ ä¸­å¤šæ¬¡ä½œä¸ºå­ä¸²å‡ºç°ã€‚

æ±‚å‡ºæ¨¡å¼ä¸² $P$ åœ¨å­—ç¬¦ä¸² $S$ ä¸­æ‰€æœ‰å‡ºç°çš„ä½ç½®çš„èµ·å§‹ä¸‹æ ‡ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $N$ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $P$ çš„é•¿åº¦ã€‚

ç¬¬äºŒè¡Œè¾“å…¥å­—ç¬¦ä¸² $P$ã€‚

ç¬¬ä¸‰è¡Œè¾“å…¥æ•´æ•° $M$ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $S$ çš„é•¿åº¦ã€‚

ç¬¬å››è¡Œè¾“å…¥å­—ç¬¦ä¸² $S$ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼Œè¾“å‡ºæ‰€æœ‰å‡ºç°ä½ç½®çš„èµ·å§‹ä¸‹æ ‡ï¼ˆä¸‹æ ‡ä» $0$ å¼€å§‹è®¡æ•°ï¼‰ï¼Œæ•´æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5$
$1â‰¤Mâ‰¤10^6$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
aba
5
ababa
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
0 2
```

> **è§£æ**

è®¾ä¸»ä¸²ï¼ˆå¾…åŒ¹é…å­—ç¬¦ä¸²ï¼‰ä¸º $s$ ï¼Œå­ä¸²ï¼ˆæ¨¡å¼ä¸²ï¼‰ä¸º $p$ ï¼Œ

**$next[i]=j$ è¡¨ç¤º $p[1,j]=p[i-j+1,i]$ ï¼Œå³ å­ä¸² $p$ çš„ $1 \sim j$ èŒƒå›´å’Œ $i-j+1 \sim i$ èŒƒå›´å®Œå…¨ä¸€è‡´**

<img src="./figs/kmp" alt="image-20241211002608703" style="zoom: 75%;" />

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨åŒ¹é…è¿‡ç¨‹ä¸­ï¼Œå‘ç° $s$ ä¸²çš„ $[i-j,i-1]$ éƒ¨åˆ†å’Œ $p$ ä¸²çš„ $[1,j]$ éƒ¨åˆ†å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯ $s[i]$ ä¸ç­‰äº $s[j+1]$ ï¼ŒåŒ¹é…å¤±è´¥

ä½†æ˜¯å‘ç° $p$ ä¸²çš„ â‘¢ éƒ¨åˆ†ä¸ â‘  éƒ¨åˆ†ç›¸ç­‰ï¼ˆå®é™…ä¸Š â‘  = â‘¡ = â‘¢ ï¼‰ï¼Œæ‰€ä»¥åˆ©ç”¨ $j=next[j]$ å¯¹ $p$ ä¸²è¿›è¡Œå³ç§»ï¼Œä½¿ â‘  éƒ¨åˆ†å’Œ â‘¡ éƒ¨åˆ†ç›´æ¥åŒ¹é…ï¼Œçœå»äº†ä¸­é—´åŒ¹é…çš„è¿‡ç¨‹

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010, M = 1000010;
int n, m;
int ne[N]; // next æ•°ç»„ï¼Œnext[i]=j è¡¨ç¤º p[1,j]=p[i-j+1,i] 
char s[M], p[N];
int main()
{
    cin >> n >> p + 1 >> m >> s + 1; // ä»ä¸‹æ ‡ 1 å¼€å§‹ç´¢å¼• 
    for (int i = 2, j = 0; i <= n; i ++) // è®¡ç®— next æ•°ç»„çš„å€¼ 
    {
        while (j && p[i] != p[j + 1]) j = ne[j];
        if (p[i] == p[j + 1]) j ++;
        ne[i] = j;
    }
    for (int i = 1, j = 0; i <= m; i ++) // å¼€å§‹åŒ¹é… 
    {
        while (j && s[i] != p[j + 1]) j = ne[j];
        if (s[i] == p[j + 1]) j ++;
        if (j == n)
        {
            cout << i - n << " ";
            j = ne[j];
        }
    }
    return 0;
}
```

## 5. å¹¶æŸ¥é›†

### 5.1 åˆå¹¶é›†åˆ

> **é¢˜ç›®**

ä¸€å…±æœ‰ $n$ ä¸ªæ•°ï¼Œç¼–å·æ˜¯ $1âˆ¼n$ï¼Œæœ€å¼€å§‹æ¯ä¸ªæ•°å„è‡ªåœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚

ç°åœ¨è¦è¿›è¡Œ $m$ ä¸ªæ“ä½œï¼Œæ“ä½œå…±æœ‰ä¸¤ç§ï¼š

1. `M a b`ï¼Œå°†ç¼–å·ä¸º $a$ å’Œ $b$ çš„ä¸¤ä¸ªæ•°æ‰€åœ¨çš„é›†åˆåˆå¹¶ï¼Œå¦‚æœä¸¤ä¸ªæ•°å·²ç»åœ¨åŒä¸€ä¸ªé›†åˆä¸­ï¼Œåˆ™å¿½ç•¥è¿™ä¸ªæ“ä½œï¼›
2. `Q a b`ï¼Œè¯¢é—®ç¼–å·ä¸º $a$ å’Œ $b$ çš„ä¸¤ä¸ªæ•°æ˜¯å¦åœ¨åŒä¸€ä¸ªé›†åˆä¸­ï¼›

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ“ä½œæŒ‡ä»¤ï¼ŒæŒ‡ä»¤ä¸º `M a b` æˆ– `Q a b` ä¸­çš„ä¸€ç§ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸ªè¯¢é—®æŒ‡ä»¤ `Q a b`ï¼Œéƒ½è¦è¾“å‡ºä¸€ä¸ªç»“æœï¼Œå¦‚æœ $a$ å’Œ $b$ åœ¨åŒä¸€é›†åˆå†…ï¼Œåˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

æ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤10^5$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4 5
M 1 2
M 3 4
Q 1 2
Q 1 3
Q 3 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
No
Yes
```

> **è§£æ**

**å¹¶æŸ¥é›†**ï¼š

1. **å°†ä¸¤ä¸ªé›†åˆåˆå¹¶**
2. **æŸ¥è¯¢ä¸¤ä¸ªå…ƒç´ æ˜¯å¦åœ¨åŒä¸€ä¸ªé›†åˆå½“ä¸­**

åŸºæœ¬åŸç†ï¼š

æ¯ä¸ª**é›†åˆ**ç”¨ä¸€æ£µ**æ ‘**æ¥è¡¨ç¤ºã€‚**æ ‘æ ¹çš„ç¼–å·å°±æ˜¯æ•´ä¸ªé›†åˆçš„ç¼–å·**ã€‚æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨å®ƒçš„çˆ¶èŠ‚ç‚¹ç¼–å·ï¼Œ$p[x]$ è¡¨ç¤º $x$ çš„çˆ¶èŠ‚ç‚¹ç¼–å·

- å¦‚ä½•åˆ¤æ–­æ ‘æ ¹ï¼Ÿ`if(p[x] == x)`

- å¦‚ä½•æ±‚ x çš„é›†åˆç¼–å·ï¼Ÿ`while(p[x] != x) x = p[x];` ï¼ˆæœªä½¿ç”¨è·¯å¾„å‹ç¼©çš„æ–¹æ³•ï¼‰

- å¦‚ä½•åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Ÿå‡è®¾æœ‰é›†åˆ $x$ å’Œ é›†åˆ $y$ ï¼Œ$px$ ä¸º $x$ çš„æ ¹èŠ‚ç‚¹ï¼Œ $py$ ä¸º $y$ çš„æ ¹èŠ‚ç‚¹ï¼Œå«æ¥ `p[px] = py`


ä¼˜åŒ– *â€œæ±‚ x çš„é›†åˆç¼–å·â€* è¿™ä¸€æ­¥éª¤ï¼š**è·¯å¾„å‹ç¼©**

> å¹¶æŸ¥é›†çš„è·¯å¾„å‹ç¼©æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œç”¨äºå‡å°‘æŸ¥æ‰¾æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ã€‚åœ¨è‡ªåº•å‘ä¸ŠæŸ¥æ‰¾èŠ‚ç‚¹æ‰€å±é›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œå°†è·¯å¾„ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘æ ‘çš„å±‚æ•°

------

æ•´ä½“ç®—æ³•æ€æƒ³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

- åˆå§‹åŒ–ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æŒ‡å‘è‡ªå·±

<img src="/figs/disjoint_set_1" alt="12.png" style="zoom:80%;" />

- æŸ¥æ‰¾ç¥–å®—èŠ‚ç‚¹ + è·¯å¾„å‹ç¼©ï¼ˆå¦‚æŸ¥è¯¢èŠ‚ç‚¹ 1 çš„ç¥–å®—èŠ‚ç‚¹ 4 ï¼Œå°†èŠ‚ç‚¹ 1 è·¯å¾„ä¸Šçš„çˆ¶èŠ‚ç‚¹ 2ã€3 å…¨éƒ¨æ’å…¥åˆ°ç¥–å®—èŠ‚ç‚¹ 4 åé¢ï¼‰

<img src="/figs/disjoint_set_2" alt="13.png" style="zoom:80%;" />

- åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Œå°†é›†åˆ a çš„ç¥–å®—èŠ‚ç‚¹å«æ¥åˆ°é›†åˆ b çš„ç¥–å®—èŠ‚ç‚¹ä¸Š

<img src="/figs/disjoint_set_3" alt="image-20241029232120728" style="zoom:50%;" />

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int p[N]; // p[x] è¡¨ç¤º x çš„çˆ¶èŠ‚ç‚¹
int find(int x) // è¿”å› x æ‰€åœ¨é›†åˆçš„ç¼–å·ï¼ˆè¿”å› x çš„ç¥–å®—èŠ‚ç‚¹çš„ç¼–å·ï¼‰ 
{
    if (p[x] != x) p[x] = find(p[x]); // ä½¿ç”¨äº†è·¯å¾„å‹ç¼© 
    return p[x]; // æ‰¾åˆ°äº†ä¾¿è¿”å›ç¥–å®—èŠ‚ç‚¹çš„ç¼–å· 
}
int main()
{
    int n, m;
    cin >> n >> m;
    for (int i = 1; i <= n; i ++) p[i] = i; // åˆå§‹åŒ–ï¼Œæ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹éƒ½ç­‰äºè‡ªå·± 
    while (m --)
    {
        char op;
        int a, b;
        cin >> op >> a >> b;
        // é›†åˆåˆå¹¶æ“ä½œ 
        if (op == 'M') p[find(a)] = find(b); // a çš„ç¥–å®—èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ = b çš„ç¥–å®—èŠ‚ç‚¹ï¼Œå³å°† a æ‰€åœ¨çš„æ ‘çš„æ ‘æ ¹å«æ¥åˆ° b æ‰€åœ¨æ ‘çš„æ ‘æ ¹å 
        // é›†åˆæŸ¥è¯¢æ“ä½œ 
		else
        {
            if (find(a) == find(b)) cout << "Yes" << endl;
            else cout << "No" << endl;
        }
    }
    return 0;
}
```

### 5.2 è¿é€šå—ä¸­ç‚¹çš„æ•°é‡

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªåŒ…å« $n$ ä¸ªç‚¹ï¼ˆç¼–å·ä¸º $1âˆ¼n$ï¼‰çš„æ— å‘å›¾ï¼Œåˆå§‹æ—¶å›¾ä¸­æ²¡æœ‰è¾¹ã€‚

ç°åœ¨è¦è¿›è¡Œ $m$ ä¸ªæ“ä½œï¼Œæ“ä½œå…±æœ‰ä¸‰ç§ï¼š

1. `C a b`ï¼Œåœ¨ç‚¹ $a$ å’Œç‚¹ $b$ ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œ$a$ å’Œ $b$ å¯èƒ½ç›¸ç­‰ï¼›
2. `Q1 a b`ï¼Œè¯¢é—®ç‚¹ $a$ å’Œç‚¹ $b$ æ˜¯å¦åœ¨åŒä¸€ä¸ªè¿é€šå—ä¸­ï¼Œ$a$ å’Œ $b$ å¯èƒ½ç›¸ç­‰ï¼›
3. `Q2 a`ï¼Œè¯¢é—®ç‚¹ $a$ æ‰€åœ¨è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ï¼›

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ“ä½œæŒ‡ä»¤ï¼ŒæŒ‡ä»¤ä¸º `C a b`ï¼Œ`Q1 a b` æˆ– `Q2 a` ä¸­çš„ä¸€ç§ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸ªè¯¢é—®æŒ‡ä»¤ `Q1 a b`ï¼Œå¦‚æœ $a$ å’Œ $b$ åœ¨åŒä¸€ä¸ªè¿é€šå—ä¸­ï¼Œåˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

å¯¹äºæ¯ä¸ªè¯¢é—®æŒ‡ä»¤ `Q2 a`ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç‚¹ $a$ æ‰€åœ¨è¿é€šå—ä¸­ç‚¹çš„æ•°é‡

æ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤10^5$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5 5
C 1 2
Q1 1 2
Q2 1
C 2 5
Q2 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
2
3
```

> **è§£æ**

ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œå¢åŠ äº†ä¸€ä¸ªé›†åˆè®¡æ•°æ“ä½œ $cnt$ ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n, m;
int p[N], cnt[N]; // p[x] è¡¨ç¤º x çš„çˆ¶èŠ‚ç‚¹ï¼›cnt[x] è¡¨ç¤ºç‚¹ x æ‰€åœ¨è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ 
int find(int x)
{
    if (p[x] != x) p[x] = find(p[x]); // ä½¿ç”¨äº†è·¯å¾„å‹ç¼©
    return p[x]; // æ‰¾åˆ°äº†ä¾¿è¿”å›ç¥–å®—èŠ‚ç‚¹çš„ç¼–å·
}
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++ )
    {
        p[i] = i; // åˆå§‹åŒ–ï¼Œæ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹éƒ½ç­‰äºè‡ªå·±
        cnt[i] = 1;// åˆå§‹åŒ–ï¼Œæ¯ä¸ªç‚¹éƒ½æ˜¯å•ç‹¬çš„ä¸€ä¸ªè¿é€šå— 
    }
    while (m --)
    {
        string op;
        int a, b;
        cin >> op;
        // é›†åˆåˆå¹¶æ“ä½œ 
        if (op == "C")
        {
            cin >> a >> b;
            a = find(a), b = find(b);
            if (a != b)
            {
                p[a] = b; // a æ‰€åœ¨çš„æ ‘çš„æ ‘æ ¹å«æ¥åˆ° b æ‰€åœ¨æ ‘çš„æ ‘æ ¹å
                cnt[b] += cnt[a]; // b æ‰€åœ¨çš„è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ += aæ‰€åœ¨çš„è¿é€šå—ä¸­ç‚¹çš„æ•°é‡ 
            }
        }
        // é›†åˆæŸ¥è¯¢æ“ä½œ 
        else if (op == "Q1")
        {
            cin >> a >> b;
            if (find(a) == find(b)) cout << "Yes" << endl;
            else cout << "No" << endl;
        }
        // é›†åˆè®¡æ•°æ“ä½œ 
        else
        {
            cin >> a;
            cout << cnt[find(a)] << endl;
        }
    }
    return 0;
}
```

## 6. å“ˆå¸Œè¡¨

### 6.1 æ¨¡æ‹Ÿæ•£åˆ—è¡¨

> **é¢˜ç›®**

ç»´æŠ¤ä¸€ä¸ªé›†åˆï¼Œæ”¯æŒå¦‚ä¸‹å‡ ç§æ“ä½œï¼š

1. `I x`ï¼Œæ’å…¥ä¸€ä¸ªæ•´æ•° $x$ï¼›
2. `Q x`ï¼Œè¯¢é—®æ•´æ•° $x$ æ˜¯å¦åœ¨é›†åˆä¸­å‡ºç°è¿‡ï¼›

ç°åœ¨è¦è¿›è¡Œ $N$ æ¬¡æ“ä½œï¼Œå¯¹äºæ¯ä¸ªè¯¢é—®æ“ä½œè¾“å‡ºå¯¹åº”çš„ç»“æœã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºæ“ä½œæ•°é‡ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ“ä½œæŒ‡ä»¤ï¼Œæ“ä½œæŒ‡ä»¤ä¸º `I x`ï¼Œ`Q x` ä¸­çš„ä¸€ç§ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸ªè¯¢é—®æŒ‡ä»¤ `Q x`ï¼Œè¾“å‡ºä¸€ä¸ªè¯¢é—®ç»“æœï¼Œå¦‚æœ $x$ åœ¨é›†åˆä¸­å‡ºç°è¿‡ï¼Œåˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

æ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5$
$âˆ’10^9â‰¤xâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
I 1
I 2
I 3
Q 2
Q 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
No
```

> **è§£æ**

**å“ˆå¸Œå‡½æ•°ï¼šæŠŠå¤æ‚ä¿¡æ¯æ˜ å°„åˆ°ä¸€ä¸ªå®¹æ˜“ç»´æŠ¤çš„å€¼åŸŸå†…ï¼Œå¹¶ä¸”åˆç†çš„é¿å…å†²çªã€‚**ä¸»è¦æ–¹æ³•æœ‰å¼€æ”¾å¯»å€æ³•å’Œæ‹‰é“¾æ³•ä¸¤ç§

> **ä»£ç æ¨¡æ¿**

**STL æ³•ï¼š**

ï¼ˆ`unordered_map` æœ¬èº«å°±æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨å®ç°çš„ï¼Œè¿™é‡Œä½¿ç”¨ STL ç›¸å½“äºé€ƒè¯¾äº†ï¼‰

```c++
#include<bits/stdc++.h>
using namespace std;
unordered_map<int, int> m;
int n;
int main()
{
	cin >> n;
	while(n --)
	{
		char op;
		int x;
		cin >> op >> x;
		if(op == 'I') m[x] ++;
		else if(op == 'Q')
		{
			if(m[x]) cout << "Yes" << endl;
			else cout << "No" << endl;
		}
	}
	return 0;
} 
```

**å¼€æ”¾å¯»å€æ³•ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
// å¼€æ”¾å¯»å€æ³•ä¸€èˆ¬å¼€ æ•°æ®èŒƒå›´çš„ 2 ~ 3 å€, è¿™æ ·å¤§æ¦‚ç‡å°±æ²¡æœ‰å†²çªäº†
const int N = 2e5 + 3, null = 0x3f3f3f3f; // N ä¸ºå¤§äºæ•°æ®èŒƒå›´çš„ç¬¬ä¸€ä¸ªè´¨æ•°
int h[N]; // ç”¨äºå®ç°å“ˆå¸Œè¡¨
int find(int x) // æ‰¾åˆ° x æ˜ å°„åˆ°å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®
{
    int t = (x % N + N) % N; // å–æ¨¡ï¼Œå¹¶ä¸”ç¡®ä¿å“ˆå¸Œå€¼ t æ˜¯éè´Ÿçš„
    while(h[t] != null && h[t] != x) // å†²çªæƒ…å†µï¼šå½“å‰ä½ç½® t ä¸ä¸ºç©ºï¼Œå¹¶ä¸”å½“å‰ä½ç½®çš„æ•°ä¸ä¸º x 
    {
        t ++; // å‘åæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„ä½ç½® 
        if(t == N) t = 0; // æŸ¥æ‰¾åˆ°æ•°ç»„æœ«å°¾ï¼Œè¿”å›åˆ°æ•°ç»„å¼€å¤´é¿å…è¶Šç•Œ 
    }
    return t;
}
int main()
{
    memset(h, 0x3f, sizeof(h));
    int n;
    cin >> n;
    while(n --)
    {
        char op;
        int x;
        cin >> op >> x;
        if(op == 'I') h[find(x)] = x;
        else
        {
            if(h[find(x)] == null) cout << "No" << endl;
            else cout << "Yes" << endl;
        }
    }
    return 0;
}
```

**æ‹‰é“¾æ³•ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 1e5 + 3;
int h[N], e[N], ne[N], idx;
void insert(int x) // æŠŠå½“å‰ç‚¹ x æ’åˆ° h[k] ä¸Š
{
// e[i] è¡¨ç¤ºèŠ‚ç‚¹ i çš„å€¼
// ne[i] è¡¨ç¤ºèŠ‚ç‚¹ i çš„ next æŒ‡é’ˆæ˜¯å¤šå°‘
// idx å­˜å‚¨å½“å‰å·²ç»ç”¨åˆ°äº†å“ªä¸ªç‚¹
// h[k] è¡¨ç¤ºå“ˆå¸Œè¡¨ä¸­ç¬¬ k ä¸ªæ¡¶ï¼ˆæˆ–é“¾è¡¨ï¼‰çš„å¤´èŠ‚ç‚¹ç´¢å¼•
    int k = (x % N + N) % N;
    e[idx] = x;
    ne[idx] = h[k];
    h[k] = idx ++;
}
bool find(int x)
{
    int k = (x % N + N) % N;
    for(int i = h[k]; i != -1; i = ne[i])
    {
    	if(e[i] == x) return true;
	}
    return false;
}
int main()
{
    int n;
    cin >> n;
    memset(h, -1, sizeof(h));
    while (n --)
    {
        char op;
        int x;
        cin >> op >> x;
        if (op == 'I') insert(x);
        else
        {
            if (find(x)) cout << "Yes" << endl;
            else cout << "No" << endl;
        }
    }
    return 0;
}
```

æ‹‰é“¾æ³•å›¾ç¤ºå¦‚ä¸‹ï¼š

```apl
å“ˆå¸Œè¡¨ h[0 ... 100002]ï¼ˆæ•°ç»„å¤§å°ä¸º 1e5+3ï¼‰
ç´¢å¼• k | é“¾è¡¨ï¼ˆå¤´æ’æ³•ï¼‰
-------|-----------------------------------------------------------
  0    | â— â†’ [100003|âˆ…] â†’ [0|âˆ…]
  15   | â— â†’ [200021|â†’] â†’ [100018|â†’] â†’ [15|âˆ…]
  ...  | ...ï¼ˆå…¶ä»–æ§½ä½å¯èƒ½ä¸ºç©ºæˆ–æœ‰å°‘é‡å…ƒç´ ï¼‰
100002 | â— â†’ [100002|âˆ…]
```

### 6.2 å­—ç¬¦ä¸²å“ˆå¸Œ

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼Œå†ç»™å®š $m$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®åŒ…å«å››ä¸ªæ•´æ•° $l_1,r_1,l_2,r_2$ï¼Œè¯·ä½ åˆ¤æ–­ $[l_1,r_1]$ å’Œ $[l_2,r_2]$ è¿™ä¸¤ä¸ªåŒºé—´æ‰€åŒ…å«çš„å­—ç¬¦ä¸²å­ä¸²æ˜¯å¦å®Œå…¨ç›¸åŒã€‚

å­—ç¬¦ä¸²ä¸­åªåŒ…å«å¤§å°å†™è‹±æ–‡å­—æ¯å’Œæ•°å­—ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $m$ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²é•¿åº¦å’Œè¯¢é—®æ¬¡æ•°ã€‚

ç¬¬äºŒè¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­åªåŒ…å«å¤§å°å†™è‹±æ–‡å­—æ¯å’Œæ•°å­—ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«å››ä¸ªæ•´æ•° $l_1,r_1,l_2,r_2$ï¼Œè¡¨ç¤ºä¸€æ¬¡è¯¢é—®æ‰€æ¶‰åŠçš„ä¸¤ä¸ªåŒºé—´ã€‚

æ³¨æ„ï¼Œå­—ç¬¦ä¸²çš„ä½ç½®ä» $1$ å¼€å§‹ç¼–å·ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸ªè¯¢é—®è¾“å‡ºä¸€ä¸ªç»“æœï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²å­ä¸²å®Œå…¨ç›¸åŒåˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

æ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤10^5$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
8 3
aabbaabb
1 3 5 7
1 3 6 8
1 2 1 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
No
Yes
```

> **è§£æ**

**å­—ç¬¦ä¸²å‰ç¼€å“ˆå¸Œæ³•**ï¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª $P$ è¿›åˆ¶çš„æ•°å­—ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼Œå®ç°ä¸åŒçš„å­—ç¬¦ä¸²æ˜ å°„åˆ°ä¸åŒçš„æ•°å­—

å¯¹å½¢å¦‚ $X_1X_2X_3\ldots X_{n-1}X_n$ çš„å­—ç¬¦ä¸²ï¼Œé‡‡ç”¨å­—ç¬¦çš„**ASCII ç **ä¹˜ä¸Š $P$ çš„æ¬¡æ–¹æ¥è®¡ç®—å“ˆå¸Œå€¼ã€‚**æ˜ å°„å…¬å¼**ä¸ºï¼š

$$
h[n] = h[1, n] = \left(X_1 \times P^{n-1} + X_2 \times P^{n-2} + \ldots + X_{n-1} \times P^1 + X_n \times P^0\right) \mod Q
$$

æ³¨æ„ç‚¹ï¼š

1. ä»»æ„å­—ç¬¦ä¸å¯ä»¥æ˜ å°„æˆ $0$ ï¼Œå¦åˆ™ä¼šå‡ºç°ä¸åŒçš„å­—ç¬¦ä¸²éƒ½æ˜ å°„æˆ $0$ çš„æƒ…å†µï¼Œæ¯”å¦‚ $A$ï¼Œ$AA$ï¼Œ$AAA$ çš†ä¸º $0$
2. å†²çªé—®é¢˜ï¼šé€šè¿‡å·§å¦™è®¾ç½® $P$ (å¦‚ $131$ æˆ– $13331$ ç­‰è´¨æ•°) å’Œ $Q$ (å¦‚ $2^{64}$) çš„å€¼ï¼Œä¸€èˆ¬å¯ä»¥ç†è§£ä¸ºä¸äº§ç”Ÿå†²çªã€‚æ¯”è¾ƒä¸åŒåŒºé—´çš„å­ä¸²æ˜¯å¦ç›¸åŒï¼Œå°±è½¬åŒ–ä¸ºå¯¹åº”çš„å“ˆå¸Œå€¼æ˜¯å¦ç›¸åŒ

æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼å°±ç›¸å½“äºæ±‚**å‰ç¼€å’Œ**ï¼Œæ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­ä¸²å“ˆå¸Œå€¼å°±ç›¸å½“äºæ±‚**åŒºé—´å’Œ**

**å‰ç¼€å’Œå…¬å¼**ä¸ºï¼š$h[i+1] = h[i] \times P + s[i] \quad (i \in [1, n])$ ï¼Œå…¶ä¸­ $h$ ä¸ºå‰ç¼€å’Œæ•°ç»„ï¼Œ$s$ ä¸ºå­—ç¬¦ä¸²æ•°ç»„ã€‚

**åŒºé—´å’Œå…¬å¼**ä¸ºï¼š$h[l, r] = h[r] - h[l-1] \times P^{r-l+1}$

åŒºé—´å’Œå…¬å¼æ¨å¯¼ï¼š
$$
h[r] = \left(X_1 \times P^{r-1} + X_2 \times P^{r-2} + \ldots + X_{l - 1} \times P^{r - l + 1} + \ldots + X_{r-1} \times P^1 + X_r \times P^0\right) \mod Q  \qquad (1) \\
h[l - 1] = \left(X_1 \times P^{l-2} + X_2 \times P^{l-3} + \ldots + X_{l-2} \times P^1 + X_{l - 1} \times P^0\right) \mod Q  \qquad (2) \\
ç”±æ˜ å°„å…¬å¼å®šä¹‰çŸ¥: \\
h[l, r] = \left(X_l \times P^{r - l} + X_{l + 1} \times P^{r - l - 1} + \ldots + X_{r-1} \times P^1 + X_r \times P^0\right) \mod Q  \qquad (3) \\
åˆç”±(1)(2)å¼æ¨å¯¼çŸ¥:  \quad (3)å¼ = (1)å¼ - (2)å¼ \times P^{r-l+1} \\
å³: \quad h[l, r] = h[r] - h[l-1] \times P^{r-l+1}
$$


> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef unsigned long long ULL; // ULL èŒƒå›´æ˜¯ [0, (2 ^ 64) - 1]ï¼Œä½¿ç”¨ ULL æ•°æ®ç±»å‹å°±ç›¸å½“äºç›´æ¥å–æ¨¡ Q äº†
const int N = 100010, P = 131; // P å€¼è®¾ä¸º 131 æˆ– 13331
int n, m;
char str[N];
ULL h[N], p[N]; // h[i] è¡¨ç¤ºå­ä¸² [1, i] çš„å“ˆå¸Œå€¼ï¼›p[j] è¡¨ç¤º p ^ j
ULL get(int l, int r)
{
    return h[r] - h[l - 1] * p[r - l + 1]; // åŒºé—´å’Œå…¬å¼
}
int main()
{
    cin >> n >> m;
    cin >> str + 1; // å­—ç¬¦ä¸²ä» 1 å¼€å§‹è¾“å…¥ï¼Œä¸‹æ ‡ä» 1 å¼€å§‹
    p[0] = 1; // p ^ 0 = 1 
    for (int i = 1; i <= n; i ++)
    {
        h[i] = h[i - 1] * P + str[i]; // å‰ç¼€å’Œå…¬å¼
        p[i] = p[i - 1] * P; // å‰ç¼€å’Œè®¡ç®— p ^ i
    }
    while (m --)
    {
        int l1, r1, l2, r2;
        cin >> l1 >> r1 >> l2 >> r2;
        if (get(l1, r1) == get(l2, r2)) cout << "Yes" << endl;
        else cout << "No" << endl;
    }
    return 0;
}
```

## 7. çº¿æ®µæ ‘

### 7.1 æœ€å¤§æ•°

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°åˆ— $a_1,a_2,â€¦,a_n$ï¼Œæ¯ä¸€ä¸ªæ•°éƒ½åœ¨ $0âˆ¼pâˆ’1$ ä¹‹é—´ã€‚

å¯ä»¥å¯¹è¿™åˆ—æ•°è¿›è¡Œä¸¤ç§æ“ä½œï¼š

1. æ·»åŠ æ“ä½œï¼šå‘åºåˆ—åæ·»åŠ ä¸€ä¸ªæ•°ï¼Œåºåˆ—é•¿åº¦å˜æˆ $n+1$ï¼›
2. è¯¢é—®æ“ä½œï¼šè¯¢é—®è¿™ä¸ªåºåˆ—ä¸­æœ€å $L$ ä¸ªæ•°ä¸­æœ€å¤§çš„æ•°æ˜¯å¤šå°‘ã€‚

ç¨‹åºè¿è¡Œçš„æœ€å¼€å§‹ï¼Œæ•´æ•°åºåˆ—ä¸ºç©ºã€‚

ä¸€å…±è¦å¯¹æ•´æ•°åºåˆ—è¿›è¡Œ $m$ æ¬¡æ“ä½œã€‚

å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å…¥æ“ä½œçš„åºåˆ—ï¼Œå¹¶è¾“å‡ºè¯¢é—®æ“ä½œçš„ç­”æ¡ˆã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ­£æ•´æ•° $m,p$ï¼Œæ„ä¹‰å¦‚é¢˜ç›®æè¿°ï¼›

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªæ“ä½œã€‚

å¦‚æœè¯¥è¡Œçš„å†…å®¹æ˜¯ `Q L`ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªæ“ä½œæ˜¯è¯¢é—®åºåˆ—ä¸­æœ€å $L$ ä¸ªæ•°çš„æœ€å¤§æ•°æ˜¯å¤šå°‘ï¼›

å¦‚æœæ˜¯ `A t`ï¼Œåˆ™è¡¨ç¤ºå‘åºåˆ—åé¢åŠ ä¸€ä¸ªæ•°ï¼ŒåŠ å…¥çš„æ•°æ˜¯ $(t+a) mod p$ã€‚å…¶ä¸­ï¼Œ$t$ æ˜¯è¾“å…¥çš„å‚æ•°ï¼Œ$a$ æ˜¯åœ¨è¿™ä¸ªæ·»åŠ æ“ä½œä¹‹å‰æœ€åä¸€ä¸ªè¯¢é—®æ“ä½œçš„ç­”æ¡ˆï¼ˆå¦‚æœä¹‹å‰æ²¡æœ‰è¯¢é—®æ“ä½œï¼Œåˆ™ $a=0$ï¼‰ã€‚

ç¬¬ä¸€ä¸ªæ“ä½œä¸€å®šæ˜¯æ·»åŠ æ“ä½œã€‚å¯¹äºè¯¢é—®æ“ä½œï¼Œ$L>0$ ä¸”ä¸è¶…è¿‡å½“å‰åºåˆ—çš„é•¿åº¦ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸€ä¸ªè¯¢é—®æ“ä½œï¼Œè¾“å‡ºä¸€è¡Œã€‚è¯¥è¡Œåªæœ‰ä¸€ä¸ªæ•°ï¼Œå³åºåˆ—ä¸­æœ€å $L$ ä¸ªæ•°çš„æœ€å¤§æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤mâ‰¤2Ã—10^5$,
$1â‰¤pâ‰¤2Ã—10^9$,
$0â‰¤t<p$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
10 100
A 97
Q 1
Q 1
A 17
Q 2
A 63
Q 1
Q 1
Q 3
A 99
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
97
97
97
60
60
97
```

**æ ·ä¾‹è§£é‡Š**

æœ€åçš„åºåˆ—æ˜¯ $97,14,60,96$ã€‚

> **è§£æ**

**çº¿æ®µæ ‘**ï¼Œæ˜¯ä¸€ç§åŸºäº**åˆ†æ²»æ€æƒ³**çš„**äºŒå‰æœç´¢æ ‘**ã€‚å®ƒæ”¯æŒçš„æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥åœ¨ $O(log \ n)$ çš„æ—¶é—´å¤æ‚åº¦å®Œæˆã€‚

çº¿æ®µæ ‘çš„åŸºæœ¬ç‰¹ç‚¹ï¼š

- çº¿æ®µæ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªåŒºé—´ã€‚
- çº¿æ®µæ ‘æœ‰å”¯ä¸€æ ¹ï¼Œè¿™ä¸ªæ ¹è¡¨ç¤ºçš„æ‰€æœ‰ä¼šè¢«çº¿æ®µæ ‘ç»Ÿè®¡çš„æ€»åŒºé—´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ ¹è¡¨ç¤ºçš„åŒºé—´å°±æ˜¯ $[1, n]$ã€‚
- çº¿æ®µæ ‘çš„å¶å­èŠ‚ç‚¹è¡¨ç¤ºçš„åŒºé—´ä¸º $[x, x]$ï¼Œä¸”é•¿åº¦ä¸º $1$ã€‚
- çº¿æ®µæ ‘ä¸­å¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¡¨ç¤ºçš„åŒºé—´æ˜¯ $[l, r]$ï¼Œä¸”è¿™ä¸ªç‚¹ä¸ä¸ºå¶å­èŠ‚ç‚¹ï¼Œå³ $l â‰  r$ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹çš„å·¦å­æ ‘çš„æ ¹è¡¨ç¤ºçš„åŒºé—´å°±æ˜¯ $[l, mid]$ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„å³å­æ ‘çš„æ ¹è¡¨ç¤ºçš„åŒºé—´å°±æ˜¯ $[mid + 1, r]$ï¼Œå…¶ä¸­ $mid = âŒŠ\frac{(l + r)}{2}âŒ‹$ã€‚

æ³¨æ„ï¼Œ**çº¿æ®µæ ‘æ‰€ç»´æŠ¤çš„ä¿¡æ¯ï¼Œéœ€è¦æ»¡è¶³åŒºé—´åŠ æ³•**

**åŒºé—´åŠ æ³•**ï¼šä¸€ä¸ªåŒºé—´ $[l, r]$ çš„çº¿æ®µæ ‘ç»´æŠ¤çš„ä¿¡æ¯ï¼ˆå³åŒºé—´æœ€å¤§å€¼ï¼ŒåŒºé—´æœ€å°å€¼ï¼ŒåŒºé—´å’Œï¼ŒåŒºé—´ $gcd$ ç­‰ï¼‰ï¼Œå¯ä»¥ç”±ä¸¤ä¸ªåŒºé—´ $[l, \text{mid}]$ å’Œ $[\text{mid} + 1, r]$ åˆå¹¶è€Œæ¥

ä¸ºäº†çº¿æ®µæ ‘çš„èŠ‚ç‚¹ä¸è¶…è¿‡å­˜å‚¨èŒƒå›´ï¼Œä¸€èˆ¬çº¿æ®µæ ‘éƒ½è¦å¼€ $4 \times n$ çš„ç©ºé—´ï¼Œå³åŒºé—´æ€»é•¿åº¦çš„ $4$ å€

<img src="./figs/segment_tree.jpg" alt="segment_tree" style="zoom: 67%;" />

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 200010;
struct Node{
    int l, r;
    int v; // [l,r] èŒƒå›´å†…çš„æœ€å¤§å€¼
}tr[N * 4]; // çº¿æ®µæ ‘çš„ç»“ç‚¹ï¼Œæœ€å¤§ç©ºé—´å¼€ 4 å€
int m, p;
void pushup(int u)
{
	tr[u].v = max(tr[u << 1].v, tr[u << 1 | 1].v);
}
void build(int u, int l, int r) // u ä¸ºå½“å‰çº¿æ®µæ ‘çš„ç»“ç‚¹ç¼–å·ï¼Œä» 1 å¼€å§‹ç¼–å· 
{
    tr[u] = {l, r}; // ä¸ºç¼–å·ä¸º u çš„èŠ‚ç‚¹çš„å·¦å³ç«¯ç‚¹èµ‹å€¼ 
    if (l == r) return; // è®¿é—®åˆ°å¶å­ç»“ç‚¹ï¼Œç»ˆæ­¢ build 
    int mid = l + r >> 1;
    build(u << 1, l, mid), build(u << 1 | 1, mid + 1, r); // build å·¦å­æ ‘å’Œå³å­æ ‘ 
}
int query(int u, int l, int r) // æŸ¥è¯¢ä»¥ u ä¸ºæ ¹èŠ‚ç‚¹ï¼ŒåŒºé—´ [l,r] ä¸­çš„æœ€å¤§å€¼
{ 
    if (tr[u].l >= l && tr[u].r <= r) return tr[u].v;
	/* 
	   1.ä¸å¿…åˆ†æ²»ï¼Œç›´æ¥è¿”å›
            Tl-----Tr
         L-------------R
	*/ 
    int mid = tr[u].l + tr[u].r >> 1;
    int v = 0;
    if (l <= mid) v = query(u << 1, l, r);
    /* 
	   2.éœ€è¦åœ¨ tr çš„å·¦åŒºé—´[Tl,m]ç»§ç»­åˆ†æ²»
           Tl----m----Tr
              L-------------R
    æˆ–æ˜¯ï¼š     L-----R 
    */ 
    if (r > mid) v = max(v, query(u << 1 | 1, l, r));
    /* 
	   3.éœ€è¦åœ¨ tr çš„å³åŒºé—´[m + 1,Tr]ç»§ç»­åˆ†æ²»
           Tl----m----Tr
         L---------R
    æˆ–æ˜¯ï¼š     L----R 
	*/
    return v;
}
void modify(int u, int x, int v) // u ä¸ºç»“ç‚¹ç¼–å·ï¼Œx ä¸ºæ›´æ–°çš„ä½ç½®ï¼Œæ›´æ–°è¯¥ç»“ç‚¹çš„åŒºé—´æœ€å¤§å€¼
{
    if (tr[u].l == tr[u].r) tr[u].v = v;  // å¶å­èŠ‚ç‚¹ï¼Œé€’å½’å‡ºå£
    else
	{
        int mid = tr[u].l + tr[u].r >> 1; // åˆ†æ²»å¤„ç†å·¦å³å­æ ‘, å¯»æ‰¾ x æ‰€åœ¨çš„å­æ ‘
        if(x <= mid) modify(u << 1, x, v);
        else modify(u << 1 | 1, x, v);
        pushup(u); // å›æº¯ï¼Œæ‹¿å­ç»“ç‚¹çš„ä¿¡æ¯æ›´æ–°çˆ¶èŠ‚ç‚¹ï¼Œå³ pushup æ“ä½œ
    }
}
int main()
{
    int n = 0, last = 0; // nè¡¨ç¤ºæ ‘ä¸­çš„ç»“ç‚¹ä¸ªæ•°ï¼Œlastä¿å­˜ä¸Šä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœ
    cin >> m >> p;
    build(1, 1, m); // åˆå§‹åŒ–çº¿æ®µæ ‘ã€‚å› ä¸ºæ“ä½œæ•°æœ€å¤šä¸º mï¼Œå°±ç®—å…¨éƒ½æ˜¯æ·»åŠ æ“ä½œï¼Œç»“ç‚¹çš„åŒºé—´ä¹Ÿæœ€å¤šä¸º [1,m]
	int x;
	char op[2];
	while (m --)
    {
        cin >> op >> x;
        if (*op == 'Q') // æŸ¥è¯¢æ“ä½œ 
        {
            last = query(1, n - x + 1, n); // æŸ¥è¯¢ [n - x + 1, n] å†…çš„æœ€å¤§å€¼ï¼Œu = 1ï¼Œå³ä»æ ¹èŠ‚ç‚¹å¼€å§‹æŸ¥è¯¢
            cout << last << endl;
        }
        else // æ·»åŠ æ“ä½œ 
        {
            modify(1, n + 1, ((ll)last + x) % p);
            n ++;
        }
    }
    return 0;
}
```

### 7.2 ä½ èƒ½å›ç­”è¿™äº›é—®é¢˜å—

> **é¢˜ç›®**

ç»™å®šé•¿åº¦ä¸º $N$ çš„æ•°åˆ— $A$ï¼Œä»¥åŠ $M$ æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯èƒ½æ˜¯ä»¥ä¸‹ä¸¤ç§ä¹‹ä¸€ï¼š

1. `1 x y`ï¼ŒæŸ¥è¯¢åŒºé—´ $[x,y]$ ä¸­çš„æœ€å¤§è¿ç»­å­æ®µå’Œï¼Œå³ $\max_{x \leq l \leq r \leq y} \left\{ \sum_{i=l}^{r} A[i] \right\}$
2. `2 x y`ï¼ŒæŠŠ $A[x]$ æ”¹æˆ $y$ã€‚

å¯¹äºæ¯ä¸ªæŸ¥è¯¢æŒ‡ä»¤ï¼Œè¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•° $N,M$ã€‚

ç¬¬äºŒè¡Œ $N$ ä¸ªæ•´æ•° $A[i]$ã€‚

æ¥ä¸‹æ¥ $M$ è¡Œæ¯è¡Œ $3$ ä¸ªæ•´æ•° $k,x,y$ï¼Œ$k=1$ è¡¨ç¤ºæŸ¥è¯¢ï¼ˆæ­¤æ—¶å¦‚æœ $x>y$ï¼Œè¯·äº¤æ¢ $x,y$ï¼‰ï¼Œ$k=2$ è¡¨ç¤ºä¿®æ”¹ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ä¸ªæŸ¥è¯¢æŒ‡ä»¤è¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚

æ¯ä¸ªç­”æ¡ˆå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$Nâ‰¤500000,Mâ‰¤100000$,
$âˆ’1000â‰¤A[i]â‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5 3
1 2 -3 4 5
1 2 3
2 2 -1
1 3 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
-1
```

> **è§£æ**

é¦–å…ˆéœ€è¦ç¡®å®š**çº¿æ®µæ ‘èŠ‚ç‚¹** `struct node` æ‰€åŒ…å«çš„ä¿¡æ¯ã€‚

è¦æ±‚åŒºé—´å†…**æœ€å¤§è¿ç»­å­æ®µå’Œ**ï¼Œå› æ­¤çº¿æ®µæ ‘èŠ‚ç‚¹ä¸­å¿…é¡»è¦æœ‰ä¸€ä¸ªæ•° **$t_{max}$** ç”¨æ¥å­˜å‚¨å½“å‰åŒºé—´ **$[l,r]$** çš„**æœ€å¤§è¿ç»­å­—æ®µå’Œ**ã€‚

è€ƒè™‘å­èŠ‚ç‚¹å‘çˆ¶èŠ‚ç‚¹è½¬ç§»ï¼Œå•ç‹¬æœ‰ **$t_{max}$** å¹¶ä¸å¤Ÿã€‚å½“çˆ¶èŠ‚ç‚¹çš„æœ€å¤§è¿ç»­å­æ®µå’Œæ˜¯è·¨è¶Šå·¦å³å­èŠ‚ç‚¹æ—¶ï¼Œå¹¶ä¸èƒ½ä¿è¯å¯ä»¥ç›´æ¥ç”± **$t_{max}$** è½¬ç§»è¿‡æ¥ã€‚

æ­¤æ—¶æˆ‘ä»¬éœ€è¦å·¦å­èŠ‚ç‚¹çš„**æœ€å¤§åç¼€å’Œ** **$\{r_{max}\}$** ä»¥åŠå³å­èŠ‚ç‚¹çš„**æœ€å¤§å‰ç¼€å’Œ** **$\{l_{max}\}$**ã€‚

ç”±äºå·¦å³å­èŠ‚ç‚¹äº’ç›¸ç‹¬ç«‹ï¼Œå› æ­¤å‘çˆ¶èŠ‚ç‚¹è½¬ç§»çš„ **$t_{max}$** åªæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š

- å·¦å­èŠ‚ç‚¹çš„**æœ€å¤§è¿ç»­å­æ®µå’Œ** **$l.t_{max}$**ï¼›
- å³å­èŠ‚ç‚¹çš„**æœ€å¤§è¿ç»­å­æ®µå’Œ** **$r.t_{max}$**ï¼›
- å·¦å­èŠ‚ç‚¹çš„**æœ€å¤§åç¼€å’Œ** **$\{l.r_{max}\}$** + å³å­èŠ‚ç‚¹çš„**æœ€å¤§å‰ç¼€å’Œ** **$\{r.l_{max}\}$**ã€‚

çˆ¶èŠ‚ç‚¹ **$u.t_{max}$** å³ä¸ºï¼š

$$
u.t_{max} = \max(l.r_{max} + r.l_{max}, \max(l.t_{max}, r.t_{max}));
$$

é‚£ä¹ˆçˆ¶èŠ‚ç‚¹çš„ **$l_{max}$** å’Œ **$r_{max}$** æ˜¯å¦å¯ä»¥é€šè¿‡å½“å‰å·²çŸ¥ä¿¡æ¯ç›´æ¥è½¬ç§»å‘¢ï¼Ÿç­”æ¡ˆæ˜¯**ä¸èƒ½**ã€‚

çˆ¶èŠ‚ç‚¹çš„**æœ€å¤§å‰ç¼€å’Œ** **$l_{max}$** å¯èƒ½ä¼šæ˜¯ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š

- å·¦å­èŠ‚ç‚¹çš„**æœ€å¤§å‰ç¼€å’Œ** **$l.l_{max}$**ï¼›
- å·¦å­èŠ‚ç‚¹çš„**å…¨éƒ¨å…ƒç´ å’Œ** **$\sum_{i=l}^{mid} A[i]$** + å³å­èŠ‚ç‚¹çš„**æœ€å¤§å‰ç¼€å’Œ** **$r.l_{max}$**ã€‚

å³

$$
u.l_{max} = \max(l.l_{max}, l.sum + r.l_{max});
$$

åŒç†ï¼Œçˆ¶èŠ‚ç‚¹çš„**æœ€å¤§åç¼€å’Œ** **$r_{max}$** çš„ä¸¤ç§æƒ…å†µä¸ºï¼š

- å³å­èŠ‚ç‚¹çš„**æœ€å¤§åç¼€å’Œ** **$r.r_{max}$**ï¼›
- å³å­èŠ‚ç‚¹çš„**å…¨éƒ¨å…ƒç´ å’Œ** **$\sum_{i=mid+1}^{r} A[i]$** + å·¦å­èŠ‚ç‚¹çš„**æœ€å¤§åç¼€å’Œ** **$l.r_{max}$**ã€‚

å³

$$
u.r_{max} = \max(r.r_{max}, r.sum + l.r_{max});
$$

ç”±ä¸Šè¿°å¯è§ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª **$sum$** æ¥å­˜å‚¨å½“å‰èŠ‚ç‚¹**åŒºé—´å†…æ‰€æœ‰å…ƒç´ çš„å’Œ**ã€‚è€Œçˆ¶èŠ‚ç‚¹çš„ **$sum$** å¯ä»¥ç›´æ¥ç”±å·¦å³å­èŠ‚ç‚¹çš„ **$sum$** è®¡ç®—å¾—å‡ºã€‚

å³

$$
u.sum = l.sum + r.sum;
$$
ç»¼ä¸Šæ‰€è¿°ï¼Œ `node` ä¸­åŒ…å«ä¿¡æ¯å¦‚ä¸‹ï¼š

```clojure
/************************************
*   sum : sum of [l, r]             
*   lmax: æœ€å¤§å‰ç¼€å’Œ                
*   rmax: æœ€å¤§åç¼€å’Œ                
*   tmax: åŒºé—´[l, r]æœ€å¤§è¿ç»­å­æ®µå’Œ  
************************************/
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 500010;
int n, m;
int w[N]; // è¾“å…¥çš„ n ä¸ªæ•´æ•° 
struct node
{
    int l, r;
    int sum, lmax, rmax, tmax;
}tr[N * 4];
void pushup(node &u, node &l, node &r)
{
    u.sum = l.sum + r.sum;
    u.lmax = max(l.lmax, l.sum + r.lmax);
    u.rmax = max(r.rmax, r.sum + l.rmax);
    u.tmax = max(max(l.tmax, r.tmax), l.rmax + r.lmax);
}
void pushup(int u)
{
    pushup(tr[u], tr[u << 1], tr[u << 1 | 1]); // è¿™é‡Œä½¿ç”¨äº†é‡è½½å‡½æ•°æ“ä½œï¼Œç®€æ´ä»£ç 
}
void build(int u, int l, int r) {
    if (l == r) tr[u] = {l, r, w[r], w[r], w[r], w[r]}; // æ‰¾åˆ°å¶å­èŠ‚ç‚¹
    else
	{
        tr[u] = {l, r}; // è®¾å½“å‰èŠ‚ç‚¹åŒºé—´ä¸º[l,r]
        int mid = l + r >> 1;
        build(u << 1, l, mid); // å»ºç«‹å·¦å­æ ‘
        build(u << 1 | 1, mid + 1, r); // å»ºç«‹å³å­æ ‘
        pushup(u); // ä¿®æ”¹çˆ¶èŠ‚ç‚¹
    }
}
void modify(int u, int x, int v) {
    if (tr[u].l == x && tr[u].r == x) tr[u] = {x, x, v, v, v, v}; // æ‰¾åˆ°äº†
    else
	{
        int mid = tr[u].l + tr[u].r >> 1;
        if (x <= mid) modify(u << 1, x, v); // x ä½äºå½“å‰åŒºé—´çš„å·¦åŠå­åŒºé—´
        else modify(u << 1 | 1, x, v); // x ä½äºå½“å‰åŒºé—´çš„å³åŠå­åŒºé—´
        pushup(u); // ä¿®æ”¹çˆ¶èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯
    }
}
node query(int u, int l, int r) // ä»èŠ‚ç‚¹ u å¼€å§‹ï¼ŒæŸ¥æ‰¾åŒºé—´[l,r]çš„ä¿¡æ¯
{
	/*
        1.åŒ…å«åœ¨åŒºé—´å†…
            Tl-----Tr
         L-------------R  
    */
    if (tr[u].l >= l && tr[u].r <= r) return tr[u];
    int mid = tr[u].l + tr[u].r >> 1;
    /*
        2.åœ¨å½“å‰çš„å·¦åŠåŒºé—´
           Tl-----m-----Tr
             L---R
    */
    if (r <= mid) return query(u << 1, l, r);
    /*
        3.åœ¨å½“å‰çš„å³åŠåŒºé—´
          Tl-----m-----Tr
                   L----R
    */
    else if (l > mid) return query(u << 1 | 1, l, r);
    /*
        4.ä¸¤è¾¹éƒ½æœ‰ï¼Œéƒ½æŸ¥è¯¢
           Tl----m----Tr
              L-----R
    */
    else 
	{
        auto left = query(u << 1, l, r);
        auto right = query(u << 1 | 1, l, r);
        node res;
        pushup(res, left, right); // åˆå¹¶ç­”æ¡ˆ
        return res;
    }
}
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++) cin >> w[i];
    build(1, 1, n);
    int k, x, y;
    while (m --)
    {
        cin >> k >> x >> y;
        if (k == 1)
        {
            if (x > y) swap(x, y);
            cout << query(1, x, y).tmax << endl;
        }
        else modify(1, x, y);
    }
    return 0;
}
```

# æœç´¢ä¸å›¾è®º

## 1. DFS

### 1.1 å…¨æ’åˆ—

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªæ•´æ•° $n$ï¼Œå°†æ•°å­— $1âˆ¼n$ æ’æˆä¸€æ’ï¼Œå°†ä¼šæœ‰å¾ˆå¤šç§æ’åˆ—æ–¹æ³•ã€‚

ç°åœ¨ï¼Œè¯·ä½ æŒ‰ç…§å­—å…¸åºå°†æ‰€æœ‰çš„æ’åˆ—æ–¹æ³•è¾“å‡ºã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $n$ã€‚

**è¾“å‡ºæ ¼å¼**

æŒ‰å­—å…¸åºè¾“å‡ºæ‰€æœ‰æ’åˆ—æ–¹æ¡ˆï¼Œæ¯ä¸ªæ–¹æ¡ˆå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤7$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 2 3
1 3 2
2 1 3
2 3 1
3 1 2
3 2 1
```

> **è§£æ**

![dfs_full_permutation](/figs/dfs_full_permutation)

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
ll a[101], book[101], n;
void dfs(ll step)
{
	if(step == n + 1)
	{
		for(ll i = 1; i <= n; i ++)
		{
			cout << a[i] << " ";
		}
		cout << endl;
		return;
	}
	for(ll i = 1; i <= n; i ++)
	{
		if(book[i] == 0)
		{
			a[step] = i;
			book[i] = 1;
			dfs(step + 1);
			book[i] = 0;
		}
	}
	return;
}
int main()
{
	cin >> n;
	dfs(1);
	return 0;
}
```

### 1.2 ä»nä¸ªæ•°ä¸­éšæœºé€‰å–kä¸ªæ•°

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªæ•´æ•° $n$ å’Œä¸€ä¸ªæ•´æ•° $k$ï¼Œä»è¿™ $n$ ä¸ªæ•°ä¸­éšæœºé€‰å– $k$ ä¸ªæ•°ï¼Œå¹¶ä¸”è¾“å‡ºçš„è¿™ $k$ ä¸ªæ•°ä¸é‡å¤ã€‚

ç°åœ¨ï¼Œè¯·ä½ æŒ‰ç…§å­—å…¸åºå°†æ‰€æœ‰çš„æ’åˆ—æ–¹æ³•è¾“å‡ºã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $k$ã€‚

**è¾“å‡ºæ ¼å¼**

æŒ‰å­—å…¸åºè¾“å‡ºæ‰€æœ‰æ’åˆ—æ–¹æ¡ˆï¼Œæ¯ä¸ªæ–¹æ¡ˆå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤7$

$1â‰¤kâ‰¤7$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
6 3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 2 3
1 2 4
1 2 5
1 2 6
1 3 4
1 3 5
1 3 6
1 4 5
1 4 6
1 5 6
2 3 4
2 3 5
2 3 6
2 4 5
2 4 6
2 5 6
3 4 5
3 4 6
3 5 6
4 5 6
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 10010;
ll a[N], book[N], n, k, ans;
void dfs(ll step, ll p)
{
	if(step == k + 1)
	{
		for(int i = 1; i <= k; i ++)
		{
			cout << a[i] << " ";
		}
		cout << endl;
		return;
	}
	for(ll i = p; i <= n; i ++)
	{
		if(book[i] == 0)
		{
			a[step] = i;
			book[i] = 1;
			dfs(step + 1, i + 1); // i + 1 ä¿è¯äº†ä¸å›å¤´
			book[i] = 0;
		}
	}
	return;
}
int main()
{
	cin >> n >> k;
	dfs(1, 1);
	return 0;
}
```

### 1.3 æœ€å¤§è¿é€š

> **é¢˜ç›®**

[1.æœ€å¤§è¿é€š - è“æ¡¥äº‘è¯¾ (lanqiao.cn)](https://www.lanqiao.cn/problems/2410/learning/?page=1&first_category_id=1&problem_id=2410)

**é—®é¢˜æè¿°**

å°è“æœ‰ä¸€ä¸ª $30$ è¡Œ $60$ åˆ—çš„æ•°å­—çŸ©é˜µï¼ŒçŸ©é˜µä¸­çš„æ¯ä¸ªæ•°éƒ½æ˜¯ $0$ æˆ– $1$ ã€‚

```text
110010000011111110101001001001101010111011011011101001111110

010000000001010001101100000010010110001111100010101100011110 

001011101000100011111111111010000010010101010111001000010100 

101100001101011101101011011001000110111111010000000110110000 

010101100100010000111000100111100110001110111101010011001011 

010011011010011110111101111001001001010111110001101000100011 

101001011000110100001101011000000110110110100100110111101011 

101111000000101000111001100010110000100110001001000101011001 

001110111010001011110000001111100001010101001110011010101110 

001010101000110001011111001010111111100110000011011111101010 

011111100011001110100101001011110011000101011000100111001011 

011010001101011110011011111010111110010100101000110111010110 

001110000111100100101110001011101010001100010111110111011011 

111100001000001100010110101100111001001111100100110000001101 

001110010000000111011110000011000010101000111000000110101101 

100100011101011111001101001010011111110010111101000010000111 

110010100110101100001101111101010011000110101100000110001010 

110101101100001110000100010001001010100010110100100001000011 

100100000100001101010101001101000101101000000101111110001010 

101101011010101000111110110000110100000010011111111100110010 

101111000100000100011000010001011111001010010001010110001010 

001010001110101010000100010011101001010101101101010111100101 

001111110000101100010111111100000100101010000001011101100001 

101011110010000010010110000100001010011111100011011000110010 

011110010100011101100101111101000001011100001011010001110011 

000101000101000010010010110111000010101111001101100110011100 

100011100110011111000110011001111100001110110111001001000111 

111011000110001000110111011001011110010010010110101000011111 

011110011110110110011011001011010000100100101010110000010011 

010011110011100101010101111010001001001111101111101110011101
```

å¦‚æœä»ä¸€ä¸ªæ ‡ä¸º $1$ çš„ä½ç½®å¯ä»¥é€šè¿‡ä¸Šä¸‹å·¦å³èµ°åˆ°å¦ä¸€ä¸ªæ ‡ä¸º $1$ çš„ä½ç½®ï¼Œåˆ™ç§°ä¸¤ä¸ªä½ç½®è¿é€šã€‚ä¸æŸä¸€ä¸ªæ ‡ä¸º $1$ çš„ä½ç½®è¿é€šçš„æ‰€æœ‰ä½ç½®ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰ç»„æˆä¸€ä¸ªè¿é€šåˆ†å—ã€‚è¯·é—®çŸ©é˜µä¸­æœ€å¤§çš„è¿é€šåˆ†å—æœ‰å¤šå¤§ï¼Ÿ

**ç­”æ¡ˆæäº¤**

è¿™æ˜¯ä¸€é“ç»“æœå¡«ç©ºçš„é¢˜ï¼Œä½ åªéœ€è¦ç®—å‡ºç»“æœåæäº¤å³å¯ã€‚æœ¬é¢˜çš„ç»“æœä¸ºä¸€ä¸ªæ•´æ•°ï¼Œåœ¨æäº¤ç­”æ¡ˆæ—¶åªå¡«å†™è¿™ä¸ªæ•´æ•°ï¼Œå¡«å†™å¤šä½™çš„å†…å®¹å°†æ— æ³•å¾—åˆ†ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 101;
char a[N][N];
int row = 30, col = 60;
int cnt; // æœ€å¤§è¿é€šå—ä¸­ 1 çš„æ•°é‡
int dx[4] = {0, 0, -1, 1}, dy[4] = {1, -1, 0, 0}; // â€œä¸Šã€ä¸‹ã€å·¦ã€å³â€å››ä¸ªæ–¹å‘
int dfs(int x, int y)
{
  if(a[x][y] == '0')
  {
    return 0;
  }
  a[x][y] = '0'; // å°†éå†è¿‡çš„ 1 å…¨éƒ¨ä¿®æ”¹ä¸º 0 ï¼Œé¿å…é‡å¤éå†
  int sum = 1; // è¿é€šå—ä¸­ 1 çš„æ•°é‡
  for(int i = 0; i < 4; i ++) // å››ä¸ªæ–¹å‘éå†
  {
    int nx = x + dx[i], ny = y + dy[i];
    if(nx < 0 || ny < 0 || nx >= row || ny >= col)
    {
      continue;
    }
    sum += dfs(nx, ny);
  }
  return sum;
}
int main()
{
  for(int i = 0; i < row; i ++)
  {
    cin >> a[i];
  }
  for(int i = 0; i < row; i ++)
  {
    for(int j = 0; j < col; j ++)
    {
      if(a[i][j] == '0')
      {
        continue;
      }
      cnt = max(cnt, dfs(i, j));
    }
  }
  cout << cnt << endl;
  return 0;
}
```

### 1.4 å…«çš‡å

> **é¢˜ç›®**

[P1219 [USACO1.5\] å…«çš‡å Checker Challenge - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/problem/P1219)

**é¢˜ç›®æè¿°**

ä¸€ä¸ªå¦‚ä¸‹çš„ $6 \times 6$ çš„è·³æ£‹æ£‹ç›˜ï¼Œæœ‰å…­ä¸ªæ£‹å­è¢«æ”¾ç½®åœ¨æ£‹ç›˜ä¸Šï¼Œä½¿å¾—æ¯è¡Œã€æ¯åˆ—æœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼Œæ¯æ¡å¯¹è§’çº¿ï¼ˆåŒ…æ‹¬ä¸¤æ¡ä¸»å¯¹è§’çº¿çš„æ‰€æœ‰å¹³è¡Œçº¿ï¼‰ä¸Šè‡³å¤šæœ‰ä¸€ä¸ªæ£‹å­ã€‚

![](/figs/eight_queens)

ä¸Šé¢çš„å¸ƒå±€å¯ä»¥ç”¨åºåˆ— $2\ 4\ 6\ 1\ 3\ 5$ æ¥æè¿°ï¼Œç¬¬ $i$ ä¸ªæ•°å­—è¡¨ç¤ºåœ¨ç¬¬ $i$ è¡Œçš„ç›¸åº”ä½ç½®æœ‰ä¸€ä¸ªæ£‹å­ï¼Œå¦‚ä¸‹ï¼š

è¡Œå· $1\ 2\ 3\ 4\ 5\ 6$

åˆ—å· $2\ 4\ 6\ 1\ 3\ 5$

è¿™åªæ˜¯æ£‹å­æ”¾ç½®çš„ä¸€ä¸ªè§£ã€‚è¯·ç¼–ä¸€ä¸ªç¨‹åºæ‰¾å‡ºæ‰€æœ‰æ£‹å­æ”¾ç½®çš„è§£ã€‚ å¹¶æŠŠå®ƒä»¬ä»¥ä¸Šé¢çš„åºåˆ—æ–¹æ³•è¾“å‡ºï¼Œè§£æŒ‰å­—å…¸é¡ºåºæ’åˆ—ã€‚ 

è¯·è¾“å‡ºå‰ $3$ ä¸ªè§£ã€‚æœ€åä¸€è¡Œæ˜¯è§£çš„æ€»ä¸ªæ•°ã€‚

**è¾“å…¥æ ¼å¼**

ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° $n$ï¼Œè¡¨ç¤ºæ£‹ç›˜æ˜¯ $n \times n$ å¤§å°çš„ã€‚

**è¾“å‡ºæ ¼å¼**

å‰ä¸‰è¡Œä¸ºå‰ä¸‰ä¸ªè§£ï¼Œæ¯ä¸ªè§£çš„ä¸¤ä¸ªæ•°å­—ä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚ç¬¬å››è¡Œåªæœ‰ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè§£çš„æ€»æ•°ã€‚

**æ ·ä¾‹ #1**

**æ ·ä¾‹è¾“å…¥ #1**

```
6
```

**æ ·ä¾‹è¾“å‡º #1**

```
2 4 6 1 3 5
3 6 2 5 1 4
4 1 5 2 6 3
4
```

**æç¤º** 
å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$6 \le n \le 13$ã€‚

> **è§£æ**

**æ¨ªå‘çºµå‘ä¸å†²çª**ï¼š

- **DFS**ï¼šç±»ä¼¼å…¨æ’åˆ—çš„åŸç†ï¼Œå¯ä»¥è§£å†³æ¨ªå‘å’Œçºµå‘ä¸å†²çªçš„é—®é¢˜

**å¯¹è§’çº¿ä¸å†²çª**ï¼š

- **æš´åŠ›** ($Ã—$) ï¼šå¦‚æœæ˜¯ç›´æ¥æŒ‰ç…§å…¨æ’åˆ—æ¥æœç´¢ï¼Œä¹‹ååˆ¤æ–­å¯¹è§’çº¿æ–¹å‘æ˜¯å¦å†²çªï¼ˆå³ç›¸åŠ æˆ–ç›¸å‡æœ‰é‡å¤å…ƒç´ ï¼‰ï¼Œä¼šè¶…æ—¶ï¼Œåªèƒ½ $AC$ $50\%$çš„ç‚¹
- **å‰ªæ** ($âˆš$) ï¼šå¯ä»¥ç›´æ¥åœ¨æœç´¢æ—¶æ ‡è®°æŸæ¡å¯¹è§’çº¿æ˜¯å¦å·²è¢«å é¢†ï¼Œç›´æ¥ä¸æœç´¢å·²è¢«å é¢†çš„åœ°æ–¹ï¼Œæé«˜æ•ˆç‡

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll; 
const int N = 101;
ll a[N];
ll book[N], dg[N], udg[N]; // dgä¸ºæ­£å¯¹è§’çº¿æ˜¯å¦å é¢†ï¼Œudgä¸ºåå¯¹è§’çº¿æ˜¯å¦å·²å é¢† 
ll n, cnt;   
void dfs(ll step)
{
	if(step == n + 1)
	{
    	cnt ++;
    	if(cnt <= 3) // åªè¾“å‡ºå‰ä¸‰ä¸ªæƒ…å†µ 
    	{
    		for(int i = 1; i <= n; i ++)
    		{
    			cout << a[i] << " "; 
			}
			cout << endl; 
		}
		return;
	}
	for(int i = 1; i <= n; i ++)
	{
		if(book[i] == 0 && dg[i + step] == 0 && udg[30 + i - step] == 0)
		{
			a[step] = i;
			book[i] = 1;
			dg[i + step] = 1; // æ­£å¯¹è§’çº¿å·²å é¢† 
			udg[30 + i - step] = 1; // åå¯¹è§’çº¿å·²å é¢†ã€‚+30ç›®çš„æ˜¯é˜²æ­¢æ•°å­—ä¸‹æ ‡å˜ä¸ºè´Ÿæ•°
			dfs(step + 1);
			book[i] = 0;
			dg[i + step] = 0; // æ­£å¯¹è§’çº¿å·²æ¢å¤ 
			udg[30 + i - step] = 0; // åå¯¹è§’çº¿å·²æ¢å¤ 
		}
	}
}
int main()
{
	cin >> n;
	dfs(1);
	cout << cnt << endl;
	return 0;
}
```

## 2. BFS

### 2.1 èµ°è¿·å®«

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $nÃ—m$ çš„äºŒç»´æ•´æ•°æ•°ç»„ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªè¿·å®«ï¼Œæ•°ç»„ä¸­åªåŒ…å« $0$ æˆ– $1$ï¼Œå…¶ä¸­ $0$ è¡¨ç¤ºå¯ä»¥èµ°çš„è·¯ï¼Œ$1$ è¡¨ç¤ºä¸å¯é€šè¿‡çš„å¢™å£ã€‚

æœ€åˆï¼Œæœ‰ä¸€ä¸ªäººä½äºå·¦ä¸Šè§’ $(1,1)$ å¤„ï¼Œå·²çŸ¥è¯¥äººæ¯æ¬¡å¯ä»¥å‘ä¸Šã€ä¸‹ã€å·¦ã€å³ä»»æ„ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚

è¯·é—®ï¼Œè¯¥äººä»å·¦ä¸Šè§’ç§»åŠ¨è‡³å³ä¸‹è§’ $(n,m)$ å¤„ï¼Œè‡³å°‘éœ€è¦ç§»åŠ¨å¤šå°‘æ¬¡ã€‚

æ•°æ®ä¿è¯ $(1,1)$ å¤„å’Œ $(n,m)$ å¤„çš„æ•°å­—ä¸º $0$ï¼Œä¸”ä¸€å®šè‡³å°‘å­˜åœ¨ä¸€æ¡é€šè·¯ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $m$ ä¸ªæ•´æ•°ï¼ˆ$0$ æˆ– $1$ï¼‰ï¼Œè¡¨ç¤ºå®Œæ•´çš„äºŒç»´æ•°ç»„è¿·å®«ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä»å·¦ä¸Šè§’ç§»åŠ¨è‡³å³ä¸‹è§’çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤100$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5 5
0 1 0 0 0
0 1 0 1 0
0 0 0 0 0
0 1 1 1 0
0 0 0 1 0
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
8
```

> **è§£æ**

å¹¿åº¦ä¼˜å…ˆæœç´¢æ€æƒ³ï¼š

ä»èµ·ç‚¹å¼€å§‹ï¼Œå¾€å‰èµ°ç¬¬ä¸€æ­¥ï¼Œè®°å½•ä¸‹æ‰€æœ‰ç¬¬ä¸€æ­¥èƒ½èµ°åˆ°çš„ç‚¹ï¼Œç„¶åä»æ‰€ç¬¬ä¸€æ­¥èƒ½èµ°åˆ°çš„ç‚¹å¼€å§‹ï¼Œå¾€å‰èµ°ç¬¬äºŒæ­¥ï¼Œè®°å½•ä¸‹æ‰€æœ‰ç¬¬äºŒæ­¥èƒ½èµ°åˆ°çš„ç‚¹ï¼Œé‡å¤ä¸‹å»ï¼Œç›´åˆ°èµ°åˆ°ç»ˆç‚¹ã€‚è¾“å‡ºæ­¥æ•°å³å¯ã€‚

<img src="/figs/bfs" alt="image-20241030172824685" style="zoom: 50%;" />

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
typedef pair<int, int> PII;
const int N = 110;
int n, m;
int g[N][N], d[N][N]; // g[i][j] å­˜å‚¨åœ°å›¾ï¼Œd[i][j] å­˜å‚¨ç‚¹ (i,j) åˆ°åŸç‚¹çš„è·ç¦» 
int bfs()
{
    queue<PII> q;
    memset(d, -1, sizeof(d));
    d[0][0] = 0; // åŸç‚¹åˆ°è‡ªå·±çš„è·ç¦»ä¸º 0 
    q.push({0, 0}); // å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ— 
    int dx[4] = {-1, 0, 1, 0}, dy[4] = {0, 1, 0, -1}; // å‘å››ä¸ªæ–¹å‘éå† 
    while (q.size()) // é˜Ÿåˆ—ä¸ä¸ºç©º 
    {
        auto t = q.front();
        q.pop();
        for (int i = 0; i < 4; i ++) // å‘å››ä¸ªæ–¹å‘éå†
        {
            int x = t.first + dx[i], y = t.second + dy[i];
            if (x >= 0 && x < n && y >= 0 && y < m && g[x][y] == 0 && d[x][y] == -1) // g[x][y] == 0 è¡¨ç¤ºå¯ä»¥ç»è¿‡ï¼›d[x][y] == -1 è¡¨ç¤ºè¿˜æœªè¢«éå†è¿‡ï¼ˆå› ä¸ºå¦‚æœä¹‹å‰å°±éå†åˆ°äº†èŠ‚ç‚¹ (i,j) ï¼Œè¯´æ˜ä¹‹å‰é‚£ä¸ªæ˜¯æ›´çŸ­è·ç¦»ï¼‰ 
            {
                d[x][y] = d[t.first][t.second] + 1; // ä»å½“å‰ç‚¹èµ°è¿‡å»ï¼Œåˆ™è·ç¦»ç­‰äºå½“å‰ç‚¹å’ŒåŸç‚¹ä¹‹é—´çš„è·ç¦» + 1
                q.push({x, y}); // å°†è¿™ä¸ªç‚¹æ”¾å…¥é˜Ÿåˆ—ï¼Œç”¨æ¥èµ°åˆ°å’Œå®ƒç›¸é‚»çš„ç‚¹
            }
        }
    }
    return d[n - 1][m - 1];
}
int main()
{
    cin >> n >> m;
    for (int i = 0; i < n; i ++)
        for (int j = 0; j < m; j ++)
            cin >> g[i][j];
    cout << bfs() << endl;
    return 0;
}
```

### 2.2 å…«æ•°ç 

> **é¢˜ç›®**

åœ¨ä¸€ä¸ª $3Ã—3$ çš„ç½‘æ ¼ä¸­ï¼Œ$1âˆ¼8$ è¿™ $8$ ä¸ªæ•°å­—å’Œä¸€ä¸ª `x` æ°å¥½ä¸é‡ä¸æ¼åœ°åˆ†å¸ƒåœ¨è¿™ $3Ã—3$ çš„ç½‘æ ¼ä¸­ã€‚

ä¾‹å¦‚ï¼š

```
1 2 3
x 4 6
7 5 8
```

åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æŠŠ `x` ä¸å…¶ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘ä¹‹ä¸€çš„æ•°å­—äº¤æ¢ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚

æˆ‘ä»¬çš„ç›®çš„æ˜¯é€šè¿‡äº¤æ¢ï¼Œä½¿å¾—ç½‘æ ¼å˜ä¸ºå¦‚ä¸‹æ’åˆ—ï¼ˆç§°ä¸ºæ­£ç¡®æ’åˆ—ï¼‰ï¼š

```
1 2 3
4 5 6
7 8 x
```

ä¾‹å¦‚ï¼Œç¤ºä¾‹ä¸­å›¾å½¢å°±å¯ä»¥é€šè¿‡è®© `x` å…ˆåä¸å³ã€ä¸‹ã€å³ä¸‰ä¸ªæ–¹å‘çš„æ•°å­—äº¤æ¢æˆåŠŸå¾—åˆ°æ­£ç¡®æ’åˆ—ã€‚

äº¤æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š

```
1 2 3   1 2 3   1 2 3   1 2 3
x 4 6   4 x 6   4 5 6   4 5 6
7 5 8   7 5 8   7 x 8   7 8 x
```

ç°åœ¨ï¼Œç»™ä½ ä¸€ä¸ªåˆå§‹ç½‘æ ¼ï¼Œè¯·ä½ æ±‚å‡ºå¾—åˆ°æ­£ç¡®æ’åˆ—è‡³å°‘éœ€è¦è¿›è¡Œå¤šå°‘æ¬¡äº¤æ¢ã€‚

**è¾“å…¥æ ¼å¼**

è¾“å…¥å ä¸€è¡Œï¼Œå°† $3Ã—3$ çš„åˆå§‹ç½‘æ ¼æç»˜å‡ºæ¥ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœåˆå§‹ç½‘æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š

```
1 2 3 
x 4 6 
7 5 8 
```

åˆ™è¾“å…¥ä¸ºï¼š`1 2 3 x 4 6 7 5 8`

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°‘äº¤æ¢æ¬¡æ•°ã€‚

å¦‚æœä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2 3 4 1 5 x 7 6 8
```

**è¾“å‡ºæ ·ä¾‹**

```
19
```

> **è§£æ**

ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ŒæŠŠæ¯ä¸€ä¸ªçŠ¶æ€ `state` ï¼ˆå¦‚ `â€œ23415x768â€` ï¼‰çœ‹æˆæ˜¯å›¾è®ºä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€æ­¥ä¸€æ­¥å¹¿åº¦æœç´¢ï¼Œç›´åˆ°æœç´¢åˆ°çŠ¶æ€ `"12345678x"` ååœæ­¢

éš¾ç‚¹åœ¨äº**çŠ¶æ€è¡¨ç¤º**ã€‚æœ€å°‘äº¤æ¢æ¬¡æ•°çš„çŠ¶æ€ä½¿ç”¨ `unordered_map<string, int> d` é”®å€¼å¯¹ï¼ˆå­—å…¸ï¼‰æ¥è¡¨ç¤º

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
int bfs(string state)
{
    queue<string> q;
    unordered_map<string, int> d; // å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ï¼Œå¦‚ d[string] = int ã€‚d å­˜å‚¨çš„æ˜¯ï¼ˆæœ€çŸ­ï¼‰è·ç¦»ï¼Œå¯¹åº”é¢˜ç›®ä¸­â€œï¼ˆæœ€å°‘ï¼‰äº¤æ¢æ¬¡æ•°â€ 
    q.push(state);
    d[state] = 0;
    int dx[4] = {-1, 0, 1, 0}, dy[4] = {0, 1, 0, -1};
    string end = "12345678x";
    while (q.size())
    {
        auto t = q.front();
        q.pop();
        if (t == end) return d[t]; // äº¤æ¢å¾—åˆ°æœ€ç»ˆç»“æœï¼Œç›´æ¥ return äº¤æ¢æ¬¡æ•° 
        int distance = d[t];
        int k = t.find('x');
        int x = k / 3, y = k % 3; // x ä¸ºæ¨ªåæ ‡ï¼Œyä¸ºçºµåæ ‡ 
        for (int i = 0; i < 4; i ++ )
        {
            int a = x + dx[i], b = y + dy[i]; // ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘æœç´¢ 
            if (a >= 0 && a < 3 && b >= 0 && b < 3)
            {
                swap(t[a * 3 + b], t[k]); // äº¤æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸¤ä¸ªå­—ç¬¦ 
                if (d.count(t) == 0) // unordered_map ä¸­ï¼Œ d.count(t) è¿”å›å€¼ä¸º 0 æˆ– 1ï¼Œd.count(t) ä¸º 1 è¡¨ç¤ºé”®ä¸º t çš„å€¼ä¸ä¸º 0ã€‚ å€¼ä¸º 0 åˆ™è¯´æ˜æ²¡æœ‰è¢«æœç´¢åˆ°è¿‡ 
                {
                    d[t] = distance + 1;
                    q.push(t);
                }
                swap(t[a * 3 + b], t[k]); // å†äº¤æ¢å›æ¥ 
            }
        }
    }
    return -1; // ä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆï¼Œè¾“å‡º -1 
}
int main()
{
    char s;
    string state; // åˆå§‹ç½‘æ ¼çŠ¶æ€ state 
    for (int i = 0; i < 9; i ++ )
    {
        cin >> s;
        state += s; // å»æ‰è¾“å…¥çš„ç©ºæ ¼ï¼Œå˜æˆä¸€æ®µè¿ç»­çš„å­—ç¬¦ä¸² "23415x768" 
    }
    cout << bfs(state) << endl;
    return 0;
}
```

## 3. Dijkstra

### 3.1 Dijkstraæ±‚æœ€çŸ­è·¯ I

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œæ‰€æœ‰è¾¹æƒå‡ä¸ºæ­£å€¼ã€‚

è¯·ä½ æ±‚å‡º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœæ— æ³•ä» $1$ å·ç‚¹èµ°åˆ° $n$ å·ç‚¹ï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $x,y,z$ï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ $x$ åˆ°ç‚¹ $y$ çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º $z$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚

å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤500,$
$1â‰¤mâ‰¤10^5,$
$å›¾ä¸­æ¶‰åŠè¾¹é•¿å‡ä¸è¶…è¿‡10000$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 3
1 2 2
2 3 1
1 3 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
```

> **è§£æ**

ä½¿ç”¨ $Dijkstra$ ç®—æ³•**æ±‚å•æºæœ€çŸ­è·¯å¾„**ã€‚ä½¿ç”¨**é‚»æ¥çŸ©é˜µ**åˆ›å»º**æœ‰å‘å›¾**ï¼ˆæ— å‘å›¾ä¹Ÿæ˜¯ç‰¹æ®Šçš„æœ‰å‘å›¾ï¼‰ï¼Œæ¡ä»¶ä¸º**å­˜åœ¨é‡è¾¹å’Œå­ç¯**ï¼Œ**è¾¹æƒå€¼å‡ä¸ºæ­£å€¼**

ç®—æ³•åŸºäºè´ªå¿ƒçš„ç­–ç•¥ï¼Œæ€æƒ³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="/figs/dijkstra" alt="dijkstra" style="zoom: 80%;" />

ç¼ºç‚¹ï¼šä½¿ç”¨é‚»æ¥çŸ©é˜µçš„è¯ï¼Œ`n` è¿‡å¤§æ—¶ä¼šçˆ†æ‰

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 510;
int n, m;
int g[N][N]; // g[i][j] æ˜¯æŒ‡ä» i èŠ‚ç‚¹åˆ° j èŠ‚ç‚¹çš„è·ç¦»ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸å­˜åœ¨ï¼ˆå³ +âˆï¼Œè¿™é‡Œç”¨ 0x3f3f3f3f è¡¨ç¤ºï¼‰ 
int dist[N]; // distance çš„ç¼©å†™ï¼Œä»£è¡¨æ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·å§‹ç‚¹ï¼ˆè¿™é‡Œæ˜¯èŠ‚ç‚¹ 1 ï¼‰çš„è·ç¦»
bool st[N]; // state çš„ç¼©å†™ï¼Œå½“st[i]ä¸º true æ—¶ï¼Œè¯´æ˜èŠ‚ç‚¹ i åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»å·²ç»ç¡®å®šäº†
int dijkstra()
{
    memset(dist, 0x3f, sizeof(dist)); // åˆå§‹åŒ–æ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·å§‹ç‚¹çš„è·ç¦»éƒ½ä¸º +âˆ
    dist[1] = 0; // èµ·å§‹ç‚¹åˆ°è‡ªå·±çš„è·ç¦»ä¸º 0
    // æ¯æ¬¡å¾ªç¯éƒ½ä¼šç¡®å®šä¸€ä¸ªæœ€å°å€¼ dist[t]ï¼Œè¿˜ä¼šå†åˆ›é€ ä¸€ä¸ªæœ€å°å€¼ï¼ˆç•™ç»™ä¸‹ä¸€æ¬¡å¾ªç¯å»ç¡®å®šï¼‰ 
    for (int i = 0; i < n - 1; i ++) // å¾ªç¯ n-1 æ¬¡ï¼Œè¡¨ç¤ºè¿›è¡Œ n-1 è½®è¿­ä»£ã€‚i æ— æ„ä¹‰
    {
    	// å¯»æ‰¾æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„*ç‚¹é›†*ä¸­çš„è·ç¦»æœ€å°ç‚¹ dist[t]
        int t = -1; // t è¡¨ç¤ºæœªç¡®å®šæœ€çŸ­è·¯å¾„çš„*ç‚¹é›†*ä¸­çš„è·ç¦»æœ€å°ç‚¹çš„*åºå·*
        for (int j = 1; j <= n; j ++ )
            if (!st[j] && (t == -1 || dist[t] > dist[j]))
                t = j;
        st[t] = true; // è¿™ä¸€è½®è¿­ä»£çš„æœ€å°å€¼å·²ç»ç¡®å®š 
        // æ ¹æ®èŠ‚ç‚¹ t è¿›è¡Œæ‹“å±• 
        for (int j = 1; j <= n; j ++ )
            dist[j] = min(dist[j], dist[t] + g[t][j]); // æ›´æ–°æœ€çŸ­è·ç¦» 
    }
    if (dist[n] == 0x3f3f3f3f) return -1; // å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œè¿”å› -1
    return dist[n];
}
int main()
{
    cin >> n >> m;
	// é»˜è®¤åˆå§‹åŒ–æ‰€æœ‰è¾¹é•¿åº¦ä¸º +âˆ
    memset(g, 0x3f, sizeof(g)); // memset å‡½æ•°åˆå§‹åŒ–ç‰¹ç‚¹æ˜¯æŒ‰å­—èŠ‚å»é€ä¸ªåˆå§‹åŒ–ï¼Œæ‰€ä»¥å¾—åˆ° 0x3f3f3f3f ï¼Œè¡¨ç¤ºä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œä½†åˆä¸è‡³äºæº¢å‡º 
    while (m --)
    {
        int a, b, c;
        cin >> a >> b >> c;
        g[a][b] = min(g[a][b], c); // å¯èƒ½å­˜åœ¨é‡è¾¹ï¼ˆä¸¤ä¸ªç‚¹ä¹‹é—´æœ‰å¤šæ¡è¾¹ï¼‰ï¼Œæ‰€ä»¥åªå–æœ€çŸ­çš„é‚£æ¡ 
    }
    cout << dijkstra() << endl; // åˆ©ç”¨ Dijkstra ç®—æ³•æ±‚è§£æœ€çŸ­è·¯å¾„ 
    return 0;
}
```

### 3.2 Dijkstraæ±‚æœ€çŸ­è·¯ II

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œæ‰€æœ‰è¾¹æƒå‡ä¸ºéè´Ÿå€¼ã€‚

è¯·ä½ æ±‚å‡º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœæ— æ³•ä» $1$ å·ç‚¹èµ°åˆ° $n$ å·ç‚¹ï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $x,y,z$ï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ $x$ åˆ°ç‚¹ $y$ çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º $z$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚

å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤1.5Ã—10^5,$
$å›¾ä¸­æ¶‰åŠè¾¹é•¿å‡ä¸å°äº $0$ï¼Œä¸”ä¸è¶…è¿‡ 10000$ã€‚
$æ•°æ®ä¿è¯ï¼šå¦‚æœæœ€çŸ­è·¯å­˜åœ¨ï¼Œåˆ™æœ€çŸ­è·¯çš„é•¿åº¦ä¸è¶…è¿‡ 10^9$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 3
1 2 2
2 3 1
1 3 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
```

> **è§£æ**

ä½¿ç”¨ $Dijkstra$ ç®—æ³•**æ±‚å•æºæœ€çŸ­è·¯å¾„**ã€‚ä½¿ç”¨**é‚»æ¥è¡¨**åˆ›å»º**æœ‰å‘å›¾**ï¼ˆæ— å‘å›¾ä¹Ÿæ˜¯ç‰¹æ®Šçš„æœ‰å‘å›¾ï¼‰ï¼Œæ¡ä»¶ä¸º**å­˜åœ¨é‡è¾¹å’Œå­ç¯**ï¼Œ**è¾¹æƒå€¼å‡ä¸ºéè´Ÿå€¼**

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef pair<int, int> PII;
const int N = 1e6 + 10;
int n, m;
int h[N], w[N], e[N], ne[N], idx;
// h[i] æ˜¯ä»¥ç»“ç‚¹ i ä¸ºèµ·ç‚¹çš„ç¬¬ä¸€æ¡è¾¹çš„ç¼–å·ï¼Œåˆå§‹åŒ–å…¨ä¸º -1 
// w[i] æ˜¯ç¬¬ i æ¡è¾¹çš„æƒé‡ 
// e[i]æ˜¯ i è¿™æ¡è¾¹çš„ç»ˆç‚¹çš„ç»“ç‚¹ç¼–å·
// ne[i] æ˜¯ä¸ i è¿™æ¡è¾¹åŒèµ·ç‚¹çš„ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·
// idx æ˜¯å½“å‰è¾¹çš„ç´¢å¼•ï¼ˆåºå·ï¼‰ 
int dist[N]; // distance çš„ç¼©å†™ï¼Œä»£è¡¨æ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·å§‹ç‚¹ï¼ˆè¿™é‡Œæ˜¯èŠ‚ç‚¹ 1 ï¼‰çš„è·ç¦»
bool st[N]; // state çš„ç¼©å†™ï¼Œå½“st[i]ä¸º true æ—¶ï¼Œè¯´æ˜èŠ‚ç‚¹ i åˆ°èµ·å§‹ç‚¹çš„æœ€çŸ­è·ç¦»å·²ç»ç¡®å®šäº†
void add(int a, int b, int c) // åˆ›å»ºé‚»æ¥è¡¨ï¼ˆä½¿ç”¨æ¨¡æ‹Ÿå•é“¾è¡¨ï¼‰ 
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++;
}
int dijkstra()
{
    memset(dist, 0x3f, sizeof(dist)); // åˆå§‹åŒ–æ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·å§‹ç‚¹çš„è·ç¦»éƒ½ä¸º +âˆ
    dist[1] = 0; // èµ·å§‹ç‚¹åˆ°è‡ªå·±çš„è·ç¦»ä¸º 0
    priority_queue<PII, vector<PII>, greater<PII>> heap; // åˆ›å»ºä¸€ä¸ªå°æ ¹å †ï¼ˆä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼‰ 
    heap.push({0, 1}); // æ”¾å…¥â‘ è·ç¦»â‘¡èŠ‚ç‚¹ç¼–å·
    while (heap.size()) // heapé‡Œé¢å…ƒç´ ä¸ºç©ºæ—¶ç»“æŸå¾ªç¯ 
    {
    	// å–å‡ºå †é‡Œé¢æœ€å°è·ç¦»çš„ç‚¹ï¼Œç„¶åé‡Šæ”¾æ‰
        auto t = heap.top();
        heap.pop();
        // ver æ˜¯æœªç¡®å®šæœ€çŸ­è·¯å¾„çš„*ç‚¹é›†*ä¸­çš„è·ç¦»æœ€å°ç‚¹  
        int ver = t.second, distance = t.first;
        if (st[ver]) continue;
        st[ver] = true;
        // æ ¹æ®èŠ‚ç‚¹ ver è¿›è¡Œæ‹“å±•
        for (int i = h[ver]; i != -1; i = ne[i])
        {
            int j = e[i];
            if (dist[j] > dist[ver] + w[i])
            {
                dist[j] = dist[ver] + w[i]; // æ›´æ–°æœ€çŸ­è·ç¦»
                heap.push({dist[j], j});
            }
        }
    }
    if (dist[n] == 0x3f3f3f3f) return -1; // å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œè¿”å› -1
    return dist[n];
}
int main()
{
    cin >> n >> m;
    memset(h, -1, sizeof(h)); // h æ•°ç»„åˆå§‹åŒ–æ“ä½œï¼Œå…¨éƒ¨èµ‹å€¼ä¸º -1 
    while (m --)
    {
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }
    cout << dijkstra() << endl; // å‘é‚»æ¥è¡¨ä¸­æ·»åŠ æ–°çš„è¾¹ 
    return 0;
}
```

## 4. Bellman-Ford

### 4.1 æœ‰è¾¹æ•°é™åˆ¶çš„æœ€çŸ­è·¯

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œ **è¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°**ã€‚

è¯·ä½ æ±‚å‡ºä» $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€å¤šç»è¿‡ $k$ æ¡è¾¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœæ— æ³•ä» $1$ å·ç‚¹èµ°åˆ° $n$ å·ç‚¹ï¼Œè¾“å‡º `impossible`ã€‚

æ³¨æ„ï¼šå›¾ä¸­å¯èƒ½ **å­˜åœ¨è´Ÿæƒå›è·¯** ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $n,m,k$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $x,y,z$ï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ $x$ åˆ°ç‚¹ $y$ çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º $z$ã€‚

ç‚¹çš„ç¼–å·ä¸º $1âˆ¼n$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä» $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€å¤šç»è¿‡ $k$ æ¡è¾¹çš„æœ€çŸ­è·ç¦»ã€‚

å¦‚æœä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„è·¯å¾„ï¼Œåˆ™è¾“å‡º `impossible`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,kâ‰¤500$,
$1â‰¤mâ‰¤10000$,
$1â‰¤x,yâ‰¤n$ï¼Œ
ä»»æ„è¾¹é•¿çš„ç»å¯¹å€¼ä¸è¶…è¿‡ $10000$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 3 1
1 2 1
2 3 1
1 3 3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
```

> **è§£æ**

å› ä¸ºè¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ $Dijkstra$ ã€‚è€Œ $bellman-ford$ å…è®¸å­˜åœ¨è´Ÿç¯ã€è´Ÿæƒè¾¹

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 510, M = 10010;
struct Edge
{
    int a, b, c;
}edges[M];
int n, m, k;
int dist[N]; // distance çš„ç¼©å†™ï¼Œä»£è¡¨æ¯ä¸ªèŠ‚ç‚¹åˆ°èµ·å§‹ç‚¹ï¼ˆè¿™é‡Œæ˜¯èŠ‚ç‚¹ 1 ï¼‰çš„è·ç¦»
int last[N]; // å¤‡ä»½æ•°ç»„ï¼Œé˜²æ­¢ä¸²è”å¯¼è‡´ä¸€æ¬¡æ€§èµ°å¥½å‡ æ­¥
void bellman_ford()
{
    memset(dist, 0x3f, sizeof(dist));
    dist[1] = 0;
    for (int i = 0; i < k; i ++) // k æ¬¡å¾ªç¯ï¼Œåªå…è®¸æœ€å¤šèµ° k æ­¥
    {
        memcpy(last, dist, sizeof(dist)); // å¤‡ä»½ä»¥é˜²æ­¢ä¸²è”
        for (int j = 0; j < m; j ++) // æ¯ä¸€æ­¥ä¸­ï¼Œéå†æ‰€æœ‰è¾¹ã€‚ç±»ä¼¼äºå¹¿åº¦ä¼˜å…ˆæœç´¢
        {
            auto e = edges[j];
            dist[e.b] = min(dist[e.b], last[e.a] + e.c); // æ›´æ–°æœ€çŸ­è·ç¦»
        }
    }
}
int main()
{
    cin >> n >> m >> k;
    for (int i = 0; i < m; i ++)
    {
        int a, b, c;
        cin >> a >> b >> c;
        edges[i] = {a, b, c};
    }
    bellman_ford();
    if (dist[n] > 0x3f3f3f3f / 2) cout << "impossible" << endl; // è€ƒè™‘åˆ°è¾¹æƒ e.c å¯èƒ½å°äº 0 ï¼Œæ›´æ–°æœ€çŸ­è·ç¦»æ—¶æŠŠ +âˆ æ›´æ–°æˆäº† (+âˆ - x)ï¼Œå¯¼è‡´ç»“æœè™½ç„¶è¿˜æ˜¯æ­£æ— ç©·ï¼Œä½†ç•¥å°äº 0x3f3f3f3f
    else cout << dist[n] << endl;
    return 0;
}
```

## 5. spfa

### 5.1 spfaæ±‚æœ€çŸ­è·¯

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œ **è¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°**ã€‚

è¯·ä½ æ±‚å‡º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œå¦‚æœæ— æ³•ä» $1$ å·ç‚¹èµ°åˆ° $n$ å·ç‚¹ï¼Œåˆ™è¾“å‡º `impossible`ã€‚

æ•°æ®ä¿è¯ä¸å­˜åœ¨è´Ÿæƒå›è·¯ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $x,y,z$ï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ $x$ åˆ°ç‚¹ $y$ çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º $z$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º $1$ å·ç‚¹åˆ° $n$ å·ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚

å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º `impossible`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤10^5$,
å›¾ä¸­æ¶‰åŠè¾¹é•¿ç»å¯¹å€¼å‡ä¸è¶…è¿‡ $10000$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 3
1 2 5
2 3 -3
1 3 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

**ç®—æ³•æ€æƒ³**ï¼šç›¸æ¯”äº $Bellman-ford$ ç®—æ³•éå†æ‰€æœ‰è¾¹ï¼Œ**$spfa$ ç®—æ³•åªéœ€è¦éå†é‚£äº›åˆ°æºç‚¹è·ç¦»å˜å°çš„ç‚¹æ‰€è¿æ¥çš„è¾¹å³å¯**ã€‚å› ä¸ºä¸éœ€è¦å¯¹è·ç¦»è¿›è¡Œæ’åºï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ª**é˜Ÿåˆ—**å­˜å‚¨éå†åˆ°çš„ç»“ç‚¹å³å¯

**$st$ æ•°ç»„çš„ä½œç”¨**ï¼šåˆ¤æ–­å½“å‰çš„ç‚¹æ˜¯å¦å·²ç»åŠ å…¥åˆ°é˜Ÿåˆ—å½“ä¸­ï¼Œå·²ç»åŠ å…¥é˜Ÿåˆ—çš„ç»“ç‚¹å°±ä¸éœ€è¦åå¤çš„æŠŠè¯¥ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­äº†ï¼Œå°±ç®—æ­¤æ¬¡è¿˜æ˜¯ä¼šæ›´æ–°åˆ°æºç‚¹çš„è·ç¦»ï¼Œé‚£åªç”¨æ›´æ–°ä¸€ä¸‹æ•°å€¼è€Œä¸ç”¨åŠ å…¥åˆ°é˜Ÿåˆ—å½“ä¸­ï¼ˆå³ä½¿ä¸ä½¿ç”¨ $st$ æ•°ç»„ç»“æœä¹Ÿä¸ä¼šé”™ï¼Œä½†æ˜¯ä½¿ç”¨çš„å¥½å¤„åœ¨äºå¯ä»¥æå‡æ•ˆç‡ï¼‰

**æ€»ç»“**ï¼š

- $Dijkstra$ æ˜¯ç”¨è·ç¦»æœ€çŸ­çš„ç»“ç‚¹å»æ›´æ–°å…¶ä»–è¾¹ï¼ˆé€‚ç”¨äºéè´Ÿæƒè¾¹çš„å›¾ï¼‰
- $spfa$ æ˜¯ç”¨ä¸Šæ¬¡æ›´æ–°çš„ç»ˆç‚¹å»æ›´æ–°å…¶ä»–è¾¹ï¼ˆé€‚ç”¨äºæœ‰è´Ÿæƒè¾¹ä½†æ²¡æœ‰è´Ÿæƒç¯çš„å›¾ï¼‰
- $Bellman-Ford$ åˆ™æ˜¯æš´åŠ›åœ°æ¯æ¬¡æ›´æ–°æ‰€æœ‰è¾¹

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n, m;
int h[N], w[N], e[N], ne[N], idx;
int dist[N];
bool st[N];
void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}
int spfa()
{
    memset(dist, 0x3f, sizeof(dist));
    dist[1] = 0;
    queue<int> q;
    q.push(1);
    st[1] = true; // true ä»£è¡¨åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ— éœ€å†æ¬¡å…¥é˜Ÿï¼›false ä»£è¡¨ä¸åœ¨é˜Ÿåˆ—ä¸­
    while (q.size())
    {
        int t = q.front();
        q.pop();
        st[t] = false;
        for (int i = h[t]; i != -1; i = ne[i])
        {
            int j = e[i];
            if (dist[j] > dist[t] + w[i])
            {
                dist[j] = dist[t] + w[i];
                if (!st[j]) // è‹¥ j ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåˆ™éœ€è¦å…¥é˜Ÿï¼Œä»¥æ›´æ–° j çš„åç»§ç»“ç‚¹
                {
                    q.push(j);
                    st[j] = true;
                }
            }
        }
    }
    return dist[n];
}
int main()
{
    cin >> n >> m;
    memset(h, -1, sizeof(h));
    while (m --)
    {
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }
    int t = spfa();
    if (t == 0x3f3f3f3f) cout << "impossible" << endl;
    else cout << t << endl;
    return 0;
}
```

### 5.2 spfaåˆ¤æ–­è´Ÿç¯

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œ **è¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°**ã€‚

è¯·ä½ åˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨è´Ÿæƒå›è·¯ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $x,y,z$ï¼Œè¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä»ç‚¹ $x$ åˆ°ç‚¹ $y$ çš„æœ‰å‘è¾¹ï¼Œè¾¹é•¿ä¸º $z$ã€‚

**è¾“å‡ºæ ¼å¼**

å¦‚æœå›¾ä¸­**å­˜åœ¨**è´Ÿæƒå›è·¯ï¼Œåˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤2000$,
$1â‰¤mâ‰¤10000$,
å›¾ä¸­æ¶‰åŠè¾¹é•¿ç»å¯¹å€¼å‡ä¸è¶…è¿‡ $10000$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 3
1 2 -1
2 3 4
3 1 -4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
```

> **è§£æ**

åˆå§‹æ—¶å°†æ‰€æœ‰ç‚¹æ’å…¥é˜Ÿåˆ—çš„ç†è§£æ–¹æ³•ï¼š

- åœ¨åŸå›¾çš„åŸºç¡€ä¸ŠæŠ½è±¡å‡ºä¸€ä¸ª**è™šæ‹Ÿæºç‚¹**ï¼ˆèµ·å§‹ç‚¹ï¼‰ï¼Œä»è¯¥ç‚¹å‘å…¶ä»–æ‰€æœ‰ç‚¹è¿ä¸€æ¡æƒå€¼ä¸º $0$ çš„**æœ‰å‘è¾¹**ã€‚é‚£ä¹ˆ**åŸå›¾æœ‰è´Ÿç¯ç­‰ä»·äºæ–°å›¾æœ‰è´Ÿç¯**ã€‚æ­¤æ—¶åœ¨æ–°å›¾ä¸Šåš $spfa$ ï¼Œå°†è™šæ‹Ÿæºç‚¹åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶åè¿›è¡Œ $spfa$ çš„ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œè¿™æ—¶å°±ä¼šå°†æ‰€æœ‰ç‚¹çš„è·ç¦»æ›´æ–°å¹¶å°†æ‰€æœ‰ç‚¹æ’å…¥é˜Ÿåˆ—ä¸­

$cnt[i]$ è¡¨ç¤ºåˆ°è¾¾ç»“ç‚¹ $i$ åˆ°è™šæ‹Ÿæºç‚¹æœ€çŸ­è·¯èµ°è¿‡çš„è¾¹çš„æ•°é‡ 

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 2010, M = 10010;
int n, m;
int h[N], w[M], e[M], ne[M], idx;
int dist[N], cnt[N]; // cnt[i] è¡¨ç¤ºåˆ°è¾¾ç»“ç‚¹ i åˆ°è™šæ‹Ÿæºç‚¹æœ€çŸ­è·¯èµ°è¿‡çš„è¾¹çš„æ•°é‡ 
bool st[N];
void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}
bool spfa()
{
    queue<int> q;
    for (int i = 1; i <= n; i ++)
    {
        st[i] = true; // true ä»£è¡¨åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ— éœ€å†æ¬¡å…¥é˜Ÿï¼›false ä»£è¡¨ä¸åœ¨é˜Ÿåˆ—ä¸­
        q.push(i);
    }
    // è¿™é‡Œä¸éœ€è¦åˆå§‹åŒ– dist æ•°ç»„ä¸º +âˆ çš„åŸå› æ˜¯ï¼šå› ä¸ºæ‰€æœ‰ç‚¹éƒ½å·²ç»è¢« push è¿›é˜Ÿåˆ—ä¸­äº†ï¼Œå¦‚æœå­˜åœ¨è´Ÿç¯ï¼Œé‚£ä¹ˆ dist ä¸ç®¡åˆå§‹åŒ–ä¸ºå¤šå°‘ï¼Œéƒ½ä¼šè¢«æ›´æ–°
    while (q.size())
    {
        int t = q.front();
        q.pop();
        st[t] = false;
        for (int i = h[t]; i != -1; i = ne[i])
        {
            int j = e[i];
            if (dist[j] > dist[t] + w[i])
            {
                dist[j] = dist[t] + w[i];
                cnt[j] = cnt[t] + 1; // æœ€çŸ­è·¯çš„è¾¹çš„æ•°é‡åŠ  1
                if (cnt[j] >= n) return true;
                /*
                  æ„å‘³ç€ä» j åˆ° è™šæ‹Ÿæºç‚¹ä¹‹é—´ç»è¿‡äº† n æ¡è¾¹ï¼Œå³ n + 1 ä¸ªç‚¹
                  åˆå› ä¸ºå›¾ä¸­åªæœ‰ n ä¸ªç‚¹ï¼Œæ‰€ä»¥è¯æ˜å­˜åœ¨è´Ÿç¯
                */
                if (!st[j])
                {
                    q.push(j);
                    st[j] = true;
                }
            }
        }
    }
    return false;
}
int main()
{
    cin >> n >> m;
    memset(h, -1, sizeof(h));
    while (m --)
    {
        int a, b, c;
        cin >> a >> b >> c;
        add(a, b, c);
    }
    if (spfa()) cout << "Yes" << endl;
    else cout << "No" << endl;
    return 0;
}
```

## 6. Prim

### 6.1 Primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œè¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ã€‚

æ±‚æœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œï¼Œå¦‚æœæœ€å°ç”Ÿæˆæ ‘ä¸å­˜åœ¨åˆ™è¾“å‡º `impossible`ã€‚

ç»™å®šä¸€å¼ è¾¹å¸¦æƒçš„æ— å‘å›¾ $G=(V,E)$ï¼Œå…¶ä¸­ $V$ è¡¨ç¤ºå›¾ä¸­ç‚¹çš„é›†åˆï¼Œ$E$ è¡¨ç¤ºå›¾ä¸­è¾¹çš„é›†åˆï¼Œ$n=|V|$ï¼Œ$m=|E|$ã€‚

ç”± $V$ ä¸­çš„å…¨éƒ¨ $n$ ä¸ªé¡¶ç‚¹å’Œ $E$ ä¸­ $nâˆ’1$ æ¡è¾¹æ„æˆçš„æ— å‘è¿é€šå­å›¾è¢«ç§°ä¸º $G$ çš„ä¸€æ£µç”Ÿæˆæ ‘ï¼Œå…¶ä¸­è¾¹çš„æƒå€¼ä¹‹å’Œæœ€å°çš„ç”Ÿæˆæ ‘è¢«ç§°ä¸ºæ— å‘å›¾ $G$ çš„æœ€å°ç”Ÿæˆæ ‘ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $u,v,w$ï¼Œè¡¨ç¤ºç‚¹ $u$ å’Œç‚¹ $v$ ä¹‹é—´å­˜åœ¨ä¸€æ¡æƒå€¼ä¸º $w$ çš„è¾¹ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼Œè‹¥å­˜åœ¨æœ€å°ç”Ÿæˆæ ‘ï¼Œåˆ™è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œï¼Œå¦‚æœæœ€å°ç”Ÿæˆæ ‘ä¸å­˜åœ¨åˆ™è¾“å‡º `impossible`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤500,$
$1â‰¤mâ‰¤10^5,$
$å›¾ä¸­æ¶‰åŠè¾¹çš„è¾¹æƒçš„ç»å¯¹å€¼å‡ä¸è¶…è¿‡ 10000ã€‚$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4 5
1 2 1
1 3 2
1 4 3
2 3 2
3 4 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
6
```

> **è§£æ**

$Prim$ ç®—æ³•é‡‡ç”¨çš„æ˜¯ä¸€ç§**è´ªå¿ƒ**çš„ç­–ç•¥ã€‚

æ¯æ¬¡å°†**ç¦»è¿é€šéƒ¨åˆ†çš„æœ€è¿‘çš„ç‚¹**å’Œ**ç‚¹å¯¹åº”çš„è¾¹**åŠ å…¥åˆ°è¿é€šéƒ¨åˆ†ï¼Œè¿é€šéƒ¨åˆ†é€æ¸æ‰©å¤§ï¼Œæœ€åå°†æ•´ä¸ªå›¾è¿é€šèµ·æ¥ï¼Œå¹¶ä¸”è¾¹é•¿ä¹‹å’Œæœ€å°ã€‚

![image-prim](/figs/prim)

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 510, INF = 0x3f3f3f3f;
int n, m; // n ä¸ªèŠ‚ç‚¹ï¼Œm æ¡è¾¹
int g[N][N]; // g[i][j] æ˜¯æŒ‡ä» i èŠ‚ç‚¹åˆ° j èŠ‚ç‚¹çš„è·ç¦»ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸å­˜åœ¨ï¼ˆå³ +âˆï¼Œè¿™é‡Œç”¨ 0x3f3f3f3f è¡¨ç¤ºï¼‰ 
int dist[N]; // distance çš„ç¼©å†™ï¼Œä»£è¡¨æ¯ä¸ªèŠ‚ç‚¹åˆ°ç”Ÿæˆæ ‘çš„è·ç¦»
bool st[N]; // state çš„ç¼©å†™ï¼Œå½“st[i]ä¸º true æ—¶ï¼Œè¯´æ˜èŠ‚ç‚¹ i å·²ç»åŠ å…¥åˆ°ç”Ÿæˆæ ‘ä¸­äº† 
int prim()
{
    memset(dist, 0x3f, sizeof(dist)); // åˆå§‹åŒ–æ¯ä¸ªèŠ‚ç‚¹åˆ°ç”Ÿæˆæ ‘çš„è·ç¦»éƒ½ä¸º +âˆ
    int res = 0; // æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡ä¹‹å’Œ 
    for (int i = 0; i < n; i ++) // å¾ªç¯ n - 1 æ¬¡ï¼ˆåŠ å…¥ n - 1 ä¸ªç‚¹è¿›ç”Ÿæˆæ ‘ï¼‰ï¼Œi æ— æ„ä¹‰ 
    {
    	// å¯»æ‰¾æœªåŠ å…¥ç”Ÿæˆæ ‘çš„*ç‚¹é›†*ä¸­çš„è·ç¦»æœ€å°ç‚¹ dist[t]
        int t = -1; // t è¡¨ç¤ºæœªåŠ å…¥ç”Ÿæˆæ ‘çš„*ç‚¹é›†*ä¸­çš„è·ç¦»æœ€å°ç‚¹çš„*åºå·*
        for (int j = 1; j <= n; j ++)
            if (!st[j] && (t == -1 || dist[t] > dist[j]))
                t = j;
        if (i && dist[t] == INF) return INF; // å­˜åœ¨å­¤ç«‹ç‚¹å¯¼è‡´ä¸å­˜åœ¨ç”Ÿæˆæ ‘ 
        if (i) res += dist[t];
        st[t] = true; // èŠ‚ç‚¹ t å·²åŠ å…¥ç”Ÿæˆæ ‘ 
        for (int j = 1; j <= n; j ++) dist[j] = min(dist[j], g[t][j]); // æ›´æ–°æ¯ä¸ªèŠ‚ç‚¹åˆ°ç”Ÿæˆæ ‘çš„æœ€å°è·ç¦» 
    }
    return res;
}
int main()
{
    cin >> n >> m;
    memset(g, 0x3f, sizeof(g));
    while (m --)
    {
        int a, b, c;
        cin >> a >> b >> c;
        g[a][b] = g[b][a] = min(g[a][b], c); // æ— å‘å›¾ 
    }
    int t = prim();
    if (t == INF) cout << "impossible" << endl;
    else cout << t << endl;
    return 0;
}
```

## 7. Kruskal

### 7.1 Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œå›¾ä¸­å¯èƒ½å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ï¼Œè¾¹æƒå¯èƒ½ä¸ºè´Ÿæ•°ã€‚

æ±‚æœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œï¼Œå¦‚æœæœ€å°ç”Ÿæˆæ ‘ä¸å­˜åœ¨åˆ™è¾“å‡º `impossible`ã€‚

ç»™å®šä¸€å¼ è¾¹å¸¦æƒçš„æ— å‘å›¾ $G=(V,E)$ï¼Œå…¶ä¸­ $V$ è¡¨ç¤ºå›¾ä¸­ç‚¹çš„é›†åˆï¼Œ$E$ è¡¨ç¤ºå›¾ä¸­è¾¹çš„é›†åˆï¼Œ$n=|V|$ï¼Œ$m=|E|$ã€‚

ç”± $V$ ä¸­çš„å…¨éƒ¨ $n$ ä¸ªé¡¶ç‚¹å’Œ $E$ ä¸­ $nâˆ’1$ æ¡è¾¹æ„æˆçš„æ— å‘è¿é€šå­å›¾è¢«ç§°ä¸º $G$ çš„ä¸€æ£µç”Ÿæˆæ ‘ï¼Œå…¶ä¸­è¾¹çš„æƒå€¼ä¹‹å’Œæœ€å°çš„ç”Ÿæˆæ ‘è¢«ç§°ä¸ºæ— å‘å›¾ $G$ çš„æœ€å°ç”Ÿæˆæ ‘ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $m$ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $u,v,w$ï¼Œè¡¨ç¤ºç‚¹ $u$ å’Œç‚¹ $v$ ä¹‹é—´å­˜åœ¨ä¸€æ¡æƒå€¼ä¸º $w$ çš„è¾¹ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼Œè‹¥å­˜åœ¨æœ€å°ç”Ÿæˆæ ‘ï¼Œåˆ™è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°ç”Ÿæˆæ ‘çš„æ ‘è¾¹æƒé‡ä¹‹å’Œï¼Œå¦‚æœæœ€å°ç”Ÿæˆæ ‘ä¸å­˜åœ¨åˆ™è¾“å‡º `impossible`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10^5,$
$1â‰¤mâ‰¤2Ã—10^5,$
$å›¾ä¸­æ¶‰åŠè¾¹çš„è¾¹æƒçš„ç»å¯¹å€¼å‡ä¸è¶…è¿‡ 1000ã€‚$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4 5
1 2 1
1 3 2
1 4 3
2 3 2
3 4 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
6
```

> **è§£æ**

$Kruskal$ ç®—æ³•é‡‡ç”¨çš„ä¹Ÿæ˜¯ä¸€ç§**è´ªå¿ƒ**çš„ç­–ç•¥ã€‚

- å°†æ‰€æœ‰è¾¹æŒ‰æƒé‡**ä»å°åˆ°å¤§**æ’åº
- æšä¸¾æ¯æ¡è¾¹ $a-b$ ï¼Œæƒé‡ä¸º $c$ ï¼Œ**å¦‚æœ $a,b$ ä¸è¿é€š**ï¼Œé‚£ä¹ˆå°±å°†è¿™æ¡è¾¹åŠ å…¥é›†åˆä¸­

<img src="/figs/kruskal" alt="kruskal" style="zoom: 67%;" />

å®ç°æ–¹å¼ä¸º**å¹¶æŸ¥é›†**çš„åº”ç”¨ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010, M = 200010, INF = 0x3f3f3f3f;
int n, m;
int p[N]; // p[x] è¡¨ç¤º x çš„çˆ¶èŠ‚ç‚¹ï¼ˆå¹¶æŸ¥é›†ï¼‰ 
struct Edge
{
    int a, b, w;
}edges[M]; // ç”¨ä¸€ä¸ªç»“æ„ä½“å­˜æ‰€æœ‰è¾¹ 
bool cmp(Edge x, Edge y)
{
	return x.w < y.w;
}
int find(int x) // è¿”å› x çš„ç¥–å®—èŠ‚ç‚¹çš„ç¼–å·ï¼ˆå¹¶æŸ¥é›†ï¼‰ 
{
    if (p[x] != x) p[x] = find(p[x]);
    return p[x];
}
int kruskal()
{
    sort(edges, edges + m, cmp); // è¾¹æƒé‡ä»å°åˆ°å¤§æ’åº 
    for (int i = 1; i <= n; i ++) p[i] = i; // åˆå§‹åŒ–å¹¶æŸ¥é›†
    int res = 0, cnt = 0; // res ä¸ºæœ€å°ç”Ÿæˆæ ‘è¾¹æƒé‡ä¹‹å’Œï¼› cnt ä¸ºæœ€å°ç”Ÿæˆæ ‘ä¸­è¾¹çš„æ•°é‡ 
    for (int i = 0; i < m; i ++) // ä¾æ¬¡éå†æ¯æ¡è¾¹ 
    {
        int a = edges[i].a, b = edges[i].b, w = edges[i].w;
        a = find(a), b = find(b);
        if (a != b) // a å’Œ b ä¸è¿é€šï¼Œè¾¹ a-b å¯ä»¥åŠ å…¥ç”Ÿæˆæ ‘ 
        {
            p[a] = b;
            res += w;
            cnt ++;
        }
    }
    if (cnt < n - 1) return INF; // å­˜åœ¨å­¤ç«‹ç‚¹ï¼Œå›¾ä¸æ˜¯è¿é€šå›¾ï¼Œä¹Ÿå°±ä¸å­˜åœ¨ç”Ÿæˆæ ‘
    return res; // è¿”å›è¾¹æƒé‡ä¹‹å’Œ 
}
int main()
{
    cin >> n >> m;
    for (int i = 0; i < m; i ++)
    {
        int a, b, w;
        cin >> a >> b >> w;
        edges[i] = {a, b, w};
    }
    int t = kruskal();
    if (t == INF) cout << "impossible" << endl; // å­˜åœ¨å­¤ç«‹ç‚¹ï¼Œå›¾ä¸æ˜¯è¿é€šå›¾
    else cout << t << endl;
    return 0;
}
```

# æ•°å­¦çŸ¥è¯†

## 1. è´¨æ•°

### 1.1 è¯•é™¤æ³•åˆ¤å®šè´¨æ•°

> **é¢˜ç›®**

ç»™å®š $n$ ä¸ªæ­£æ•´æ•° $a_i$ï¼Œåˆ¤å®šæ¯ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ­£æ•´æ•° $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

å…± $n$ è¡Œï¼Œå…¶ä¸­ç¬¬ $i$ è¡Œè¾“å‡ºç¬¬ $i$ ä¸ªæ­£æ•´æ•° $a_i$ æ˜¯å¦ä¸ºè´¨æ•°ï¼Œæ˜¯åˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100,$
$1â‰¤a_iâ‰¤2^{31}âˆ’1$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2
2
6
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
No
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
bool is_prime(int x)
{
    if (x < 2) return false;
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0)
            return false;
    return true;
}
int main()
{
    ll n;
    cin >> n;
    while (n --)
    {
        ll x;
        cin >> x;
        if (is_prime(x)) cout<<"Yes"<<endl;
        else cout<<"No"<<endl;
    }
    return 0;
}
```

### 1.2 ç­›è´¨æ•°

> **é¢˜ç›®**

**é¢˜ç›®è¦æ±‚**

ç»™å®šä¸€ä¸ªæ­£æ•´æ•° $n$ï¼Œè¯·ä½ æ±‚å‡º $1âˆ¼n$ ä¸­è´¨æ•°çš„ä¸ªæ•°ã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«æ•´æ•° $n$ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º $1âˆ¼n$ ä¸­è´¨æ•°çš„ä¸ªæ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤1Ã—10^6$

**è¾“å…¥æ ·ä¾‹**

```
8
```

**è¾“å‡ºæ ·ä¾‹**

```
4
```

> **ä»£ç æ¨¡æ¿**

```c++
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1e6 + 5;
ll prime[N];
bool st[N]; // åˆšå¼€å§‹é»˜è®¤éƒ½æ˜¯è´¨æ•°ï¼Œåé¢ä¾æ¬¡æ’é™¤
ll cnt = 1;
void get_prime(ll n)
{
    for(int i = 2; i <= n; i ++)
    {
        if(st[i])
        {
            continue;
        }
        prime[cnt] = i;
        cnt ++;
        for(int j = 2 * i; j <= n; j += i)
        {
            st[j] = true;
        }
    }
}
int main()
{
    ll n;
    cin >> n;
    get_prime(n);
    cout << cnt - 1 << endl;
    return 0;
}
```

## 2. çº¦æ•°

### 2.1 è¯•é™¤æ³•æ±‚çº¦æ•°

> **é¢˜ç›®**

ç»™å®š $n$ ä¸ªæ­£æ•´æ•° $ a_i $ï¼Œå¯¹äºæ¯ä¸ªæ•´æ•° $a_i$ï¼Œè¯·ä½ æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºè¾“å‡ºå®ƒçš„æ‰€æœ‰çº¦æ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…± $n$ è¡Œï¼Œå…¶ä¸­ç¬¬ $i$ è¡Œè¾“å‡ºç¬¬ $i$ ä¸ªæ•´æ•° $a_i$ çš„æ‰€æœ‰çº¦æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100,$
$1â‰¤a_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2
6
8
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1 2 3 6 
1 2 4 8 
```

> **ä»£ç æ¨¡æ¿**

```C++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
vector<int> get_divisors(int x)
{
    vector<int> res;
    for (int i = 1; i <= x / i; i ++ )
        if (x % i == 0)
        {
            res.push_back(i);
            if (i != x / i) //é¿å…sqrt(x)è¢«pushä¸¤æ¬¡è¿›æ•°ç»„
            {
                res.push_back(x / i);
            }
        }
    sort(res.begin(), res.end());
    return res;
}

int main()
{
    ll n;
    cin >> n;
    while (n -- )
    {
        int x;
        cin >> x;
        auto res = get_divisors(x);
        for (auto i : res) cout << i << ' ';
        cout << endl;
    }
    return 0;
}
```

### 2.2 çº¦æ•°ä¸ªæ•°

> **é¢˜ç›®**

ç»™å®š $n$ ä¸ªæ­£æ•´æ•° $a_i$ï¼Œè¯·ä½ è¾“å‡ºè¿™äº›æ•°çš„ä¹˜ç§¯çš„çº¦æ•°ä¸ªæ•°ï¼Œç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€ç»™æ­£æ•´æ•°çš„ä¹˜ç§¯çš„çº¦æ•°ä¸ªæ•°ï¼Œç­”æ¡ˆéœ€å¯¹ $10^9+7$ å–æ¨¡ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100,$
$1â‰¤a_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
2
6
8
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
12
```

> **è§£æ**

å¯¹äºä»»æ„ä¸€ä¸ªæ•´æ•° $N$ï¼Œå°† $N$ åˆ†è§£è´¨å› æ•°ï¼Œéƒ½å¯ä»¥å¾—åˆ° $N={p_1}^{Î±_1}Ã—{p_2}^{Î±_2}Ã—â€¦â€¦Ã—{p_k}^{Î±_k}$ï¼Œå…¶ä¸­ï¼Œ$p_kï¼1$ ä¸” $p_k$ä¸ºè´¨æ•°ã€‚

é‚£ä¹ˆï¼Œå¯¹äºè¿™ä¸ªæ•´æ•° $N$ï¼Œå®ƒçš„**çº¦æ•°ä¸ªæ•°**å°±ä¸º $(Î±_1+1)(Î±_2+1)â€¦â€¦(Î±_k+1)$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 110, mod = 1e9 + 7;
int main()
{
    int n;
    cin >> n;
    unordered_map<int, int> primes; // map å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½æ˜¯å”¯ä¸€çš„ã€‚ä¸ std::map ä¸åŒï¼Œunordered_map ä¸ä¿è¯å…ƒç´ çš„æ’åºï¼Œä½†é€šå¸¸æä¾›æ›´å¿«çš„æŸ¥æ‰¾é€Ÿåº¦
    while (n --)
    {
        int x;
        cin >> x;
        for (int i = 2; i <= x / i; i ++ )
            while (x % i == 0)
            {
                x /= i;
                primes[i] ++ ;
            }
        if (x > 1) primes[x] ++ ; // å¦‚æœæ²¡é™¤å¹²å‡€ï¼Œé‚£ä¹ˆxæœ¬èº«å°±æ˜¯è´¨æ•° 
    }
    ll res = 1;
    for (auto p : primes) res = res * (p.second + 1) % mod;
    cout << res << endl;
    return 0;
}
```

### 2.3 çº¦æ•°ä¹‹å’Œ

> **é¢˜ç›®**

ç»™å®š $n$ ä¸ªæ­£æ•´æ•° $a_i$ï¼Œè¯·ä½ è¾“å‡ºè¿™äº›æ•°çš„ä¹˜ç§¯çš„çº¦æ•°ä¹‹å’Œï¼Œç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€ç»™æ­£æ•´æ•°çš„ä¹˜ç§¯çš„çº¦æ•°ä¹‹å’Œï¼Œç­”æ¡ˆéœ€å¯¹ $10^9+7$ å–æ¨¡ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100,$
$1â‰¤a_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
2
6
8
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
252
```

> **è§£æ**

å¯¹äºä»»æ„ä¸€ä¸ªæ•´æ•° $N$ï¼Œå°† $N$ åˆ†è§£è´¨å› æ•°ï¼Œéƒ½å¯ä»¥å¾—åˆ° $N={p_1}^{Î±_1}Ã—{p_2}^{Î±_2}Ã—â€¦â€¦Ã—{p_k}^{Î±_k}$ï¼Œå…¶ä¸­ï¼Œ$p_kï¼1$ ä¸” $p_k$ä¸ºè´¨æ•°ã€‚

é‚£ä¹ˆï¼Œå¯¹äºè¿™ä¸ªæ•´æ•° $N$ï¼Œå®ƒçš„**çº¦æ•°ä¹‹å’Œ**å°±ä¸º $({p_1}^{0}+{p_1}^{1}+â€¦â€¦+{p_1}^{Î±_1})â€¦â€¦({p_k}^{0}+{p_k}^{1}+â€¦â€¦+{p_k}^{Î±_k})$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 110, mod = 1e9 + 7;
int main()
{
    int n;
    cin >> n;
    unordered_map<int, int> primes;
    while (n -- )
    {
        int x;
        cin >> x;
        for (int i = 2; i <= x / i; i ++ )
            while (x % i == 0)
            {
                x /= i;
                primes[i] ++ ;
            }
        if (x > 1) primes[x] ++ ;
    }
    ll res = 1;
    for (auto p : primes)
    {
        ll a = p.first, b = p.second;
        ll cnt = 1;
        while (b -- ) cnt = (cnt * a + 1) % mod; // ç¬¬ä¸€æ¬¡æ˜¯1ï¼Œç¬¬äºŒæ¬¡æ˜¯p1+1ï¼Œç¬¬ä¸‰æ¬¡æ˜¯p1^2+p1+1â€¦â€¦ç¬¬kæ¬¡å°±æ˜¯ç´¯åŠ çš„å’Œäº†ï¼ˆç­‰æ¯”æ•°åˆ—powä¼šçˆ†ï¼Œä¸èƒ½ç”¨ï¼‰
        res = res * cnt % mod;
    }
    cout << res << endl;
    return 0;
}
```

### 2.4 æœ€å¤§å…¬çº¦æ•°

> **é¢˜ç›®**

ç»™å®š $n$ å¯¹æ­£æ•´æ•° $ai,bi$ï¼Œè¯·ä½ æ±‚å‡ºæ¯å¯¹æ•°çš„æœ€å¤§å…¬çº¦æ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•°å¯¹ $a_i,b_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…± $n$ è¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°å¯¹çš„æœ€å¤§å…¬çº¦æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10^5,$
$1â‰¤a_i,b_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2
3 6
4 6
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
2
```

> **è§£æ**

æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä¹Ÿå«è¾—è½¬ç›¸é™¤æ³•ï¼Œ

åŸºæœ¬æ€§è´¨ï¼š ç”± $d|a,d|b$  ï¼Œå¯å¾—  $\Rightarrow d|(a+b)$  ï¼Œå¯å¾—  $\Rightarrow d|(aÂ·x+bÂ·y)$

æ ¸å¿ƒåŸç†ï¼šå®šä¹‰ $(a,b)$ ä¸º $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ã€‚åˆ™æœ€å¤§å…¬çº¦æ•° $(a,b) = (b,a\%b)$

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
int gcd(int a, int b)
{
    return b ? gcd(b, a % b) : a;
}
int main()
{
    ll n;
    cin >> n;
    while (n --)
    {
        int a, b;
        scanf("%d%d", &a, &b);
        printf("%d\n", gcd(a, b));
    }
    return 0;
}
```

## 3. å¿«é€Ÿå¹‚

### 3.1 å¿«é€Ÿå¹‚

> **é¢˜ç›®**

ç»™å®š $n$ ç»„ $a_i,b_i,p_i$ï¼Œå¯¹äºæ¯ç»„æ•°æ®ï¼Œæ±‚å‡º $a_i^{b_i}\,mod\,pi$ çš„å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° $a_i,b_i,p_i$ã€‚

**è¾“å‡ºæ ¼å¼**

å¯¹äºæ¯ç»„æ•°æ®ï¼Œè¾“å‡ºä¸€ä¸ªç»“æœï¼Œè¡¨ç¤º $a_i^{b_i}\,mod\,pi$ çš„å€¼ã€‚

æ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100000$

$1â‰¤a_i,b_i,p_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹**

```
2
3 2 5
4 3 9
```

**è¾“å‡ºæ ·ä¾‹**

```
4
1
```

> **è§£æ**

é¢„å¤„ç†å‡º $a^{2^0}, a^{2^1}, a^{2^2}, \ldots, a^{2^{\log b}}$ è¿™ $b$ ä¸ªæ•°ã€‚

å°† $a^b$ ç”¨ $a^{2^0}, a^{2^1}, a^{2^2}, \ldots, a^{2^{\log b}}$ è¿™ $b$ ç§æ•°æ¥ç»„åˆï¼Œå³ç»„åˆæˆ $a^b = a^{2^{x_1}} \times a^{2^{x_2}} \times \ldots \times a^{2^{x_t}} = a^{2^{x_1} + 2^{x_2} + \ldots + 2^{x_t}}$ ï¼Œå³ç”¨äºŒè¿›åˆ¶è¡¨ç¤º

> **ä»£ç æ¨¡æ¿**

```c++
#include <bits/stdc++.h> 
using namespace std;
typedef long long ll;
const ll N = 1e5 + 5;
ll qmi(ll a, ll k, ll p)
{
    ll res = 1;// res ä¸ºæ¯ä¸€æ­¥å¾—åˆ°çš„ç»“æœã€‚å› ä¸ºæ˜¯ç›¸ä¹˜çš„ï¼Œæ‰€ä»¥åˆå§‹ä¸º1 
    while(k)
    {
        if(k & 1) // äºŒè¿›åˆ¶ä½æœ‰æ—  1
		{
			res = (res * a) % p;// a å°±æ˜¯ a ^ (2 ^ k)ã€‚å¦‚ç¬¬ 3 ä½æœ‰ 1 ï¼Œåˆ™ res Ã— a ^ (2 ^ 3)
		}
        a = (a * a) % p;// æ¯æ¬¡å¹³æ–¹ï¼ˆa ^ (2 ^ 0)ï¼Œa ^ (2 ^ 1)ï¼Œa ^ (2 ^ 2)ï¼Œa ^ (2 ^ 3)â€¦â€¦ï¼‰
        k >>= 1;
    }
    return res;
}
int main()
{
    int n;
    cin >> n;
    while(n --)
    {
        int a, k, p;
        cin >> a >> k >> p;
        cout << qmi(a, k, p) << endl;
    }
    return 0;
}
```

## 4. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

### 4.1 æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

> **é¢˜ç›®**

ç»™å®š $n$ å¯¹æ­£æ•´æ•° ai,biï¼Œå¯¹äºæ¯å¯¹æ•°ï¼Œæ±‚å‡ºä¸€ç»„ $x_i,y_i$ï¼Œä½¿å…¶æ»¡è¶³ $a_iÃ—x_i+b_iÃ—y_i=gcd(ai,bi)$ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $a_i,b_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…± $n$ è¡Œï¼Œå¯¹äºæ¯ç»„ $a_i,b_i$ï¼Œæ±‚å‡ºä¸€ç»„æ»¡è¶³æ¡ä»¶çš„ $x_i,y_i$ï¼Œæ¯ç»„ç»“æœå ä¸€è¡Œã€‚

æœ¬é¢˜ç­”æ¡ˆä¸å”¯ä¸€ï¼Œè¾“å‡ºä»»æ„æ»¡è¶³æ¡ä»¶çš„ $x_i,y_i$ å‡å¯ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10^5,$
$1â‰¤a_i,b_iâ‰¤2Ã—10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2
4 6
8 18
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
-1 1
-2 1
```

> **è§£æ**

è£´èœ€å®šç†ï¼š

å¯¹äºä»»æ„æ­£æ•´æ•° $a,b$ ï¼Œä¸€å®šå­˜åœ¨éé›¶æ•´æ•° $x,y$ ï¼Œä½¿å¾— $ax+by=(a,b)$ ã€‚

ä¸‹é¢è¿›è¡Œè§£é¢˜ï¼š

å¼•ç†ï¼šå®šä¹‰ $(a,b)$ ä¸º $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ã€‚åˆ™æœ€å¤§å…¬çº¦æ•° $(a,b) = (b,a\%b)$

å› ä¸º $ax+by=(a,b)$ï¼Œ

æ‰€ä»¥ $by+(a\%b)x=(b,a\%b)$

æ‰€ä»¥ $by+(a- \lfloor \frac{a}{b} \rfloor b)x=(b,a\%b)$

æ•´ç†å¾— $ax+b(y- \lfloor \frac{a}{b} \rfloor x)=(b,a\%b)$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
typedef long long ll; 
int gcd(int a, int b) // æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä¸ä¸‹é¢å½¢æˆå¯¹ç…§ 
{
	if(!b)
	{
		return a;
	}
    return gcd(b, a % b);
}
int exgcd(int a, int b, int &x, int &y) // æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œè¿”å›å€¼ä»ä¸ºæœ€å¤§å…¬çº¦æ•° 
{
    if(!b)
    {
        x = 1, y = 0;
        return a;
    }
    int d = exgcd(b, a % b, y, x); // xå’Œyéœ€è¦ç¿»è½¬ä¸€ä¸‹ï¼Œå› ä¸º(a,b)å˜æˆ(b,a%b)äº† 
    y -= a / b * x;
    return d;
}

int main()
{
    ll n;
    scanf("%d", &n);
    while (n --)
    {
        int a, b;
        scanf("%d%d", &a, &b);
        int x, y;
        exgcd(a, b, x, y);
        printf("%d %d\n", x, y);
    }
    return 0;
}
```

## 5. é«˜æ–¯æ¶ˆå…ƒ

### 5.1 é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„

> **é¢˜ç›®**

è¾“å…¥ä¸€ä¸ªåŒ…å« $n$ ä¸ªæ–¹ç¨‹ $n$ ä¸ªæœªçŸ¥æ•°çš„çº¿æ€§æ–¹ç¨‹ç»„ã€‚

æ–¹ç¨‹ç»„ä¸­çš„ç³»æ•°ä¸ºå®æ•°ã€‚

æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ç»„ã€‚

ä¸‹å›¾ä¸ºä¸€ä¸ªåŒ…å« $m$ ä¸ªæ–¹ç¨‹ $n$ ä¸ªæœªçŸ¥æ•°çš„çº¿æ€§æ–¹ç¨‹ç»„ç¤ºä¾‹ï¼š
$$
\begin{cases}
a_{11} x_1 + a_{12} x_2 + \cdots + a_{1n} x_n = b_1 \\
a_{21} x_1 + a_{22} x_2 + \cdots + a_{2n} x_n = b_2 \\
\vdots \\
a_{n1} x_1 + a_{n2} x_2 + \cdots + a_{nn} x_n = b_n
\end{cases}
$$
**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $n+1$ ä¸ªå®æ•°ï¼Œè¡¨ç¤ºä¸€ä¸ªæ–¹ç¨‹çš„ $n$ ä¸ªç³»æ•°ä»¥åŠç­‰å·å³ä¾§çš„å¸¸æ•°ã€‚

**è¾“å‡ºæ ¼å¼**

å¦‚æœç»™å®šçº¿æ€§æ–¹ç¨‹ç»„å­˜åœ¨å”¯ä¸€è§£ï¼Œåˆ™è¾“å‡ºå…± $n$ è¡Œï¼Œå…¶ä¸­ç¬¬ $i$ è¡Œè¾“å‡ºç¬¬ $i$ ä¸ªæœªçŸ¥æ•°çš„è§£ï¼Œç»“æœä¿ç•™ä¸¤ä½å°æ•°ã€‚

æ³¨æ„ï¼šæœ¬é¢˜æœ‰ SPJï¼Œå½“è¾“å‡ºç»“æœä¸º `0.00` æ—¶ï¼Œè¾“å‡º `-0.00` ä¹Ÿä¼šåˆ¤å¯¹ã€‚åœ¨æ•°å­¦ä¸­ï¼Œä¸€èˆ¬æ²¡æœ‰æ­£é›¶æˆ–è´Ÿé›¶çš„æ¦‚å¿µï¼Œæ‰€ä»¥ä¸¥æ ¼æ¥è¯´åº”å½“è¾“å‡º `0.00`ï¼Œä½†æ˜¯è€ƒè™‘åˆ°æœ¬é¢˜ä½œä¸ºä¸€é“æ¨¡æ¿é¢˜ï¼Œè€ƒå¯Ÿç‚¹å¹¶ä¸åœ¨äºæ­¤ï¼Œåœ¨æ­¤å¤„å¡ä½å¤§å¤šåŒå­¦çš„ä»£ç æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œæ•…å¢åŠ  SPJï¼Œå¯¹è¾“å‡º `-0.00` çš„ä»£ç ä¹Ÿäºˆä»¥åˆ¤å¯¹ã€‚

å¦‚æœç»™å®šçº¿æ€§æ–¹ç¨‹ç»„å­˜åœ¨æ— æ•°è§£ï¼Œåˆ™è¾“å‡º `Infinite group solutions`ã€‚

å¦‚æœç»™å®šçº¿æ€§æ–¹ç¨‹ç»„æ— è§£ï¼Œåˆ™è¾“å‡º `No solution`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤100$,
æ‰€æœ‰è¾“å…¥ç³»æ•°ä»¥åŠå¸¸æ•°å‡ä¿ç•™ä¸¤ä½å°æ•°ï¼Œç»å¯¹å€¼å‡ä¸è¶…è¿‡ $100$ã€‚

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
1.00 2.00 -1.00 -6.00
2.00 1.00 -3.00 -9.00
-1.00 -1.00 2.00 7.00
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1.00
-2.00
3.00
```

> **è§£æ**

å¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š
$$
\begin{cases}
a_{11} x_1 + a_{12} x_2 + \cdots + a_{1n} x_n = b_1 \\
a_{21} x_1 + a_{22} x_2 + \cdots + a_{2n} x_n = b_2 \\
\vdots \\
a_{n1} x_1 + a_{n2} x_2 + \cdots + a_{nn} x_n = b_n
\end{cases}
$$
å¯¹çº¿æ€§æ–¹ç¨‹ç»„è¿›è¡Œ**åˆç­‰è¡Œåˆ—å˜æ¢**ï¼ˆæŠŠæŸä¸€è¡Œä¹˜ä¸€ä¸ªéé›¶çš„æ•°ã€äº¤æ¢æŸä¸¤è¡Œã€æŠŠæŸè¡Œçš„è‹¥å¹²å€åŠ åˆ°æŸä¸€è¡Œä¸Šå»ï¼‰ï¼Œ**çº¿æ€§æ–¹ç¨‹ç»„çš„è§£ä¸å˜**

çº¿æ€§æ–¹ç¨‹ç»„ç³»æ•°çš„å¢å¹¿çŸ©é˜µå¦‚ä¸‹ï¼š
$$
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1n} & | & b_1 \\
a_{21} & a_{22} & \cdots & a_{2n} & | & b_2 \\
\vdots & \vdots & \ddots & \vdots & | & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn} & | & b_n
\end{pmatrix}
$$
æŠŠç³»æ•°çŸ©é˜µé€šè¿‡åˆç­‰è¡Œå˜æ¢ï¼Œå˜æˆä¸Šä¸‰è§’å½¢å¼ï¼š
$$
\begin{pmatrix}
? & ? & ? & ? & | & ? \\
0 & ? & ? & ? & | & ? \\
0 & 0 & ? & ? & | & ? \\
0 & 0 & 0 & ? & | & ? \\
\end{pmatrix}
$$
å¦‚æœè¿™ä¸ªä¸Šä¸‰è§’çŸ©é˜µæ˜¯ï¼š

- **å®Œç¾é˜¶æ¢¯å½¢**ï¼šæœ‰å”¯ä¸€è§£
- **æŸä¸€è¡Œç­‰å·å·¦è¾¹æ˜¯ 0ï¼Œå³è¾¹éé›¶**ï¼ˆå³è¾¹æ˜¯ 0ï¼Œå·¦è¾¹éé›¶ï¼‰ï¼šæ— è§£
- **æŸä¸€è¡Œç­‰å·å·¦å³ä¸¤è¾¹éƒ½æ˜¯ 0** ï¼šæœ‰æ— ç©·å¤šä¸ªè§£

é«˜æ–¯æ¶ˆå…ƒç®—æ³•æ€æƒ³ï¼š

æšä¸¾æ¯ä¸€åˆ— $c$

- æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ
-  å°†è¯¥è¡Œæ¢åˆ°æœ€ä¸Šé¢
- å°†è¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ $1$ ï¼ˆè¯¥è¡Œå…¶ä»–æ•°ä¹Ÿè·Ÿç€å˜åŒ–ï¼ŒåŒé™¤ $a_{11}$ ï¼‰
- å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬ $c$ åˆ—æ¶ˆæˆ $0$
- ç¬¬ $c$ è¡Œå’Œç¬¬ $c$ åˆ—ä»æ­¤å›ºå®šï¼Œä¸‹æ¬¡éå†ä» $c+1$ è¡Œ $c+1$ åˆ—å¼€å§‹

$$
\begin{pmatrix}
? & ? & ? & ? & | & ? \\
0 & ? & ? & ? & | & ? \\
0 & 0 & ? & ? & | & ? \\
0 & 0 & 0 & ? & | & ? \\
\end{pmatrix} 
\Rightarrow
\begin{pmatrix}
1 & 2 & 3 & 4 & | & 5 \\
0 & ? & ? & ? & | & ? \\
0 & 0 & ? & ? & | & ? \\
0 & 0 & 0 & ? & | & ? \\
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
1 & 2 & 3 & 4 & | & 5 \\
0 & 1 & 7 & 8 & | & 9 \\
0 & 0 & ? & ? & | & ? \\
0 & 0 & 0 & ? & | & ? \\
\end{pmatrix} 
\Rightarrow
â€¦
\Rightarrow
\begin{pmatrix}
1 & 0 & 0 & 0 & | & 3 \\
0 & 1 & 0 & 0 & | & 4 \\
0 & 0 & 1 & 0 & | & 2 \\
0 & 0 & 0 & 1 & | & 1 \\
\end{pmatrix}
$$



> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 110;
const double eps = 1e-8;
int n;
double a[N][N];
int gauss()  // é«˜æ–¯æ¶ˆå…ƒï¼Œç­”æ¡ˆå­˜äºa[i][n]ä¸­ï¼Œ0 <= i < n
{
    int c, r; // c ä¸ºåˆ—ï¼Œr ä¸ºè¡Œ 
    for (c = 0, r = 0; c < n; c ++) // æŒ‰ç…§åˆ—æšä¸¾ 
    {
        int t = r;
        for (int i = r; i < n; i ++ )  // æ‰¾ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
            if (fabs(a[i][c]) > fabs(a[t][c]))
                t = i;
        if (fabs(a[t][c]) < eps) continue; // è¯¥åˆ—å…¨ä¸º 0 
        for (int i = c; i <= n; i ++ ) swap(a[t][i], a[r][i]);  // å°†ç»å¯¹å€¼æœ€å¤§çš„è¡Œæ¢åˆ°æœ€é¡¶ç«¯
        for (int i = n; i >= c; i -- ) a[r][i] /= a[r][c];  // å°†å½“å‰è¡Œçš„é¦–ä½å˜æˆ1
        for (int i = r + 1; i < n; i ++ )  // ç”¨å½“å‰è¡Œå°†ä¸‹é¢æ‰€æœ‰çš„åˆ—æ¶ˆæˆ0
            if (fabs(a[i][c]) > eps)
                for (int j = n; j >= c; j -- )
                    a[i][j] -= a[r][j] * a[i][c];
        r ++ ;
    }
    if (r < n)
    {
        for (int i = r; i < n; i ++ )
            if (fabs(a[i][n]) > eps)
                return 2; // æ— è§£
        return 1; // æœ‰æ— ç©·å¤šç»„è§£
    }
    for (int i = n - 1; i >= 0; i -- ) // æ¶ˆæˆå•ä½çŸ©é˜µ 
        for (int j = i + 1; j < n; j ++ )
            a[i][n] -= a[i][j] * a[j][n];
    return 0; // æœ‰å”¯ä¸€è§£
}
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++)
    {
    	for (int j = 0; j < n + 1; j ++)
    	{
    		cin >> a[i][j];
		}
	}
    int t = gauss();
    if (t == 2) cout << "No solution" << endl;
    else if (t == 1) cout << "Infinite group solutions" << endl;
    else
    {
        for (int i = 0; i < n; i ++)
            cout << fixed << setprecision(2) << a[i][n] << endl;
    }
    return 0;
}
```

## 6. æ±‚ç»„åˆæ•°

### 6.1 æ±‚ç»„åˆæ•° I

> **é¢˜ç›®**

ç»™å®š $n$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° $a$ï¼Œ$b$ï¼Œè¯·ä½ è¾“å‡º $C_a^b$  $mod$  $(10^9+7)$ çš„å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ç»„ $a$ å’Œ $b$ã€‚

**è¾“å‡ºæ ¼å¼**

å…± $n$ è¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªè¯¢é—®çš„è§£ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10000,$
$1â‰¤bâ‰¤aâ‰¤2000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
3 1
5 3
2 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
10
1
```

> **è§£æ**

ç»„åˆæ•°å…¬å¼ï¼š

$C_a^b=C_{a-1}^b+C_{a-1}^{b-1}$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 2010, mod = 1e9 + 7;
int c[N][N];
void init() // é¢„å¤„ç† 
{
    for(int i = 0; i < N; i ++)
    {
    	for(int j = 0; j <= i; j ++)
    	{
    		if (j == 0) c[i][j] = 1;
    		else c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;
		}
	}          
}
int main()
{
    ll n;
    init();
    cin >> n;
    while(n --)
    {
        ll a, b;
        cin >> a >> b;
        cout << c[a][b] << endl;
    }
    return 0;
}
```

## 7. åšå¼ˆè®º

### 7.1 Nimæ¸¸æˆ

> **é¢˜ç›®**

ç»™å®š $n$ å †çŸ³å­ï¼Œä¸¤ä½ç©å®¶è½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥ä»ä»»æ„ä¸€å †çŸ³å­ä¸­æ‹¿èµ°ä»»æ„æ•°é‡çš„çŸ³å­ï¼ˆå¯ä»¥æ‹¿å®Œï¼Œä½†ä¸èƒ½ä¸æ‹¿ï¼‰ï¼Œæœ€åæ— æ³•è¿›è¡Œæ“ä½œçš„äººè§†ä¸ºå¤±è´¥ã€‚

é—®å¦‚æœä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•°å­—ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªæ•°å­—è¡¨ç¤ºç¬¬ $i$ å †çŸ³å­çš„æ•°é‡ã€‚

**è¾“å‡ºæ ¼å¼**

å¦‚æœå…ˆæ‰‹æ–¹å¿…èƒœï¼Œåˆ™è¾“å‡º `Yes`ã€‚

å¦åˆ™ï¼Œè¾“å‡º `No`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10^5$,
$1â‰¤æ¯å †çŸ³å­æ•°â‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
2
2 3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
```

> **è§£æ**

$C$ è¯­è¨€ä¸­**å¼‚æˆ–**æ“ä½œæ˜¯**äºŒè¿›åˆ¶æŒ‰ä½å¼‚æˆ–**

è®¾ $n$ å †çŸ³å­ä¸ªæ•°åˆ†åˆ«ä¸º  $a_1,a_2,â€¦,a_n$

ç»“è®ºï¼š

- **è‹¥ $a_1 \oplus a_2 \oplus â€¦ \oplus a_n=0$ ï¼Œåˆ™å…ˆæ‰‹å¿…è´¥**
- **è‹¥ $a_1 \oplus a_2 \oplus â€¦ \oplus a_nâ‰ 0$ ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœ**

------

è¯æ˜å¦‚ä¸‹ï¼Œå¯¹äºå…ˆæ‰‹ï¼š

**â‘  è‹¥ $0 \oplus 0 \oplus â€¦ \oplus 0=0$ å…¨ä¸º $0$** ï¼Œå…ˆæ‰‹æ— æ³•æ‹¿ä»»ä½•çŸ³å­ï¼Œå…ˆæ‰‹å¿…è´¥

**â‘¡ è‹¥ $a_1 \oplus a_2 \oplus â€¦ \oplus a_n=xâ‰ 0$**

è®¾ $x$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ€é«˜ä¸€ä½ $1$ åœ¨ç¬¬ $k$ ä½ï¼Œåˆ™ $a_1  \sim a_n$ ä¸­å¿…ç„¶å­˜åœ¨ä¸€ä¸ªæ•° $a_i$ ï¼Œ $a_i$ çš„ç¬¬ $k$ ä½æ˜¯ $1$ ã€‚å¹¶ä¸”ï¼Œ $a_i \oplus xï¼œa_i$ 

æ¯”å¦‚ï¼Œ 
$$
a_i=1100 \ 1001 \  1010 \\ 
\ \ \qquad x=1010 \ 0100 \\
a_i \oplus x=1100 \ 0011 \ 1110 \quad \ \ \ \\
xçš„æœ€é«˜ä¸€ä½1åœ¨ç¬¬7ä½ï¼ŒåŒæ—¶a_içš„ç¬¬7ä½ä¹Ÿæ˜¯1
$$
ç„¶åï¼Œå…ˆæ‰‹ä» $a_i$ ä¸­æ‹¿èµ° $a_i-(a_i \oplus x)$ ä¸ªçŸ³å­ï¼Œåˆ™ç¬¬ $i$ å †å‰©ä¸‹ $a_i-(a_i-(a_i \oplus x))=a_i \oplus x$ ä¸ªçŸ³å­

å·²çŸ¥ $a_1 \oplus a_2 \oplus â€¦ \oplus a_n=xâ‰ 0$ ï¼Œåˆ™æ‹¿èµ°çŸ³å­åï¼Œå‰©ä½™çš„ $a_1 \oplus a_2 \oplus â€¦ \oplus (a_i \oplus x) \oplus a_{i+1} \oplus â€¦ \oplus a_n=x \oplus x=0$ ï¼Œåæ‰‹å¿…è´¥ï¼Œå³å…ˆæ‰‹å¿…èƒœ

**â‘¢ è‹¥ $a_1 \oplus a_2 \oplus â€¦ \oplus a_n=0$**

ç”¨åè¯æ³•ï¼Œå‡è®¾å…ˆæ‰‹å¿…èƒœï¼Œå³å…ˆæ‰‹è¿›è¡Œè¿‡å¯¹ç¬¬ $a_i$ å †æ‹¿çš„æ“ä½œåï¼ˆ$a_i$ å˜ä¸º $a^{'}_{i}$ï¼‰ï¼Œå‰©ä¸‹çš„ $a_1 \oplus a_2 \oplus  â€¦ \oplus a^{'}_{i} \oplus a_{i+1} \oplus â€¦ \oplus a_n$ ä»ä¸º $0$

åˆå› ä¸º $a_1 \oplus a_2 \oplus  â€¦ \oplus a_{i} \oplus a_{i+1} \oplus â€¦ \oplus a_n=0$ ï¼Œå°†ä¸Šè¿°ä¸¤å¼å·¦å³ä¸¤è¾¹è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œå¾—åˆ° $a_i \oplus a^{'}_i=0$ ï¼ŒçŸ›ç›¾ï¼Œæ•…å…ˆæ‰‹å¿…è´¥

------

ç»¼ä¸Šæ‰€è¿°ï¼Œè‹¥å…ˆæ‰‹æƒ…å†µä¸º $a_1 \oplus a_2 \oplus â€¦ \oplus a_nâ‰ 0$ ï¼Œé‚£ä¹ˆå…ˆæ‰‹æ¯æ¬¡éƒ½ä» $a_i$ ä¸­æ‹¿èµ° $a_i-(a_i \oplus x)$ ä¸ªçŸ³å­ï¼Œå°±å¯ä»¥å¿…èƒœ

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int main()
{
    int n;
    cin >> n;
    int res = 0;
    while (n --)
    {
        int x;
        cin >> x; 
        res ^= x;
    }
    if (res) cout << "Yes" << endl;
    else cout << "No" << endl;
    return 0;
}
```

### 7.2 å°é˜¶-Nimæ¸¸æˆ

> **é¢˜ç›®**

ç°åœ¨ï¼Œæœ‰ä¸€ä¸ª $n$ çº§å°é˜¶çš„æ¥¼æ¢¯ï¼Œæ¯çº§å°é˜¶ä¸Šéƒ½æœ‰è‹¥å¹²ä¸ªçŸ³å­ï¼Œå…¶ä¸­ç¬¬ $i$ çº§å°é˜¶ä¸Šæœ‰ $a_i$ ä¸ªçŸ³å­($iâ‰¥1$)ã€‚

ä¸¤ä½ç©å®¶è½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥ä»ä»»æ„ä¸€çº§å°é˜¶ä¸Šæ‹¿è‹¥å¹²ä¸ªçŸ³å­æ”¾åˆ°ä¸‹ä¸€çº§å°é˜¶ä¸­ï¼ˆä¸èƒ½ä¸æ‹¿ï¼‰ã€‚

å·²ç»æ‹¿åˆ°åœ°é¢ä¸Šçš„çŸ³å­ä¸èƒ½å†æ‹¿ï¼Œæœ€åæ— æ³•è¿›è¡Œæ“ä½œçš„äººè§†ä¸ºå¤±è´¥ã€‚

é—®å¦‚æœä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œå…ˆæ‰‹æ˜¯å¦å¿…èƒœã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªæ•´æ•°è¡¨ç¤ºç¬¬ $i$ çº§å°é˜¶ä¸Šçš„çŸ³å­æ•° $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

å¦‚æœå…ˆæ‰‹æ–¹å¿…èƒœï¼Œåˆ™è¾“å‡º `Yes`ã€‚

å¦åˆ™ï¼Œè¾“å‡º `No`ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10^5$,
$1â‰¤a_iâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
2 1 3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
Yes
```

> **è§£æ**

è®¾ $n$ çº§æ¥¼æ¢¯ä¸Šçš„çŸ³å­ä¸ªæ•°åˆ†åˆ«ä¸º  $a_1,a_2,â€¦,a_n$

ç»“è®ºï¼š

- **è‹¥å¥‡æ•°çº§å°é˜¶å¼‚æˆ–å’Œ $a_1 \oplus a_3 \oplus â€¦ \oplus a_n=0$ ï¼Œåˆ™å…ˆæ‰‹å¿…è´¥**
- **è‹¥å¥‡æ•°çº§å°é˜¶å¼‚æˆ–å’Œ $a_1 \oplus a_3 \oplus â€¦ \oplus a_n=xâ‰ 0$ ï¼Œåˆ™å…ˆæ‰‹å¿…èƒœ**

æ˜¯å¥‡æ•°çº§å°é˜¶çš„åŸå› ï¼šä¿è¯å…ˆæ‰‹æœ€åå¾—åˆ°çŠ¶æ€ $\Rightarrow$ å°é˜¶ $1$ ä¸Šé¢æœ‰ $x$ ä¸ªçŸ³å­ï¼Œå…¶ä½™å°é˜¶ä¸Šé¢éƒ½æ²¡æœ‰çŸ³å­

------

è¯æ˜å¦‚ä¸‹ï¼Œå¯¹äºå…ˆæ‰‹ï¼š

**â‘  è‹¥ $a_1 \oplus a_3 \oplus a_5 \oplus â€¦ \oplus a_n=xâ‰ 0$**

è®¾ $x$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ€é«˜ä¸€ä½ $1$ åœ¨ç¬¬ $k$ ä½ï¼Œåˆ™ $a_1  \sim a_n$ ä¸­å¿…ç„¶å­˜åœ¨ä¸€ä¸ªæ•° $a_i$ ï¼Œ $a_i$ çš„ç¬¬ $k$ ä½æ˜¯ $1$ ã€‚å¹¶ä¸”ï¼Œ $a_i \oplus xï¼œa_i$ 

ç„¶åï¼Œå…ˆæ‰‹ä» $a_i$ ä¸­æ‹¿èµ° $a_i-(a_i \oplus x)$ ä¸ªçŸ³å­ï¼Œæ”¾åˆ° $a_{i-1}$ å †ä¸­å»ï¼Œåˆ™ç¬¬ $i$ å †å‰©ä¸‹ $a_i-(a_i-(a_i \oplus x))=a_i \oplus x$ ä¸ªçŸ³å­

å·²çŸ¥ $a_1 \oplus a_3 \oplus a_5 \oplus â€¦ \oplus a_n=xâ‰ 0$ ï¼Œåˆ™æ‹¿èµ°çŸ³å­åï¼Œå‰©ä½™çš„ $a_1 \oplus a_3 \oplus â€¦ \oplus (a_i \oplus x) \oplus a_{i+2} \oplus â€¦ \oplus a_n=x \oplus x=0$ ï¼Œåæ‰‹å¿…è´¥ï¼Œå³å…ˆæ‰‹å¿…èƒœ

------

ç»¼ä¸Šæ‰€è¿°ï¼Œè‹¥å…ˆæ‰‹æƒ…å†µä¸º $a_1 \oplus a_3 \oplus a_5 \oplus â€¦ \oplus a_nâ‰ 0$ ï¼Œé‚£ä¹ˆå…ˆæ‰‹æ¯æ¬¡éƒ½ä» $a_i$ ï¼ˆ $i$ ä¸ºå¥‡æ•°ï¼‰ä¸­æ‹¿èµ° $a_i-(a_i \oplus x)$ ä¸ªçŸ³å­ï¼Œæ”¾åˆ° $a_{i-1}$ ï¼ˆ $i-1$ ä¸ºå¶æ•°ï¼‰å †ä¸­å»ï¼Œå°±å¯ä»¥å¿…èƒœ

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 100010;
int main()
{
    int n;
    cin >> n;
    int res = 0;
    for (int i = 1; i <= n; i ++)
    {
        int x;
        cin >> x;
        if (i & 1) res ^= x; // å¥‡æ•°çº§å°é˜¶ 
    }
    if (res) cout << "Yes" << endl;
    else cout << "No" << endl;
    return 0;
}
```

# åŠ¨æ€è§„åˆ’

## 1. èƒŒåŒ…é—®é¢˜

### 1.1 0-1èƒŒåŒ…é—®é¢˜

> **é¢˜ç›®**

æœ‰ $N$ ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ $V$ çš„èƒŒåŒ…ã€‚æ¯ä»¶ç‰©å“åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚

ç¬¬ $i$ ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ $v_i$ï¼Œä»·å€¼æ˜¯ $w_i$ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼Œ$N$ï¼Œ$V$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“æ•°é‡å’ŒèƒŒåŒ…å®¹ç§¯ã€‚

æ¥ä¸‹æ¥æœ‰ $N$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $v_i,w_i$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ ä»¶ç‰©å“çš„ä½“ç§¯å’Œä»·å€¼ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

**æ•°æ®èŒƒå›´**

$0<N,Vâ‰¤1000$
$0<v_i,w_iâ‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4 5
1 2
2 4
3 4
4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
8
```

> **è§£æ**

$f[i][j]$ è¡¨ç¤ºåªçœ‹å‰ $i$ ä¸ªç‰©å“ï¼Œæ€»ä½“ç§¯æ˜¯ $j$ çš„æƒ…å†µä¸‹ï¼Œæ€»ä»·å€¼æœ€å¤§æ˜¯å¤šå°‘ã€‚

$result=max\{f[n][0\sim v]\}$

åˆ™ï¼š

$$ f[i][j]=\left\{ \begin{matrix} f[i-1][j] & ä¸é€‰ç¬¬iä¸ªç‰©å“ \\ f[i-1][j-v[i]]+w[i] & é€‰ç¬¬iä¸ªç‰©å“ \end{matrix} \right. $$

> **ä»£ç æ¨¡æ¿**

**æœ´ç´ åšæ³• (äºŒç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1010;
ll f[N][N];
ll v[N], w[N];
int main()
{
	ll n, m;
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> v[i] >> w[i];
	}
	for(int i = 1; i <= n; i ++)
	{
		for(int j = 0; j <= m; j ++)
		{
			f[i][j] = f[i - 1][j];
			if(j >= v[i])
			f[i][j] = max(f[i][j], f[i - 1][j - v[i]] + w[i]);
		}
	}
	ll res = 0;
	for(int i = 0; i <= m; i ++)
	{
		res = max(res, f[n][i]);
	}
	cout << res << endl; // è¿™é‡Œç›´æ¥cout << f[n][m]ä¹Ÿå¯ä»¥ 
	return 0;
}
```

**ç©ºé—´ä¼˜åŒ– (ä¸€ç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1010;
ll f[N];
ll v[N], w[N];
int main()
{
	ll n, m;
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> v[i] >> w[i];
	}
	for(int i = 1; i <= n; i ++)
	{
		for(int j = m; j >= v[i]; j --)
		{
			f[j] = max(f[j], f[j - v[i]] + w[i]);
		}
	}
    cout << f[m] << endl;
	return 0;
}
```

å¦‚æœç›´æ¥åˆ é™¤æ‰ $f[i]$ è¿™ä¸€ç»´ï¼Œå³

$f[j] = max(f[j], f[j-v[i]] + w[i]);$

å¦‚æœåˆ æ‰ $f[i]$ è¿™ä¸€ç»´ï¼Œç»“æœå¦‚ä¸‹ï¼šï¼ˆå¦‚æœ $j$ å±‚å¾ªç¯æ—¶é€’å¢çš„ï¼Œåˆ™æ˜¯é”™è¯¯çš„ï¼‰

```c++
for (int i = 1; i <= n; i++) {
    for (int j = v[i]; j <= m; j++) {
        f[j] = max(f[j], f[j - v[i]] + w[i]);
    }
}
```

è¯æ˜ï¼š$j$ å±‚å¾ªç¯è‹¥æ˜¯é€’å¢çš„ï¼Œåˆ™æ˜¯é”™è¯¯çš„

åŸå¼ï¼š$f[i][j] = max(f[i][j], f[i - 1][j - v[i]] + w[i]);$

æ”¹æˆä¸€ç»´ï¼š$f[j] = max(f[j], f[j - v[i]] + w[i]);$

ç”±äº $f[i][]$ åªè·Ÿä¸Šä¸€çŠ¶æ€ï¼ˆ$f[i - 1][]$ï¼‰æœ‰å…³ï¼Œä¸Šé¢ä¸¤ä¸ªå¼å­ ï¼šè¿™ä¸€çŠ¶æ€ï¼ˆå·¦ï¼‰= ä¸Šä¸€çŠ¶æ€ï¼ˆå³ï¼‰

å³ $f[i][j]$ æ˜¯ç”± $f[i - 1][j - v[i]]$ æ¨å‡ºæ¥çš„ï¼Œç°åœ¨è¿›è¡Œç©ºé—´ä¼˜åŒ–ï¼Œé‚£ä¹ˆå¿…é¡»è¦ä¿è¯ $f[j]$ è¦ç”± $f[j - v[i]]$ æ¨å‡ºæ¥çš„ã€‚

å¦‚æœ $j$ å±‚å¾ªç¯æ˜¯é€’å¢çš„ï¼Œåˆ™ç›¸å½“äº $f[i][j]$ å˜å¾—æ˜¯ç”± $f[i][j - v[i]]$ æ¨å‡ºæ¥çš„ï¼Œ è€Œä¸æ˜¯ $f[i - 1][j - v[i]]$ æ¨å‡ºæ¥çš„ã€‚**æ‰€ä»¥éœ€è¦è¿›è¡Œé€†åºå¤„ç†**ã€‚

### 1.2 å®Œå…¨èƒŒåŒ…é—®é¢˜

> **é¢˜ç›®**

æœ‰ $N$ ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ $V$ çš„èƒŒåŒ…ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰æ— é™ä»¶å¯ç”¨ã€‚

ç¬¬ $i$ ç§ç‰©å“çš„ä½“ç§¯æ˜¯ $v_i$ï¼Œä»·å€¼æ˜¯ $w_i$ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚
è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼Œ$Nï¼ŒV$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç§æ•°å’ŒèƒŒåŒ…å®¹ç§¯ã€‚

æ¥ä¸‹æ¥æœ‰ $N$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $v_i,w_i$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ ç§ç‰©å“çš„ä½“ç§¯å’Œä»·å€¼ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

**æ•°æ®èŒƒå›´**

$0<N,Vâ‰¤1000$
$0<v_i,w_iâ‰¤1000$

**è¾“å…¥æ ·ä¾‹**

```
4 5
1 2
2 4
3 4
4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
10
```

> **è§£æ**

$f[i][j]$ è¡¨ç¤ºåªçœ‹å‰ $i$ ä¸ªç‰©å“ï¼Œæ€»ä½“ç§¯æ˜¯ $j$ çš„æƒ…å†µä¸‹ï¼Œæ€»ä»·å€¼æœ€å¤§æ˜¯å¤šå°‘ã€‚

**0-1èƒŒåŒ…**ï¼š$f[i][j] = max(f[i-1][j], f[i - 1][j - v] + w)$

**å®Œå…¨èƒŒåŒ…**ï¼š$f[i][j] = max(f[i-1][j], f[i][j - v] + w)$

å¯¹å®Œå…¨èƒŒåŒ…é—®é¢˜è¿›è¡Œæ•°å­¦æ¨å¯¼ï¼š
$$
f[i][j] = max(f[i-1][j],f[i - 1][j - v] + w,f[i - 1][j - 2v] + 2wâ€¦â€¦) \qquad (1)å¼ \\
ä»¤ j=j-v,ä»£å…¥(1)å¼,å¾—: \\
f[i][j-v] = max(f[i-1][j-v],f[i-1][j-2v] + w,f[i-1][j-3v]+2wâ€¦â€¦) \qquad (2)å¼\\
ä»¤(2)å¼=u \\
å³ \quad max(f[i-1][j-v],f[i-1][j-2v] + w,f[i-1][j-3v]+2wâ€¦â€¦)=u, \\
åˆ™(1)å¼å³éƒ¨ä¸­ \quad max(f[i - 1][j - v] + w,f[i - 1][j - 2v] + 2wâ€¦â€¦)=u+w \qquad (3)å¼ \\
åˆå› ä¸º: \quad f[i][j-v]ä¹Ÿç­‰äºu \\
æ‰€ä»¥ï¼š\quad (3)å¼=u+w=f[i][j-v]+w \\
ä»£å›(1)å¼ä¸­, \quad f[i][j] = max(f[i-1][j],f[i][j-v]+w), \quad å¾—è¯\#
$$

> **ä»£ç æ¨¡æ¿**

**æœ´ç´ åšæ³• (äºŒç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1010;
ll f[N][N];
ll v[N], w[N];
int main()
{
	ll n, m;
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> v[i] >> w[i];
	}
	for(int i = 1; i <= n; i ++)
	{
		for(int j = 0; j <= m; j ++)
		{
			f[i][j] = f[i - 1][j];
			if(j >= v[i])
			f[i][j] = max(f[i][j], f[i][j - v[i]] + w[i]); // ä¸01èƒŒåŒ…ç›¸æ¯”ï¼Œå”¯ä¸€çš„æ”¹åŠ¨åœ¨è¿™é‡Œ
		}
	}
	cout << f[n][m] << endl;
	return 0;
}
```

**ç©ºé—´ä¼˜åŒ– (ä¸€ç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1010;
ll f[N];
ll v[N], w[N];
int main()
{
	ll n, m;
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> v[i] >> w[i];
	}
	for(int i = 1; i <= n; i ++)
	{
		for(int j = v[i]; j <= m; j ++) // ä¸01èƒŒåŒ…ç›¸æ¯”ï¼Œå”¯ä¸€çš„æ”¹åŠ¨åœ¨è¿™é‡Œ
		{
			f[j] = max(f[j], f[j - v[i]] + w[i]);
		}
	}
    cout << f[m] << endl;
	return 0;
}
```

å› ä¸ºç°åœ¨ $f[i][j]$ æ˜¯ç”± $f[i][j - v[i]]$ æ¨å‡ºæ¥çš„äº†ï¼Œæ‰€ä»¥éœ€è¦**æ­£åºéå†**ã€‚

### 1.3 å¤šé‡èƒŒåŒ…é—®é¢˜ I

> **é¢˜ç›®**

æœ‰ $N$ ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ $V$ çš„èƒŒåŒ…ã€‚

ç¬¬ $i$ ç§ç‰©å“æœ€å¤šæœ‰ $s_i$ ä»¶ï¼Œæ¯ä»¶ä½“ç§¯æ˜¯ $v_i$ï¼Œä»·å€¼æ˜¯ $w_i$ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚
è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼Œ$Nï¼ŒV$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç§æ•°å’ŒèƒŒåŒ…å®¹ç§¯ã€‚

æ¥ä¸‹æ¥æœ‰ $N$ è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ•´æ•° $v_i,w_i,s_i$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ ç§ç‰©å“çš„ä½“ç§¯ã€ä»·å€¼å’Œæ•°é‡ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

**æ•°æ®èŒƒå›´**

$0<N,Vâ‰¤100$
$0<v_i,w_i,s_iâ‰¤100$

**è¾“å…¥æ ·ä¾‹**

```
4 5
1 2 3
2 4 1
3 4 3
4 5 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
10
```

> **è§£æ**

é€’æ¨å¼å¦‚ä¸‹ï¼š

$f[i][j] = max(f[i][j], f[i - 1][j - k Ã— v[i]] + k Ã— w[i]) \qquad kâˆˆ[0,s_i] $

æ•°æ®èŒƒå›´ä¸å¤§ï¼Œ $O(n^3)$ å¯ä»¥è¿‡

> **ä»£ç æ¨¡æ¿**

**æœ´ç´ åšæ³• (äºŒç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 110;
int n, m;
int v[N], w[N], s[N];
int f[N][N];
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++)
    {
    	cin >> v[i] >> w[i] >> s[i];
	}
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 0; j <= m; j ++)
    	{
    		for (int k = 0; k <= s[i] && k * v[i] <= j; k ++) // kç­‰äºé›¶è¡¨ç¤ºä¸é€‰è¿™ä¸ªç‰©å“ï¼Œkä¸ºæ­£æ•°è¡¨ç¤ºé€‰ k ä¸ªè¿™ä¸ªç‰©å“ 
    		{
    			f[i][j] = max(f[i][j], f[i - 1][j - v[i] * k] + w[i] * k);
			}
		}
	}
    cout << f[n][m] << endl;
    return 0;
}
```

**ç©ºé—´ä¼˜åŒ– (ä¸€ç»´)ï¼š**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 110;
ll f[N];
ll v[N], w[N], s[N];
int main()
{
	ll n, m;
	cin >> n >> m;
	for(int i = 1; i <= n; i ++)
	{
		cin >> v[i] >> w[i] >> s[i];
	}
	for(int i = 1; i <= n; i ++)
	{
		for(int j = m; j >= v[i]; j --) // ä¾ç„¶æ˜¯é€†åº
		{
			for(int k = 1; k <= s[i] && k * v[i] <= j; k ++) //å®é™…ä¸Šç›¸å½“äº01èƒŒåŒ…çš„æ‰©å±•ï¼Œå¤šäº†ä¸€å±‚å¾ªç¯
			{
				f[j] = max(f[j], f[j - k * v[i]] + k * w[i]);
			}
			
		}
	}
    cout << f[m] << endl;
	return 0;
}
```

### 1.4 å¤šé‡èƒŒåŒ…é—®é¢˜ II

> **é¢˜ç›®**

æœ‰ $N$ ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ $V$ çš„èƒŒåŒ…ã€‚

ç¬¬ $i$ ç§ç‰©å“æœ€å¤šæœ‰ $s_i$ ä»¶ï¼Œæ¯ä»¶ä½“ç§¯æ˜¯ $v_i$ï¼Œä»·å€¼æ˜¯ $w_i$ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚
è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•°ï¼Œ$Nï¼ŒV$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç§æ•°å’ŒèƒŒåŒ…å®¹ç§¯ã€‚

æ¥ä¸‹æ¥æœ‰ $N$ è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ•´æ•° $v_i,w_i,s_i$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ ç§ç‰©å“çš„ä½“ç§¯ã€ä»·å€¼å’Œæ•°é‡ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

**æ•°æ®èŒƒå›´**

$0<Nâ‰¤1000$
$0<Vâ‰¤2000$
$0<v_i,w_i,s_iâ‰¤2000$

**æç¤ºï¼š**

æœ¬é¢˜è€ƒæŸ¥å¤šé‡èƒŒåŒ…çš„äºŒè¿›åˆ¶ä¼˜åŒ–æ–¹æ³•ã€‚

**è¾“å…¥æ ·ä¾‹**

```
4 5
1 2 3
2 4 1
3 4 3
4 5 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
10
```

> **è§£æ**

é¢˜é¢å’Œä¸Šä¸€é¢˜å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯æ•°æ®èŒƒå›´å˜å¤§äº†ã€‚

å¯ä»¥**æŠŠå¤šé‡èƒŒåŒ…é—®é¢˜è½¬åŒ–æˆ 01 èƒŒåŒ…é—®é¢˜**ï¼Œä¹Ÿå°±æ˜¯æŠŠ $s$ ä¸ªç›¸åŒçš„ç‰©å“å…¨éƒ¨åŠ å…¥ 01 èƒŒåŒ…ä¸­ï¼Œæ‰€ä»¥æ€»å…±æœ‰ $\sum_{i=0}^{n-1}s[i]$ ä¸ªç‰©å“ã€‚

ä½†æ˜¯æ˜¾ç„¶ï¼Œè¿™æ ·å¹¶æ²¡æœ‰ä½¿å¤æ‚åº¦é™ä½ã€‚

å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¿…è¦æŠŠ $s[i]$ ä¸ªç‰©å“æ‹†åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„ï¼Œåªè¦æ‹†åˆ†å‡ºçš„æ•°èƒ½å®Œæ•´è¡¨ç¤ºå‡º $[1 \sim s[i]]$ ä¹‹é—´çš„æ‰€æœ‰çš„æ•°å³å¯ã€‚

æ‰€ä»¥ä½¿ç”¨**äºŒè¿›åˆ¶æ‹†åˆ†æ³•**

å¼•ç†ï¼š

$$å¯¹äºä»»æ„ä¸€ä¸ªæ•° s ï¼Œä¸€å®šå¯ä»¥åˆ†æˆ \lceil \log_2{s} \rceil ä¸ªæ•°ï¼Œä¸”è¿™ \lceil \log_2{s} \rceil ä¸ªæ•°ä¸€å®šèƒ½è¡¨ç¤ºå‡ºï¼Œå¹¶ä¸”ä»…èƒ½è¡¨ç¤ºå‡º [1,s] ä¹‹é—´çš„ä»»æ„ä¸€ä¸ªæ•°ã€‚$$

æ¯”å¦‚ï¼Œå¯¹äº $s=13$ ï¼Œ

å¯ä»¥æ‹†åˆ†æˆ $1,2,4,6$ ï¼Œè¿™å››ä¸ªæ•°å¯ä»¥è¡¨ç¤ºå‡º $[1 \sim 13]$ ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°ï¼Œä½†æ˜¯ä¸èƒ½è¡¨ç¤ºå‡º $â‰¥14$ çš„æ•°

> **ä»£ç æ¨¡æ¿**

```cpp
#include<bits/stdc++.h> 
using namespace std;
const int N = 11010, M = 2010; // ä¼˜åŒ–åï¼Œæœ€å¤šæœ‰ log2000 * 1000 = 11000 ä¸ªç‰©å“ 
int n, m;
int v[N], w[N];
int f[M];
int cnt; // è®°å½•ç‰©å“æ€»ä¸ªæ•° 
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++)
    {
        int a, b, s; // ä¸´æ—¶å˜é‡ 
        cin >> a >> b >> s;
        int k = 1;
        while (k <= s)
        {
            cnt ++;
            v[cnt] = a * k;
            w[cnt] = b * k;
            s -= k;
            k *= 2;
        }
        if (s > 0) // 1ã€2ã€4ã€8â€¦ç­‰æ•°æ— æ³•å®Œå…¨è¡¨ç¤ºå‡º s çš„æƒ…å†µ 
        {
            cnt ++ ;
            v[cnt] = a * s;
            w[cnt] = b * s;
        }
    }
    n = cnt; // æ›´æ–°ç‰©å“ä¸ªæ•° 
    for (int i = 1; i <= n; i ++) // ä¸€ç»´ 01 èƒŒåŒ…é—®é¢˜ 
        for (int j = m; j >= v[i]; j --)
            f[j] = max(f[j], f[j - v[i]] + w[i]);
    cout << f[m] << endl;
    return 0;
}
```

### 1.5 åˆ†ç»„èƒŒåŒ…é—®é¢˜

> **é¢˜ç›®**

æœ‰ $N$ ç»„ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ $V$ çš„èƒŒåŒ…ã€‚

æ¯ç»„ç‰©å“æœ‰è‹¥å¹²ä¸ªï¼ŒåŒä¸€ç»„å†…çš„ç‰©å“æœ€å¤šåªèƒ½é€‰ä¸€ä¸ªã€‚
æ¯ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ $v_{ij}$ï¼Œä»·å€¼æ˜¯ $w_{ij}$ï¼Œå…¶ä¸­ $i$ æ˜¯ç»„å·ï¼Œ$j$ æ˜¯ç»„å†…ç¼–å·ã€‚

æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚

è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° $Nï¼ŒV$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç‰©å“ç»„æ•°å’ŒèƒŒåŒ…å®¹é‡ã€‚

æ¥ä¸‹æ¥æœ‰ $N$ ç»„æ•°æ®ï¼š

- æ¯ç»„æ•°æ®ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ªæ•´æ•° $S_i$ï¼Œè¡¨ç¤ºç¬¬ $i$ ä¸ªç‰©å“ç»„çš„ç‰©å“æ•°é‡ï¼›
- æ¯ç»„æ•°æ®æ¥ä¸‹æ¥æœ‰ $S_i$ è¡Œï¼Œæ¯è¡Œæœ‰ä¸¤ä¸ªæ•´æ•° $v_{ij},w_{ij}$ï¼Œç”¨ç©ºæ ¼éš”å¼€ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰©å“ç»„çš„ç¬¬ $j$ ä¸ªç‰©å“çš„ä½“ç§¯å’Œä»·å€¼ï¼›

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§ä»·å€¼ã€‚

**æ•°æ®èŒƒå›´**

$0<N,Vâ‰¤100$
$0<S_iâ‰¤100$
$0<v_{ij},w_{ij}â‰¤100$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 5
2
1 2
2 4
1
3 4
1
4 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
8
```

> **è§£æ**

**åˆ†ç»„èƒŒåŒ…é—®é¢˜** é€’æ¨å¼å¦‚ä¸‹ï¼š

$f[i][j] = max(f[i][j],f[i-1][j-v[i][0]] + w[i][0],f[i-1][j-v[i][1]] + w[i][1],â€¦,f[i-1][j-v[i][s_i-1]] + w[i][s_i-1]) \qquad äºŒç»´$

ä¹Ÿå³ï¼š

$f[j] = max(f[j],f[j-v[i][0]] + w[i][0],f[j-v[i][1]] + w[i][1],â€¦,f[j-v[i][s_i-1]] + w[i][s_i-1]) \qquad ä¸€ç»´$

å¦å¤–ï¼Œå¤šé‡èƒŒåŒ…é—®é¢˜å’Œåˆ†ç»„èƒŒåŒ…é—®é¢˜ä»£ç å¾ˆç›¸ä¼¼ï¼Œè¿™æ˜¯å› ä¸º**å¤šé‡èƒŒåŒ…é—®é¢˜ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ç‰¹æ®Šçš„åˆ†ç»„èƒŒåŒ…é—®é¢˜**ã€‚å³åœ¨å¤šé‡èƒŒåŒ…é—®é¢˜ä¸­ï¼Œç¬¬ $i$ ä¸ªç‰©å“æœ‰ $s_i$ ä»¶ï¼ŒæŠŠè¿™ $s_i$ ä»¶ç‰©å“çœ‹æˆä¸€ä¸ªç»„ $\{[v_i,w_i],[2Â·v_i,2Â·w_i],â€¦[s_iÂ·v_i,s_iÂ·w_i]\}$ï¼Œå°±è½¬åŒ–æˆäº†åˆ†ç»„èƒŒåŒ…é—®é¢˜ã€‚

å› ä¸ºå¤šé‡èƒŒåŒ…é—®é¢˜æ˜¯ç‰¹æ®Šçš„åˆ†ç»„èƒŒåŒ…é—®é¢˜ï¼Œå…·æœ‰ç‰¹æ®Šæ€§ï¼Œæ‰€ä»¥å¯ä»¥å»ä¼˜åŒ–ï¼ˆäºŒè¿›åˆ¶ä¼˜åŒ–æ³•ï¼‰ã€‚è€Œåˆ†ç»„èƒŒåŒ…é—®é¢˜æ˜¯ä¸€ä¸ªæ›´å…·æœ‰ä¸€èˆ¬æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¸å¥½å»ä¼˜åŒ–ã€‚

> **ä»£ç æ¨¡æ¿**

```cpp
#include<bits/stdc++.h>
using namespace std;
const int N = 110;
int n, m;
int v[N][N], w[N][N], s[N];
int f[N];
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++)
    {
        cin >> s[i];
        for (int j = 0; j < s[i]; j ++)
            cin >> v[i][j] >> w[i][j];
    }
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = m; j >= 0; j --)
    	{
    		for (int k = 0; k < s[i]; k ++)
    		{
    			if (v[i][k] <= j)
    			{
    				f[j] = max(f[j], f[j - v[i][k]] + w[i][k]);
				}
			} 
		}
	}              
    cout << f[m] << endl;
    return 0;
}
```

## 2. çº¿æ€§DP

### 2.1 æœ€å¤§å­æ®µå’Œ

> **é¢˜ç›®**

[æ´›è°· P1115]([P1115 æœ€å¤§å­æ®µå’Œ - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/problem/P1115))

**é¢˜ç›®æè¿°**

ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a$ï¼Œé€‰å‡ºå…¶ä¸­è¿ç»­ä¸”éç©ºçš„ä¸€æ®µä½¿å¾—è¿™æ®µå’Œæœ€å¤§ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåºåˆ—çš„é•¿åº¦ $n$ã€‚

ç¬¬äºŒè¡Œæœ‰ $n$ ä¸ªæ•´æ•°ï¼Œç¬¬ $i$ ä¸ªæ•´æ•°è¡¨ç¤ºåºåˆ—çš„ç¬¬ $i$ ä¸ªæ•°å­— $a_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚

**æ ·ä¾‹ #1**

**æ ·ä¾‹è¾“å…¥ #1**

```
7
2 -4 3 -1 2 -4 3
```

**æ ·ä¾‹è¾“å‡º #1**

```
4
```

**æç¤º**

**æ ·ä¾‹ 1 è§£é‡Š**

é€‰å– $[3, 5]$ å­æ®µ $\{3, -1, 2\}$ï¼Œå…¶å’Œä¸º $4$ã€‚

**æ•°æ®è§„æ¨¡ä¸çº¦å®š**

- å¯¹äº $40\%$ çš„æ•°æ®ï¼Œä¿è¯ $n \leq 2 \times 10^3$ã€‚
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $1 \leq n \leq 2 \times 10^5$ï¼Œ$-10^4 \leq a_i \leq 10^4$ã€‚

> **è§£æ**

è®¾ $b[j]$ ä¸ºå¼ºåˆ¶ä»¥ $j$ ç»“å°¾çš„æœ€å¤§å­æ®µå’Œï¼Œ

åˆ™åŠ¨æ€è§„åˆ’é€’æ¨å¼ä¸º $b[j]=max\{b[j-1]+a[j],a[j]\}$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 2e5 + 10;
ll a[N], b[N], ans = LLONG_MIN;
int main()
{
	ll n;
	cin >> n;
	for(int i = 1; i <= n; i ++)
	{
		cin >> a[i];
		if(i == 1)
		{
			b[i] = a[i];
		}
		else
		{
			b[i] = max(b[i - 1] + a[i], a[i]);
		}
		ans = max(ans, b[i]);
	}
	cout << ans << endl;
	return 0;
} 
```

### 2.2 æœ€é•¿å…¬å…±å­åºåˆ—

> **é¢˜ç›®**

ç»™å®šä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º $N$ å’Œ $M$ çš„å­—ç¬¦ä¸² $A$ å’Œ $B$ï¼Œæ±‚æ—¢æ˜¯ $A$ çš„å­åºåˆ—åˆæ˜¯ $B$ çš„å­åºåˆ—çš„å­—ç¬¦ä¸²é•¿åº¦æœ€é•¿æ˜¯å¤šå°‘ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $N$ å’Œ $M$ã€‚

ç¬¬äºŒè¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $A$ã€‚

ç¬¬ä¸‰è¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º $M$ çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $B$ã€‚

å­—ç¬¦ä¸²å‡ç”±å°å†™å­—æ¯æ„æˆã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§é•¿åº¦ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤N,Mâ‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4 5
acbd
abedc
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
3
```

> **è§£æ**

ç»™å®šä¸¤ä¸ªåºåˆ— $X=\{x_1,x_2,â€¦,x_m\}$ å’Œ $Y=\{y_1,y_2,â€¦,y_n\}$ï¼Œ

å…¶ä¸­ï¼Œ$X_i$ å’Œ $Y_j$ åˆ†åˆ«è¡¨ç¤ºå­åºåˆ— $\{x_1,x_2,â€¦,x_i\}$ å’Œ $\{y_1,y_2,â€¦,y_j\}$

ç”¨ $c[i][j]$ è®°å½•åºåˆ— $X_i$ å’Œ $Y_j$ çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚

åˆ™ï¼š

$$ c[i][j]=\left\{ \begin{matrix} 0 & i>0;j=0æˆ–j>0;i=0 \\ c[i-1][j-1]+1 & i,j>0;x_i=y_j \\ max\{c[i][j-1],c[i-1][j]\} & i,j>0;x_iâ‰ y_j \end{matrix} \right. $$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1010;
ll n, m;
char a[N], b[N];
int f[N][N];
int main()
{
    cin >> n >> m;
    cin >> a + 1 >> b + 1; // æ–¹ä¾¿åç»­ä»ä¸‹æ ‡1å¼€å§‹éå† 
    for (int i = 1; i <= n; i ++)
    {
        for (int j = 1; j <= m; j ++)
        {
            f[i][j] = max(f[i - 1][j], f[i][j - 1]);
            if (a[i] == b[j])
			{
				f[i][j] = f[i - 1][j - 1] + 1;
			}
        }
    }
    cout << f[n][m] << endl;
    return 0;
}
```

### 2.3 æœ€é•¿ä¸Šå‡å­åºåˆ— I

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„æ•°åˆ—ï¼Œæ±‚æ•°å€¼ä¸¥æ ¼å•è°ƒé€’å¢çš„å­åºåˆ—çš„é•¿åº¦æœ€é•¿æ˜¯å¤šå°‘ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $N$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®Œæ•´åºåˆ—ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§é•¿åº¦ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤100000$ï¼Œ
$âˆ’10^9â‰¤æ•°åˆ—ä¸­çš„æ•°â‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
7
3 1 2 1 8 5 6
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
4
```

> **è§£æ**

$a[i]$ è¡¨ç¤ºæ•°åˆ—ä¸­ç¬¬ $i$ ä¸ªæ•°

$f[i]$ è¡¨ç¤ºæ‰€æœ‰ä»¥ ç¬¬ $i$ ä¸ªæ•°ç»“å°¾çš„ä¸Šå‡å­åºåˆ—çš„é•¿åº¦æœ€å¤§å€¼

$$ f[i]=\left\{ \begin{matrix} 1 & a[i]å‰é¢æ²¡æœ‰æ¯”å®ƒå°çš„æ•°äº† \\ max(f[i],f[j]+1) & j<iä¸”a[j]<a[i] \end{matrix} \right. $$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 1010;
int n;
int a[N], f[N];
int main()
{
    cin >> n;
    for (int i = 1; i <= n; i ++) cin >> a[i];
    for (int i = 1; i <= n; i ++)
    {
        f[i] = 1; // åªæœ‰a[i]ä¸€ä¸ªæ•°
        for (int j = 1; j < i; j ++) // å‘å‰å¯»æ‰¾æ»¡è¶³ a[j] < a[i] çš„æ‰€æœ‰æ•°
            if (a[j] < a[i])
                f[i] = max(f[i], f[j] + 1); // å–è¿™äº›æ•°çš„ f[j] æœ€å¤§å€¼ï¼Œå† + 1
    }
    int res = 0;
    for (int i = 1; i <= n; i ++) res = max(res, f[i]);
    cout << res << endl; 
    return 0;
}
```

### 2.4 æœ€çŸ­ç¼–è¾‘è·ç¦»

> **é¢˜ç›®**

ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² $A$ å’Œ $B$ï¼Œç°åœ¨è¦å°† $A$ ç»è¿‡è‹¥å¹²æ“ä½œå˜ä¸º $B$ï¼Œå¯è¿›è¡Œçš„æ“ä½œæœ‰ï¼š

1. åˆ é™¤â€“å°†å­—ç¬¦ä¸² $A$ ä¸­çš„æŸä¸ªå­—ç¬¦åˆ é™¤ã€‚
2. æ’å…¥â€“åœ¨å­—ç¬¦ä¸² $A$ çš„æŸä¸ªä½ç½®æ’å…¥æŸä¸ªå­—ç¬¦ã€‚
3. æ›¿æ¢â€“å°†å­—ç¬¦ä¸² $A$ ä¸­çš„æŸä¸ªå­—ç¬¦æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ã€‚

ç°åœ¨è¯·ä½ æ±‚å‡ºï¼Œå°† $A$ å˜ä¸º $B$ è‡³å°‘éœ€è¦è¿›è¡Œå¤šå°‘æ¬¡æ“ä½œã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $A$ çš„é•¿åº¦ã€‚

ç¬¬äºŒè¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸² $A$ã€‚

ç¬¬ä¸‰è¡ŒåŒ…å«æ•´æ•° $m$ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² $B$ çš„é•¿åº¦ã€‚

ç¬¬å››è¡ŒåŒ…å«ä¸€ä¸ªé•¿åº¦ä¸º $m$ çš„å­—ç¬¦ä¸² $B$ã€‚

å­—ç¬¦ä¸²ä¸­å‡åªåŒ…å«å¤§å°å†™å­—æ¯ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°‘æ“ä½œæ¬¡æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤n,mâ‰¤1000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
10
AGTCTGACGC
11
AGTAAGTAGGC
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
4
```

> **è§£æ**

**$f[i][j]$ è¡¨ç¤ºæ‰€æœ‰æŠŠ $a$ ä¸­çš„å‰ $i$ ä¸ªå­—æ¯ å˜æˆ $b$ ä¸­å‰ $j$ ä¸ªå­—æ¯çš„æœ€å°æ“ä½œæ¬¡æ•°**

- **åˆ é™¤**æ“ä½œï¼š`f[i][j] = f[i-1][j] + 1`ï¼Œåˆ é™¤ $a$ çš„ç¬¬ $i$ ä½ï¼ˆå½“å‰æœ€åä¸€ä½ï¼‰å­—æ¯ $a[i]$ ï¼Œ$a[1 \sim i]$  å˜ä¸º $a[1 \sim i-1]$
- **å¢åŠ **æ“ä½œï¼š`f[i][j] = f[i][j-1] + 1`ï¼Œåœ¨ $a$ çš„æœ€åå†æ·»åŠ ä¸€ä½ $b[j]$ ï¼Œ$a[1 \sim i]$  å˜ä¸º $a[1 \sim i+1]$
- **æ›¿æ¢**æ“ä½œï¼š
  - è‹¥ $a[i]$ ä¸ $b[j]$ ç›¸ç­‰ï¼š`f[i][j] = f[i-1][j-1]`ï¼Œæ— éœ€æ›¿æ¢
  - è‹¥ $a[i]$ ä¸ $b[j]$ ä¸ç›¸ç­‰ï¼š`f[i][j] = f[i-1][j-1] + 1`ï¼Œå¤šä¸€æ¬¡æ›¿æ¢æ“ä½œ

éå†ä¸Šè¿°ä¸‰ç§æ“ä½œï¼Œæ‰¾å‡º $min(f[i][j])$ ã€‚å¹¶ä¸”ï¼Œæ¯æ¬¡æ“ä½œåªå…³å¿ƒæœ€åä¸€ä½ï¼Œå› ä¸ºä¹‹å‰çš„éƒ¨åˆ†éƒ½å·²ç»è§„åˆ’å¥½äº†

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 1010;
int n, m;
char a[N], b[N];
int f[N][N]; // f[i][j] è¡¨ç¤ºæ‰€æœ‰æŠŠ a ä¸­çš„å‰ i ä¸ªå­—æ¯ å˜æˆ b ä¸­å‰ j ä¸ªå­—æ¯çš„æœ€å°æ“ä½œæ¬¡æ•°
int main()
{
    cin >> n >> a + 1;
    cin >> m >> b + 1;
    for (int i = 0; i <= m; i ++) f[0][i] = i; //è¾¹ç•Œï¼Œa å­—ç¬¦ä¸²çš„å‰ i ä¸ªå­—ç¬¦å˜ä¸º b å­—ç¬¦ä¸²çš„å‰ 0 ä¸ªå­—ç¬¦ï¼Œéœ€è¦ i æ­¥
    for (int i = 0; i <= n; i ++) f[i][0] = i; //è¾¹ç•Œï¼Œa å­—ç¬¦ä¸²çš„å‰ 0 ä¸ªå­—ç¬¦å˜ä¸º b å­—ç¬¦ä¸²çš„å‰ i ä¸ªå­—ç¬¦ï¼Œéœ€è¦ i æ­¥
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++)
        {
            f[i][j] = min(f[i - 1][j] + 1, f[i][j - 1] + 1); // åˆ é™¤ å’Œ å¢åŠ  æ“ä½œ 
            if (a[i] == b[j]) // æ›¿æ¢æ“ä½œ 
			{
				f[i][j] = min(f[i][j], f[i - 1][j - 1]); // æœ€åä¸€ä½ç›¸ç­‰ï¼Œæ— éœ€æ›¿æ¢ 
			}
            else f[i][j] = min(f[i][j], f[i - 1][j - 1] + 1); // æœ€åä¸€ä½ä¸ç›¸ç­‰ï¼Œéœ€è¦æ›¿æ¢ 
        }
	}
    cout << f[n][m] << endl; // f[n][m] è¡¨ç¤ºå­—ç¬¦ä¸² a å˜ä¸ºå­—ç¬¦ä¸² b éœ€è¦çš„æœ€å°‘æ­¥éª¤
    return 0;
}
```

## 3. åŒºé—´DP

### 3.1 çŸ³å­åˆå¹¶

> **é¢˜ç›®**

è®¾æœ‰ $N$ å †çŸ³å­æ’æˆä¸€æ’ï¼Œå…¶ç¼–å·ä¸º $1,2,3,â€¦,N$ã€‚

æ¯å †çŸ³å­æœ‰ä¸€å®šçš„è´¨é‡ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ•´æ•°æ¥æè¿°ï¼Œç°åœ¨è¦å°†è¿™ $N$ å †çŸ³å­åˆå¹¶æˆä¸ºä¸€å †ã€‚

æ¯æ¬¡åªèƒ½åˆå¹¶ç›¸é‚»çš„ä¸¤å †ï¼Œåˆå¹¶çš„ä»£ä»·ä¸ºè¿™ä¸¤å †çŸ³å­çš„è´¨é‡ä¹‹å’Œï¼Œåˆå¹¶åä¸è¿™ä¸¤å †çŸ³å­ç›¸é‚»çš„çŸ³å­å°†å’Œæ–°å †ç›¸é‚»ï¼Œåˆå¹¶æ—¶ç”±äºé€‰æ‹©çš„é¡ºåºä¸åŒï¼Œåˆå¹¶çš„æ€»ä»£ä»·ä¹Ÿä¸ç›¸åŒã€‚

ä¾‹å¦‚æœ‰ $4$ å †çŸ³å­åˆ†åˆ«ä¸º `1 3 5 2`ï¼Œ æˆ‘ä»¬å¯ä»¥å…ˆåˆå¹¶ $1ã€2$ å †ï¼Œä»£ä»·ä¸º $4$ï¼Œå¾—åˆ° `4 5 2`ï¼Œ åˆåˆå¹¶ $1ã€2$ å †ï¼Œä»£ä»·ä¸º $9$ï¼Œå¾—åˆ° `9 2` ï¼Œå†åˆå¹¶å¾—åˆ° $11$ï¼Œæ€»ä»£ä»·ä¸º $4+9+11=24$ï¼›

å¦‚æœç¬¬äºŒæ­¥æ˜¯å…ˆåˆå¹¶ $2ã€3$ å †ï¼Œåˆ™ä»£ä»·ä¸º $7$ï¼Œå¾—åˆ° `4 7`ï¼Œæœ€åä¸€æ¬¡åˆå¹¶ä»£ä»·ä¸º $11$ï¼Œæ€»ä»£ä»·ä¸º $4+7+11=22$ã€‚

é—®é¢˜æ˜¯ï¼šæ‰¾å‡ºä¸€ç§åˆç†çš„æ–¹æ³•ï¼Œä½¿æ€»çš„ä»£ä»·æœ€å°ï¼Œè¾“å‡ºæœ€å°ä»£ä»·ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸€ä¸ªæ•° $N$ è¡¨ç¤ºçŸ³å­çš„å †æ•° $N$ã€‚

ç¬¬äºŒè¡Œ $N$ ä¸ªæ•°ï¼Œè¡¨ç¤ºæ¯å †çŸ³å­çš„è´¨é‡(å‡ä¸è¶…è¿‡ $1000$)ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°ä»£ä»·ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤300$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4
1 3 5 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
22
```

> **è§£æ**

è¿™é¢˜æ€è·¯ä¸ã€Šç®—æ³•è®¾è®¡ä¸åˆ†æã€‹ä¸­çŸ©é˜µé“¾ä¹˜æ³•ç±»ä¼¼ã€‚

è¾“å…¥ $n$ å †çŸ³å­ï¼ŒçŸ³å­é‡é‡ä¸º $s[1]$ åˆ° $s[n]$

ç„¶å $s[i] += s[i - 1]$ ï¼Œå°† $s[i]$ å˜ä¸ºè‡ªå·±çš„å‰ç¼€å’Œæ•°ç»„ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨

**çŠ¶æ€è¡¨ç¤º**ï¼š $f[i][j]$ è¡¨ç¤ºå°† $i$ åˆ° $j$ è¿™ä¸€æ®µçŸ³å­åˆå¹¶æˆä¸€å †çš„æœ€å°ä»£ä»·ï¼Œå±æ€§ä¸º $min$

**çŠ¶æ€è®¡ç®—**ï¼š

- å½“ $i < j$ æ—¶

  $f[i][j] = \min_{i \leq k \leq j-1} \{ f[i][k] + f[k+1][j] + s[j] - s[i-1] \}$ 

- å½“ $i = j$ æ—¶ 

  $f[i][i] = 0$  ï¼ˆåˆå¹¶ä¸€å †çŸ³å­ä»£ä»·ä¸º $0$ï¼‰

ç»“æœä¸º $f[1][n]$ ï¼Œè¡¨ç¤ºç¬¬ $1$ åˆ° $n$ è¿™æ®µçŸ³å­åˆå¹¶æˆä¸€å †çš„æœ€å°ä»£ä»·

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 310;
int n;
int s[N]; // å‰ç¼€å’Œæ•°ç»„ 
int f[N][N];
int main()
{
    cin >> n;
    for (int i = 1; i <= n; i ++) cin >> s[i];
    for (int i = 1; i <= n; i ++) s[i] += s[i - 1]; // s[i] å˜ä¸ºè‡ªå·±çš„å‰ç¼€å’Œæ•°ç»„ 
    for (int len = 2; len <= n; len ++) // åŒºé—´é•¿åº¦ä¸º len ã€‚å› ä¸ºé•¿çš„åŒºé—´éœ€è¦ç”¨åˆ°çŸ­åŒºé—´çš„å€¼ï¼Œæ‰€ä»¥åŒºé—´ç”±çŸ­åˆ°é•¿è¿›è¡Œéå†ï¼ˆåŒçŸ©é˜µé“¾ä¹˜æ³•ï¼‰ 
        for (int i = 1; i + len - 1 <= n; i ++)
        {
            int l = i, r = i + len - 1; // l ä¸ºåŒºé—´å·¦ç«¯ç‚¹ï¼Œr ä¸ºåŒºé—´å³ç«¯ç‚¹ 
            f[l][r] = 1e8; // å…ˆç½® f[l][r] ä¸ºä¸€ä¸ªæå¤§å€¼ 
            for (int k = l; k < r; k ++)
                f[l][r] = min(f[l][r], f[l][k] + f[k + 1][r] + s[r] - s[l - 1]); // çŠ¶æ€è½¬ç§»æ–¹ç¨‹ 
        }
    cout << f[1][n] << endl;
    return 0;
}
```

### 3.2 ç¯å½¢çŸ³å­åˆå¹¶

> **é¢˜ç›®**

å°† $n$ å †çŸ³å­ç»•åœ†å½¢æ“åœºæ’æ”¾ï¼Œç°è¦å°†çŸ³å­æœ‰åºåœ°åˆå¹¶æˆä¸€å †ã€‚

è§„å®šæ¯æ¬¡åªèƒ½é€‰ç›¸é‚»çš„ä¸¤å †åˆå¹¶æˆæ–°çš„ä¸€å †ï¼Œå¹¶å°†æ–°çš„ä¸€å †çš„çŸ³å­æ•°è®°åšè¯¥æ¬¡åˆå¹¶çš„å¾—åˆ†ã€‚

è¯·ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å…¥å †æ•° $n$ åŠæ¯å †çš„çŸ³å­æ•°ï¼Œå¹¶è¿›è¡Œå¦‚ä¸‹è®¡ç®—ï¼š

- é€‰æ‹©ä¸€ç§åˆå¹¶çŸ³å­çš„æ–¹æ¡ˆï¼Œä½¿å¾—åš $nâˆ’1$ æ¬¡åˆå¹¶å¾—åˆ†æ€»å’Œæœ€å¤§ã€‚
- é€‰æ‹©ä¸€ç§åˆå¹¶çŸ³å­çš„æ–¹æ¡ˆï¼Œä½¿å¾—åš $nâˆ’1$ æ¬¡åˆå¹¶å¾—åˆ†æ€»å’Œæœ€å°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $n$ï¼Œè¡¨ç¤ºå…±æœ‰ $n$ å †çŸ³å­ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºæ¯å †çŸ³å­çš„æ•°é‡ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºå…±ä¸¤è¡Œï¼š

ç¬¬ä¸€è¡Œä¸ºåˆå¹¶å¾—åˆ†æ€»å’Œæœ€å°å€¼ï¼Œ

ç¬¬äºŒè¡Œä¸ºåˆå¹¶å¾—åˆ†æ€»å’Œæœ€å¤§å€¼ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤200$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4
4 5 9 4
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
43
54
```

> **è§£æ**

æ€è·¯åŒä¸Šé¢˜ï¼Œæ±‚æœ€å¤§å¾—åˆ†æ—¶å°† $min$ æ¢æˆ $max$ å³å¯ã€‚å…³é”®åœ¨äº**ç ´ç¯æˆé“¾**

å‡è®¾è¾“å…¥çŸ³å­æ˜¯ `1 4 2 5 3` åˆ™ç ´ç¯æˆé“¾åï¼Œå¾—åˆ°ä¸¤å€çš„åŸåºåˆ—ï¼Œå³ `1 4 2 5 3 1 4 2 5 3` ã€‚ä¾æ¬¡è®¡ç®—æ¯ä¸ªåŒºé—´çš„ $f[i][j]$ ï¼Œæ‰¾å‡ºé•¿åº¦ä¸º $n$ çš„åŒºé—´çš„ $f$ æœ€å¤§å€¼ã€‚çŠ¶æ€è½¬ç§»æ–¹ç¨‹åŒä¸Šã€‚

ç»“æœä¸º $min(f[i][i+n-1]),iâˆˆ[1,n]$ å’Œ $max(f[i][i+n-1]),iâˆˆ[1,n]$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 410, INF = 0x3f3f3f3f;
int n;
int s[N];
int f[N][N], g[N][N];
int main()
{
    cin >> n;
    for (int i = 1; i <= n; i ++)
    {
        cin >> s[i];
        s[i + n] = s[i]; // ç ´ç¯æˆé“¾ï¼ŒæŠŠé“¾å»¶é•¿ä¸¤å€ï¼Œå¾—åˆ°è¯¸å¦‚ 1ã€2ã€3ã€4ã€1ã€2ã€3ã€4 è¿™æ ·çš„é“¾ 
    }
    for (int i = 1; i <= n * 2; i ++) s[i] += s[i - 1]; // s[i] å˜ä¸ºè‡ªå·±çš„å‰ç¼€å’Œæ•°ç»„
    for (int len = 2; len <= n; len ++) // æ€è·¯åŒä¸Šé¢˜ï¼Œåªæ˜¯é“¾é•¿åº¦ç”± n å˜æˆäº† 2n 
        for (int i = 1; i + len - 1 <= n * 2; i ++)
        {
            int l = i, r = i + len - 1;
            f[l][r] = 1e8, g[l][r] = -1e8;
            for (int k = l; k < r; k ++)
            {
                f[l][r] = min(f[l][r], f[l][k] + f[k + 1][r] + s[r] - s[l - 1]);
                g[l][r] = max(g[l][r], g[l][k] + g[k + 1][r] + s[r] - s[l - 1]);
            }
        }
    int minv = INF, maxv = -INF;
    for (int i = 1; i <= n; i ++) // éå†æ¯ä¸ªé•¿åº¦ä¸º n çš„åŒºé—´ï¼Œæ‰¾å‡ºæœ€å¤§æœ€å°å€¼ 
    {
        minv = min(minv, f[i][i + n - 1]);
        maxv = max(maxv, g[i][i + n - 1]);
    }
    cout << minv << endl << maxv << endl;
    return 0;
}
```

## 4. è®¡æ•°ç±»DP

### 4.1 æ•´æ•°åˆ’åˆ†

> **é¢˜ç›®**

ä¸€ä¸ªæ­£æ•´æ•° $n$ å¯ä»¥è¡¨ç¤ºæˆè‹¥å¹²ä¸ªæ­£æ•´æ•°ä¹‹å’Œï¼Œå½¢å¦‚ï¼š$n=n_1+n_2+â€¦+n_k$ï¼Œå…¶ä¸­ $n_1â‰¥n_2â‰¥â€¦â‰¥n_k,kâ‰¥1$ã€‚

æˆ‘ä»¬å°†è¿™æ ·çš„ä¸€ç§è¡¨ç¤ºç§°ä¸ºæ­£æ•´æ•° $n$ çš„ä¸€ç§åˆ’åˆ†ã€‚

ç°åœ¨ç»™å®šä¸€ä¸ªæ­£æ•´æ•° $n$ï¼Œè¯·ä½ æ±‚å‡º $n$ å…±æœ‰å¤šå°‘ç§ä¸åŒçš„åˆ’åˆ†æ–¹æ³•ã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $n$ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ€»åˆ’åˆ†æ•°é‡ã€‚

ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¾“å‡ºç»“æœè¯·å¯¹ $10^9+7$ å–æ¨¡ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤1000$

**è¾“å…¥æ ·ä¾‹:**

```
5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
7
```

> **è§£æ**

é—®é¢˜ç›¸å½“äºä¸€ä¸ª**å®Œå…¨èƒŒåŒ…**é—®é¢˜ã€‚å› ä¸ºè¦æŠŠæ­£æ•´æ•° $n$ æ‹†æˆè‹¥å¹²ä¸ªæ­£æ•´æ•°çš„å’Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠ $1,2,3, â€¦ n$ åˆ†åˆ«çœ‹åš $n$ ä¸ªç‰©ä½“çš„ä½“ç§¯ï¼Œè¿™ $n$ ä¸ªç‰©ä½“å‡æ— ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼Œé—®æ°å¥½èƒ½è£…æ»¡æ€»ä½“ç§¯ä¸º $n$ çš„èƒŒåŒ…çš„æ€»æ–¹æ¡ˆæ•°ã€‚

**çŠ¶æ€è¡¨ç¤º**ï¼š $f[i][j]$ è¡¨ç¤ºåªä» $1 \sim i$ ä¸­é€‰ï¼Œä¸”æ€»å’Œç­‰äº $j$ çš„æ–¹æ¡ˆæ•°

**çŠ¶æ€è®¡ç®—**ï¼š$f[i][j] = f[i-1][j]+f[i][j-i]$

è¯æ˜å¦‚ä¸‹ï¼š
$$
f[i][j] = f[i-1][j]+f[i - 1][j - i]+f[i - 1][j - 2i]+â€¦â€¦ \qquad (1)å¼ \\
å…¶ä¸­ï¼Œå³ä¾§ç¬¬ä¸€é¡¹è¡¨ç¤ºæ–¹æ¡ˆé€‰0ä¸ªi,ç¬¬äºŒé¡¹è¡¨ç¤ºæ–¹æ¡ˆé€‰1ä¸ªi,ç¬¬ä¸‰é¡¹è¡¨ç¤ºæ–¹æ¡ˆé€‰2ä¸ªi,ä»¥æ­¤ç±»æ¨ \\
ä»¤ j=j-i,ä»£å…¥(1)å¼,å¾—: \\
f[i][j-i] = f[i-1][j-i]+f[i-1][j-2i]+f[i-1][j-3i]+â€¦â€¦ \qquad (2)å¼\\
ä»¤(2)å¼=u \\
å³ \quad f[i-1][j-i]+f[i-1][j-2i]+f[i-1][j-3i]+â€¦â€¦=u, \\
åˆ™(1)å¼å³éƒ¨ä¸­ \quad f[i - 1][j - i]+f[i - 1][j - 2i]+â€¦â€¦=u \qquad (3)å¼ \\
åˆå› ä¸º: \quad f[i][j-i]ä¹Ÿç­‰äºu \\
æ‰€ä»¥ï¼š\quad (3)å¼=u=f[i][j-i] \\
ä»£å›(1)å¼ä¸­, \quad f[i][j] = f[i-1][j]+f[i][j-i] \quad å¾—è¯\#
$$
æ³¨æ„ï¼Œ æ‰€æœ‰çš„ $f[i][0]$ éƒ½ä¸º $1$ ã€‚æ¯”å¦‚ $f[1][1]=f[0][1]+f[1][0]=0+f[1][0]=1$

> **ä»£ç æ¨¡æ¿**

**æœ´ç´ åšæ³• (äºŒç»´)ï¼š**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 1010, mod = 1e9 + 7;
int n;
int f[N][N];
int main()
{
    cin >> n;
    for(int i = 0; i <= n; i ++)
    {
    	f[i][0] = 1; // å¯¹åº” f[i][0] ï¼Œå®¹é‡ä¸º 0 æ—¶ï¼Œå‰ i ä¸ªç‰©å“å…¨ä¸é€‰ä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆã€‚
	}
    for (int i = 1; i <= n; i ++)
        for (int j = 0; j <= n; j ++)
        {
        	f[i][j] = f[i - 1][j];
        	if(j >= i) f[i][j] = (f[i - 1][j] + f[i][j - i]) % mod;
		}
    cout << f[n][n] << endl;
    return 0;
}
```

**ç©ºé—´ä¼˜åŒ– (ä¸€ç»´)ï¼š**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 1010, mod = 1e9 + 7;
int n;
int f[N];
int main()
{
    cin >> n;
    f[0] = 1; // å¯¹åº” f[i][0] ï¼Œå®¹é‡ä¸º 0 æ—¶ï¼Œå‰ i ä¸ªç‰©å“å…¨ä¸é€‰ä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆã€‚ 
    for (int i = 1; i <= n; i ++)
        for (int j = i; j <= n; j ++)
            f[j] = (f[j] + f[j - i]) % mod;
    cout << f[n] << endl;
    return 0;
}
```

## 5. çŠ¶æ€å‹ç¼©DP

### 5.1 è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³

> **é¢˜ç›®**

æ±‚æŠŠ $NÃ—M$ çš„æ£‹ç›˜åˆ†å‰²æˆè‹¥å¹²ä¸ª $1Ã—2$ çš„é•¿æ–¹å½¢ï¼Œæœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚

ä¾‹å¦‚å½“ $N=2,M=4$ æ—¶ï¼Œå…±æœ‰ $5$ ç§æ–¹æ¡ˆã€‚å½“ $N=2,M=3$ æ—¶ï¼Œå…±æœ‰ $3$ ç§æ–¹æ¡ˆã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![mondrian](./figs/mondrian)

**è¾“å…¥æ ¼å¼**

è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚

æ¯ç»„æµ‹è¯•ç”¨ä¾‹å ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $N$ å’Œ $M$ ã€‚

å½“è¾“å…¥ç”¨ä¾‹ $N=0,M=0$ æ—¶ï¼Œè¡¨ç¤ºè¾“å…¥ç»ˆæ­¢ï¼Œä¸”è¯¥ç”¨ä¾‹æ— éœ€å¤„ç†ã€‚

**è¾“å‡ºæ ¼å¼**

æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è¾“å‡ºä¸€ä¸ªç»“æœï¼Œæ¯ä¸ªç»“æœå ä¸€è¡Œã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤N,Mâ‰¤11$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
1 2
1 3
1 4
2 2
2 3
2 4
2 11
4 11
0 0
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
1
0
1
2
3
5
144
51205
```

> **è§£æ**

**æ ¸å¿ƒ**ï¼šå…ˆæ”¾æ¨ªç€çš„é•¿æ–¹å½¢ï¼Œå†æ”¾ç«–ç€çš„é•¿æ–¹å½¢ã€‚**æ€»æ–¹æ¡ˆæ•°å°±ç­‰äºåªæ”¾æ¨ªç€çš„é•¿æ–¹å½¢çš„åˆæ³•æ–¹æ¡ˆæ•°**

**çŠ¶æ€è¡¨ç¤º** $f[i][j]$ ï¼š**å‰ $i - 1$ åˆ—å·²ç»æ‘†å¥½ï¼Œä¸”ä»ç¬¬ $i - 1$ åˆ—ä¼¸å‡ºåˆ°ç¬¬ $i$ åˆ—çš„é•¿æ–¹å½¢ï¼Œå…¶æ„æˆçš„çŠ¶æ€ä¸º $j$ æ—¶çš„æ–¹æ¡ˆæ•°**ï¼ˆ $j$ ä¸ºäºŒè¿›åˆ¶æ•°ï¼Œè¡¨ç¤ºæ£‹ç›˜ç¬¬ $i$ åˆ—ä»ä¸Šåˆ°ä¸‹å“ªäº›æ ¼å­è¢«é•¿æ–¹å½¢è¦†ç›–ï¼‰

**çŠ¶æ€è½¬ç§»**ï¼š$f[i][j] += f[i - 1][k]$ï¼Œ $k$ æ»¡è¶³ `(j & k) == 0 && st[j | k] == true`

**åˆ¤æ–­åˆæ³•çš„æ¡ä»¶**ï¼š

éå†æ¯ä¸€åˆ—ï¼Œç¬¬ $i$ åˆ—çš„æ–¹æ¡ˆæ•°åªå’Œç¬¬ $i - 1$ åˆ—æœ‰å…³ç³»ã€‚å‡è®¾ç¬¬ $i$ åˆ—çš„çŠ¶æ€ä¸º $j$ ï¼Œç¬¬ $i - 1$ åˆ—çš„çŠ¶æ€ä¸º $k$ ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½åˆæ³•ï¼š

1. **åŒä¸€æ ¼å­ä¸èƒ½é‡å¤å ç”¨**ï¼šäºŒè¿›åˆ¶æ•° `j & k == 0` ï¼Œ $i - 2$ åˆ—ä¼¸åˆ° $i - 1$ çš„é•¿æ–¹å½¢ï¼Œå’Œ $i - 1$ åˆ—ä¼¸åˆ° $i$ åˆ—çš„é•¿æ–¹å½¢ä¸é‡å¤ã€‚å³ç¬¬ $i - 1$ åˆ—çš„ä»»ä¸€æ ¼å­ä¸èƒ½è¢«é‡å¤å æœ‰
2. **æ¯ä¸€åˆ—è¿ç»­ç©ºç€çš„æ–¹æ ¼æ•°é‡ä¸å¯ä»¥æ˜¯å¥‡æ•°**ï¼šå¯¹äºæ¯ä¸€åˆ—ï¼Œæ‰€æœ‰è¿ç»­çš„ç©ºç€çš„å°æ–¹æ ¼å¿…é¡»æ˜¯å¶æ•°ä¸ªï¼Œä¸å¯ä»¥æ˜¯å¥‡æ•°ä¸ªï¼Œä¸ç„¶åç»­æ— æ³•è¢«ç«–ç€çš„é•¿æ–¹å½¢å¡«å……ã€‚å³ `st[j | k]`

**è¾“å‡ºç»“æœ**ï¼š

æœ€ç»ˆç»“æœä¸º $f[m][0]$ ï¼Œè¡¨ç¤ºå‰ $m - 1$ åˆ—å·²ç»æ‘†å¥½ï¼Œä¸”ç¬¬ $m$ åˆ—æ²¡æœ‰ä»»ä½•å»¶ä¼¸çš„æ–¹æ¡ˆæ•°ï¼ˆå› ä¸ºåªæœ‰ $m - 1$ åˆ—ï¼Œä¸‹æ ‡ä¸º $[0, m - 1]$ ï¼‰

<img src="./figs/state_compression_dp" style="zoom:150%;" />

ä¸Šå›¾è¡¨ç¤ºçš„å³ä¸ºè¾“å…¥ä¸º $N = 6, M = 6$ æ—¶ï¼Œ $f[2][(010010)_2]$ çš„çŠ¶æ€ï¼ˆçº¢è‰²ä¸ºç«–ç€çš„é•¿æ–¹å½¢ï¼Œç»¿è‰²ä¸ºæ¨ªç€çš„é•¿æ–¹å½¢ï¼‰ã€‚$f[2][010010]$ è¡¨ç¤ºå‰ $1$ åˆ—ï¼ˆç¬¬ $0$ åˆ—å’Œç¬¬ $1$ åˆ—ï¼‰å·²ç»æ‘†å¥½ï¼Œä¸”ä»ç¬¬ $1$ åˆ—ä¼¸å‡ºåˆ°ç¬¬ $2$ åˆ—çš„é•¿æ–¹å½¢æ„æˆçš„çŠ¶æ€ä¸º $010010$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚äºŒè¿›åˆ¶æ•° $010010$ ä¸­çš„ $0$ è¡¨ç¤ºæ²¡æœ‰è¦†ç›–ï¼Œ $1$ è¡¨ç¤ºè¢«è¦†ç›–


> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 12, M = 1 << N;
int n, m;
ll f[N][M];
vector<vector<int>> state(M); // è®°å½•åˆæ³•çš„çŠ¶æ€å¯¹
bool st[M]; // st æ•°ç»„ä¿å­˜çŠ¶æ€ i æ˜¯å¦æœ‰å¥‡æ•°ä¸ªè¿ç»­çš„ 0 çš„æƒ…å†µ 
int main()
{
    while (cin >> n >> m, n || m) // n å’Œ m åŒæ—¶ä¸º 0 æ—¶è¾“å…¥ç»ˆæ­¢ 
    {
    	/* 
		   ç¬¬ä¸€éƒ¨åˆ†ï¼šé¢„å¤„ç†_1
	       å¯¹äºæ¯ä¸ªçŠ¶æ€ï¼Œå…ˆé¢„å¤„ç†ä¿è¯æ¯åˆ—ä¸èƒ½æœ‰å¥‡æ•°ä¸ªè¿ç»­çš„ 0 ï¼Œå³ä¿è¯åˆæ³• 
		*/
        for (int i = 0; i < 1 << n; i ++) // äºŒè¿›åˆ¶æšä¸¾ 0 ~ (2 ^ n) - 1 
        {
            int cnt = 0; // è®°å½•è¿ç»­çš„ 0 çš„ä¸ªæ•° 
            bool is_valid = true; // å‡å®šå½“å‰åˆæ³• 
            for (int j = 0; j < n; j ++)
            {
                if (i >> j & 1)
                {
                    if (cnt & 1) // å­˜åœ¨å¥‡æ•°ä¸ªè¿ç»­çš„ 0
                    {
                        is_valid = false;
                        break;
                    }
                    cnt = 0;
                }
                else cnt ++;	
			}
            if (cnt & 1) is_valid = false; // æœ€åå†åˆ¤æ–­ä¸€æ¬¡ï¼Œé˜²æ­¢ 000111 è¿™ç§æƒ…å†µçš„å‡ºç° 
            st[i] = is_valid; // st æ•°ç»„ä¿å­˜çŠ¶æ€ i æ˜¯å¦æœ‰å¥‡æ•°ä¸ªè¿ç»­çš„ 0 çš„æƒ…å†µ
        }
    	/* 
		   ç¬¬äºŒéƒ¨åˆ†ï¼šé¢„å¤„ç†_2
	       ç»§ç»­åˆ¤æ–­ç¬¬ i - 2 åˆ—ä¼¸å‡ºæ¥çš„å’Œç¬¬ i - 1 åˆ—ï¼ˆç›¸é‚»ä¸¤åˆ—ï¼‰ä¼¸å‡ºæ¥çš„æ˜¯å¦å†²çª 
		*/
        for (int i = 0; i < 1 << n; i ++) // äºŒè¿›åˆ¶æšä¸¾ 0 ~ (2 ^ n) - 1 
        {
            state[i].clear();
            for (int j = 0; j < 1 << n; j ++)
            {
                if ((i & j) == 0 && st[i | j]) state[i].push_back(j); // ç›¸é‚»ä¸¤åˆ—çš„çŠ¶æ€å¯ä»¥ä¸€ä¸ªå– i ï¼Œä¸€ä¸ªå– j 
			}
        }
    	/* 
		   ç¬¬ä¸‰éƒ¨åˆ†ï¼šåŠ¨æ€è§„åˆ’
		*/
        memset(f, 0, sizeof(f));
        f[0][0] = 1; // æ ¹æ®å®šä¹‰ï¼Œ f[0][0] è¡¨ç¤ºæ²¡æœ‰ä¼¸å‡ºæ¥çš„ï¼Œå³å…¨æ˜¯ç«–ç€æ‘†çš„ï¼Œåªæœ‰ 1 ç§ 
        for (int i = 1; i <= m; i ++)
        {
            for (int j = 0; j < 1 << n; j ++)
            {
                for (auto k : state[j])
                    f[i][j] += f[i - 1][k]; // çŠ¶æ€è½¬ç§»æ–¹ç¨‹ 
			}
		}
        cout << f[m][0] << endl;
    }
    return 0;
}
```

### 5.2 æœ€çŸ­Hamiltonè·¯å¾„

> **é¢˜ç›®**

ç»™å®šä¸€å¼  $n$ ä¸ªç‚¹çš„å¸¦æƒæ— å‘å›¾ï¼Œç‚¹ä» $0âˆ¼nâˆ’1$ æ ‡å·ï¼Œæ±‚èµ·ç‚¹ $0$ åˆ°ç»ˆç‚¹ $nâˆ’1$ çš„æœ€çŸ­ $Hamilton$ è·¯å¾„ã€‚

$Hamilton$ è·¯å¾„çš„å®šä¹‰æ˜¯ä» $0$ åˆ° $nâˆ’1$ ä¸é‡ä¸æ¼åœ°ç»è¿‡æ¯ä¸ªç‚¹æ°å¥½ä¸€æ¬¡ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $n$ã€‚

æ¥ä¸‹æ¥ $n$ è¡Œæ¯è¡Œ $n$ ä¸ªæ•´æ•°ï¼Œå…¶ä¸­ç¬¬ $i$ è¡Œç¬¬ $j$ ä¸ªæ•´æ•°è¡¨ç¤ºç‚¹ $i$ åˆ° $j$ çš„è·ç¦»ï¼ˆè®°ä¸º $a[i,j]$ï¼‰ã€‚

å¯¹äºä»»æ„çš„ $x,y,z$ï¼Œæ•°æ®ä¿è¯ $a[x,x]=0,a[x,y]=a[y,x]$ å¹¶ä¸” $a[x,y]+a[y,z]â‰¥a[x,z]$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€çŸ­ $Hamilton$ è·¯å¾„çš„é•¿åº¦ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤20$
$0â‰¤a[i,j]â‰¤10^7$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5
0 2 4 5 1
2 0 6 5 3
4 6 0 8 3
5 5 8 0 5
1 3 3 5 0
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
18
```

> **è§£æ**

**çŠ¶æ€è¡¨ç¤º** $f[state][j]$ ï¼šè¡¨ç¤ºç»è¿‡çš„ç‚¹é›†ä¸º $state$ ï¼Œä¸”å½“å‰åˆ°è¾¾ç‚¹ $j$ çš„æ‰€æœ‰è·¯å¾„é•¿åº¦çš„æœ€å°å€¼

- é›†åˆï¼šç»è¿‡çš„ç‚¹é›†ä¸º $state$ ï¼Œä¸”å½“å‰åˆ°è¾¾ç‚¹ $j$ çš„æ‰€æœ‰è·¯å¾„ã€‚ $state$ æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼ŒèŒƒå›´ä» $ 000â€¦00$ åˆ° $111â€¦11$
- å±æ€§ï¼šè·¯å¾„é•¿åº¦çš„æœ€å°å€¼

**çŠ¶æ€è®¡ç®—**ï¼šå‡è®¾å½“å‰è¦ä»ç‚¹ $k$ è½¬ç§»åˆ° ç‚¹ $j$ï¼Œé‚£ä¹ˆæ ¹æ® $Hamilton$ è·¯å¾„çš„å®šä¹‰ï¼Œæ¯ä¸ªç‚¹åªèƒ½èµ°ä¸€æ¬¡ï¼Œèµ°åˆ°ç‚¹ $k$ çš„è·¯å¾„å°±ä¸èƒ½ç»è¿‡ç‚¹ $j$ ï¼Œæ‰€ä»¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š
$$
f[state][j] = min \{ f[state - (1 << j)][k] + w[k][j] \}
$$
å…¶ä¸­ $w[k][j]$ è¡¨ç¤ºä»ç‚¹ $k$ åˆ°ç‚¹ $j$ çš„è·ç¦»ã€‚$k, j \in [0, n - 1]$

**åˆ¤æ–­åˆæ³•çš„æ¡ä»¶**ï¼š

1. å½“å‰çŠ¶æ€ $state$ å†…å¿…é¡»åŒ…å«ç‚¹ $j$ ï¼š`(state >> j) & 1 == true`
2. å½“å‰çŠ¶æ€ $state$ å†…ä¹Ÿå¿…é¡»åŒ…å«ç‚¹ $k$ ï¼š`(state >> k) & 1 == true`

**è¾“å‡ºç»“æœ**ï¼š

è¾“å‡ºç»“æœä¸º $f[(1 << n) - 1][n - 1]$ ï¼Œå³ä¸º $f[111â€¦11][n - 1]$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 20, M = 1 << N;
int n;
int w[N][N]; // w[i][j] è¡¨ç¤ºç‚¹ i å’Œç‚¹ j ä¹‹é—´çš„è·ç¦» 
int f[M][N]; // ä¸Šè¿° f[state][j]
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++ )
        for (int j = 0; j < n; j ++ )
            cin >> w[i][j];

    memset(f, 0x3f, sizeof(f)); //  // ç”±äºè¦æ±‚æœ€å°å€¼ï¼Œæ‰€ä»¥è¿™é‡Œå°† f åˆå§‹åŒ–ä¸ºæ­£æ— ç©·ä¼šæ›´å¥½å¤„ç†
    f[1][0] = 0; // ç‚¹ 0 çš„çŠ¶æ€ä¸º 000â€¦01 ï¼ŒåªåŒ…å«ç‚¹ 0 çš„è·¯å¾„é•¿åº¦ä¸º 0  
    for (int i = 0; i < 1 << n; i ++) // çŠ¶æ€ä» 000â€¦00 åˆ° 111â€¦11 æšä¸¾
    /*
	   å…¶å®è¿™é‡Œå¯ä»¥æ”¹æˆ for(int i = 1; i < 1 << n; i += 2) ï¼Œæˆ–è€…åŠ ä¸Š if(i & 1)
	   å› ä¸ºè·¯å¾„ä¸€å®šä»ç‚¹ 0 å¼€å§‹ï¼Œæ‰€ä»¥çŠ¶æ€ä¸­æœ€ä½ä½å¿…é¡»æ˜¯ 1 ï¼Œå³ xxxâ€¦x1 è¿™ç§å½¢å¼ 
	*/ 
        for (int j = 0; j < n; j ++) // æšä¸¾æ‰€æœ‰å½“å‰åˆ°è¾¾çš„ç‚¹ 
            if (i >> j & 1) // å½“å‰çŠ¶æ€ i å†…å¿…é¡»åŒ…å«ç‚¹ j æ‰åˆæ³• 
                for (int k = 0; k < n; k ++) // æšä¸¾ç‚¹ k ä½œä¸ºç‚¹ j çš„å‰ç½®èŠ‚ç‚¹ 
                    if (i >> k & 1) // å½“å‰çŠ¶æ€ i å†…ä¹Ÿå¿…é¡»åŒ…å«ç‚¹ k æ‰åˆæ³•
                        f[i][j] = min(f[i][j], f[i - (1 << j)][k] + w[k][j]); // çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œå³ç”±:ç‚¹ k -> ç‚¹ j 
    
	cout << f[(1 << n) - 1][n - 1]; // æœ€åè¾“å‡º f[111â€¦11][n - 1]
    return 0;
}
```

### 5.3 å°å›½ç‹

> **é¢˜ç›®**

åœ¨ $nÃ—n$ çš„æ£‹ç›˜ä¸Šæ”¾ $k$ ä¸ªå›½ç‹ï¼Œå›½ç‹å¯æ”»å‡»ç›¸é‚»çš„ $8$ ä¸ªæ ¼å­ï¼Œæ±‚ä½¿å®ƒä»¬æ— æ³•äº’ç›¸æ”»å‡»çš„æ–¹æ¡ˆæ€»æ•°ã€‚

**è¾“å…¥æ ¼å¼**

å…±ä¸€è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $k$ã€‚

**è¾“å‡ºæ ¼å¼**

å…±ä¸€è¡Œï¼Œè¡¨ç¤ºæ–¹æ¡ˆæ€»æ•°ï¼Œè‹¥ä¸èƒ½å¤Ÿæ”¾ç½®åˆ™è¾“å‡º $0$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10,$
$0â‰¤kâ‰¤n^2$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 2
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
16
```

> **è§£æ**

**çŠ¶æ€è¡¨ç¤º** $f[i][j][s]$ ï¼šè¡¨ç¤ºæ‰€æœ‰åªæ‘†åœ¨å‰ $i$ è¡Œï¼Œå·²ç»æ‘†äº† $j$ ä¸ªå›½ç‹ï¼Œå¹¶ä¸”ç¬¬ $i$ è¡Œæ‘†æ”¾çš„çŠ¶æ€æ˜¯ $s$ çš„æ‰€æœ‰æ–¹æ¡ˆæ•°é‡

- é›†åˆï¼šæ‰€æœ‰åªæ‘†åœ¨å‰ $i$ è¡Œï¼Œå·²ç»æ‘†äº† $j$ ä¸ªå›½ç‹ï¼Œå¹¶ä¸”ç¬¬ $i$ è¡Œæ‘†æ”¾çš„çŠ¶æ€æ˜¯ $s$ çš„æ‰€æœ‰æ–¹æ¡ˆï¼ˆ $s$ æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œå‡è®¾æ£‹ç›˜æœ‰ $n$ åˆ—ï¼Œ $s$  å°±æ˜¯ä¸€ä¸ª $n$  ä½çš„äºŒè¿›åˆ¶æ•°ï¼‰
- å±æ€§ï¼šæ•°é‡

**çŠ¶æ€è®¡ç®—**ï¼šå‡è®¾å·²ç»æ‘†å®Œäº†å‰ $i$ æ’ï¼Œå¹¶ä¸”ç¬¬ $i$ æ’çš„çŠ¶æ€æ˜¯ $a$ ï¼Œç¬¬ $i - 1$ æ’çš„çŠ¶æ€æ˜¯ $b$ ï¼Œå·²ç»æ‘†äº† $j$ ä¸ªå›½ç‹çš„æ‰€æœ‰æ–¹æ¡ˆæ•°é‡çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š
$$
f[i][j][a] = \sum_{b = 0}^{b çš„æ‰€æœ‰åˆæ³•çŠ¶æ€} f[i - 1][j - count(a)][b]
$$
**åˆ¤æ–­åˆæ³•çš„æ¡ä»¶**ï¼š

1. ç¬¬ $i - 1$ è¡Œå’Œç¬¬ $i$ è¡Œå†…éƒ¨éƒ½ä¸èƒ½æœ‰ä¸¤ä¸ª $1$ ç›¸é‚»
2. ç¬¬ $i - 1$ è¡Œå’Œç¬¬ $i$  è¡Œä¹‹é—´ä¹Ÿä¸èƒ½ç›¸äº’æ”»å‡»åˆ°ã€‚ä»£ç å®ç°æ€è·¯ï¼š
   - å‡è®¾ç¬¬ $i - 1$ è¡ŒçŠ¶æ€ä¸º $b$ ï¼Œç¬¬  $i$ è¡ŒçŠ¶æ€ä¸º $a$  ï¼Œéœ€è¦ä¿è¯ `(a & b) == 0` ä¸” `(a | b) ä¸èƒ½æœ‰ä¸¤ä¸ªç›¸é‚»çš„ 1`

**è¾“å‡ºç»“æœ**ï¼š

è¾“å‡ºç»“æœä¸º $f[n + 1][m][0]$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
typedef long long ll;
const int N = 12, M = 1 << 10, K = 110;
int n, m; // n ä¸ºæ£‹ç›˜è¾¹é•¿ï¼Œm ä¸ºå›½ç‹æ•°é‡ 
vector<int> state; // state ç”¨æ¥è¡¨ç¤ºæ‰€æœ‰çš„åˆæ³•çš„çŠ¶æ€
int cnt[M];
vector<int> head[M]; // äºŒç»´æ•°ç»„ï¼Œå¤„ç†äº’ç›¸åˆæ³•çš„ä¸¤ç§çŠ¶æ€ 
ll f[N][K][M];
bool check(int state) // æ£€æŸ¥ state å†…éƒ¨ä¸èƒ½æœ‰ä¸¤ä¸ª 1 ç›¸é‚» 
{
    for (int i = 0; i < n; i ++)
        if ((state >> i & 1) && (state >> i + 1 & 1))
            return false;
    return true;
}
int count(int state) // è®¡ç®—äºŒè¿›åˆ¶æ•° state ä¸­ 1 çš„æ•°é‡ 
{
    int res = 0;
    for (int i = 0; i < n; i ++)
		res += state >> i & 1;
    return res;
}
int main()
{
    cin >> n >> m;
	// é¢„å¤„ç† 
    for (int i = 0; i < 1 << n; i ++) // æšä¸¾ 0 ~ (2 ^ n) - 1 ä¹‹é—´çš„æ‰€æœ‰äºŒè¿›åˆ¶æ•°
	{
		if (check(i)) // æ£€æŸ¥æ˜¯å¦åˆæ³• 
        {
            state.push_back(i);
            cnt[i] = count(i);
        }
	} 
    for (int i = 0; i < state.size(); i ++)
    {
        for (int j = 0; j < state.size(); j ++)
        {
            int a = state[i], b = state[j];
            if ((a & b) == 0 && check(a | b))
                head[i].push_back(j); // å…³è”ä¸¤ç§äº’ç›¸åˆæ³•çš„çŠ¶æ€ 
        }
	}
	// å¼€å§‹ DP 
    f[0][0][0] = 1;
    for (int i = 1; i <= n + 1; i ++) // è¡Œæ•° 
        for (int j = 0; j <= m; j ++) // å·²æ‘†æ”¾çš„å›½ç‹æ•° 
            for (int a = 0; a < state.size(); a ++) // ç¬¬ i è¡Œçš„çŠ¶æ€ 
                for (int b : head[a]) // ç¬¬ i - 1 è¡Œçš„çŠ¶æ€ 
                {
                    int c = cnt[state[a]];
                    if (j >= c)
                        f[i][j][state[a]] += f[i - 1][j - c][state[b]];
                        // ä¹Ÿå¯ä»¥å†™æˆ f[i][j][a] += f[i - 1][j - c][b]ï¼Œ å› ä¸ºä¸‹æ ‡å”¯ä¸€ 
                }

    cout << f[n + 1][m][0] << endl;
    return 0;
}
```

## 6. æ ‘å½¢DP

### 6.1 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š

> **é¢˜ç›®**

Ural å¤§å­¦æœ‰ $N$ åèŒå‘˜ï¼Œç¼–å·ä¸º $1âˆ¼N$ã€‚

ä»–ä»¬çš„å…³ç³»å°±åƒä¸€æ£µä»¥æ ¡é•¿ä¸ºæ ¹çš„æ ‘ï¼Œçˆ¶èŠ‚ç‚¹å°±æ˜¯å­èŠ‚ç‚¹çš„ç›´æ¥ä¸Šå¸ã€‚

æ¯ä¸ªèŒå‘˜æœ‰ä¸€ä¸ªå¿«ä¹æŒ‡æ•°ï¼Œç”¨æ•´æ•° $H_i$ ç»™å‡ºï¼Œå…¶ä¸­ $1â‰¤iâ‰¤N$ã€‚

ç°åœ¨è¦å¬å¼€ä¸€åœºå‘¨å¹´åº†å®´ä¼šï¼Œä¸è¿‡ï¼Œæ²¡æœ‰èŒå‘˜æ„¿æ„å’Œç›´æ¥ä¸Šå¸ä¸€èµ·å‚ä¼šã€‚

åœ¨æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å‰æä¸‹ï¼Œä¸»åŠæ–¹å¸Œæœ›é‚€è¯·ä¸€éƒ¨åˆ†èŒå‘˜å‚ä¼šï¼Œä½¿å¾—æ‰€æœ‰å‚ä¼šèŒå‘˜çš„å¿«ä¹æŒ‡æ•°æ€»å’Œæœ€å¤§ï¼Œæ±‚è¿™ä¸ªæœ€å¤§å€¼ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œä¸€ä¸ªæ•´æ•° $N$ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œç¬¬ $i$ è¡Œè¡¨ç¤º $i$ å·èŒå‘˜çš„å¿«ä¹æŒ‡æ•° $H_i$ã€‚

æ¥ä¸‹æ¥ $Nâˆ’1$ è¡Œï¼Œæ¯è¡Œè¾“å…¥ä¸€å¯¹æ•´æ•° $L,K$ï¼Œè¡¨ç¤º $K$ æ˜¯ $L$ çš„ç›´æ¥ä¸Šå¸ã€‚ï¼ˆæ³¨æ„ä¸€ä¸‹ï¼Œåä¸€ä¸ªæ•°æ˜¯å‰ä¸€ä¸ªæ•°çš„**çˆ¶èŠ‚ç‚¹**ï¼Œä¸è¦æåï¼‰ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºæœ€å¤§çš„å¿«ä¹æŒ‡æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤6000$,
$âˆ’128â‰¤H_iâ‰¤127$

> **è§£æ**

**çŠ¶æ€è¡¨ç¤º**ï¼š

- $f[u][0]$ è¡¨ç¤ºæ‰€æœ‰ä»ä»¥ $u$ ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰æ‹©ï¼Œå¹¶ä¸”**ä¸é€‰** $u$ è¿™ä¸ªç‚¹çš„æ–¹æ¡ˆçš„å¿«ä¹æŒ‡æ•°æœ€å¤§å€¼
- $f[u][1]$ è¡¨ç¤ºæ‰€æœ‰ä»ä»¥ $u$ ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰æ‹©ï¼Œå¹¶ä¸”**é€‰æ‹©** $u$ è¿™ä¸ªç‚¹çš„æ–¹æ¡ˆçš„å¿«ä¹æŒ‡æ•°æœ€å¤§å€¼

**çŠ¶æ€è®¡ç®—**ï¼š
$$
f[u][0] = \sum_{i \in \text{sons}} \max(f[i][1], f[i][0])
$$

$$
f[u][1] = happy[u] + \sum_{i \in \text{sons}}f[i][0]
$$

ä½¿ç”¨ç”±çˆ¶èŠ‚ç‚¹æŒ‡å‘å„ä¸ªå­èŠ‚ç‚¹çš„æœ‰å‘å›¾è¡¨ç¤ºè¿™æ£µæ ‘ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ã€‚å¿«ä¹æŒ‡æ•°æœ€å¤§å€¼å³ä¸º $\max(f[u][0], f[u][1])$

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 6010;
int n; // n ä¸ªèŒå‘˜
int h[N], e[N], ne[N], idx;
// h[i] æ˜¯ä»¥ç»“ç‚¹ i ä¸ºèµ·ç‚¹çš„ç¬¬ä¸€æ¡è¾¹çš„ç¼–å·ï¼Œåˆå§‹åŒ–å…¨ä¸º -1 
// e[i]æ˜¯ i è¿™æ¡è¾¹çš„ç»ˆç‚¹çš„ç»“ç‚¹ç¼–å·
// ne[i] æ˜¯ä¸ i è¿™æ¡è¾¹åŒèµ·ç‚¹çš„ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·
// idx æ˜¯å½“å‰è¾¹çš„ç´¢å¼•ï¼ˆåºå·ï¼‰
int happy[N]; // æ¯ä¸ªèŒå·¥çš„å¿«ä¹æŒ‡æ•° 
int f[N][2]; // çŠ¶æ€è¡¨ç¤º 
bool has_fa[N]; // åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰çˆ¶èŠ‚ç‚¹ 
void add(int a, int b) // åˆ›å»ºé‚»æ¥è¡¨ï¼Œç”± a æŒ‡å‘ b
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;
}
void dfs(int u)
{
    f[u][1] = happy[u];
    for (int i = h[u]; ~i; i = ne[i]) // éå† u çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚~i å’Œ i != -1 æ„ä¹‰ç›¸åŒ 
    {
        int j = e[i];
        dfs(j);
        // çŠ¶æ€è½¬ç§»å…¬å¼ 
        f[u][1] += f[j][0];
        f[u][0] += max(f[j][0], f[j][1]);
    }
}
int main()
{
    cin >> n;
    for (int i = 1; i <= n; i ++) cin >> happy[i];
    memset(h, -1, sizeof(h));
    for (int i = 0; i < n - 1; i ++)
    {
        int a, b;
        cin >> a >> b; // a ä¸ºå­èŠ‚ç‚¹ï¼Œb ä¸ºçˆ¶èŠ‚ç‚¹ 
        add(b, a); // çˆ¶èŠ‚ç‚¹æŒ‡å‘å­èŠ‚ç‚¹çš„æœ‰å‘å›¾ 
        has_fa[a] = true; // è¡¨ç¤º a æœ‰çˆ¶èŠ‚ç‚¹ 
    }
    int root = 1;
    while (has_fa[root]) root ++; // æ‰¾å‡ºæ ¹èŠ‚ç‚¹ç¼–å· root 
    dfs(root);
    cout << max(f[root][0], f[root][1]) << endl;
    return 0;
}
```

## 7. è®°å¿†åŒ–æœç´¢

### 7.1 æ»‘é›ª

> **é¢˜ç›®**

ç»™å®šä¸€ä¸ª $R$ è¡Œ $C$ åˆ—çš„çŸ©é˜µï¼Œè¡¨ç¤ºä¸€ä¸ªçŸ©å½¢ç½‘æ ¼æ»‘é›ªåœºã€‚

çŸ©é˜µä¸­ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„ç‚¹è¡¨ç¤ºæ»‘é›ªåœºçš„ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—åŒºåŸŸçš„é«˜åº¦ã€‚

ä¸€ä¸ªäººä»æ»‘é›ªåœºä¸­çš„æŸä¸ªåŒºåŸŸå†…å‡ºå‘ï¼Œæ¯æ¬¡å¯ä»¥å‘ä¸Šä¸‹å·¦å³ä»»æ„ä¸€ä¸ªæ–¹å‘æ»‘åŠ¨ä¸€ä¸ªå•ä½è·ç¦»ã€‚

å½“ç„¶ï¼Œä¸€ä¸ªäººèƒ½å¤Ÿæ»‘åŠ¨åˆ°æŸç›¸é‚»åŒºåŸŸçš„å‰ææ˜¯è¯¥åŒºåŸŸçš„é«˜åº¦ä½äºè‡ªå·±ç›®å‰æ‰€åœ¨åŒºåŸŸçš„é«˜åº¦ã€‚

ä¸‹é¢ç»™å‡ºä¸€ä¸ªçŸ©é˜µä½œä¸ºä¾‹å­ï¼š

```
 1  2  3  4 5
16 17 18 19 6
15 24 25 20 7
14 23 22 21 8
13 12 11 10 9
```

åœ¨ç»™å®šçŸ©é˜µä¸­ï¼Œä¸€æ¡å¯è¡Œçš„æ»‘è¡Œè½¨è¿¹ä¸º $24âˆ’17âˆ’2âˆ’1$ã€‚

åœ¨ç»™å®šçŸ©é˜µä¸­ï¼Œæœ€é•¿çš„æ»‘è¡Œè½¨è¿¹ä¸º $25âˆ’24âˆ’23âˆ’â€¦âˆ’3âˆ’2âˆ’1$ï¼Œæ²¿é€”å…±ç»è¿‡ $25$ ä¸ªåŒºåŸŸã€‚

ç°åœ¨ç»™å®šä½ ä¸€ä¸ªäºŒç»´çŸ©é˜µè¡¨ç¤ºæ»‘é›ªåœºå„åŒºåŸŸçš„é«˜åº¦ï¼Œè¯·ä½ æ‰¾å‡ºåœ¨è¯¥æ»‘é›ªåœºä¸­èƒ½å¤Ÿå®Œæˆçš„æœ€é•¿æ»‘é›ªè½¨è¿¹ï¼Œå¹¶è¾“å‡ºå…¶é•¿åº¦(å¯ç»è¿‡æœ€å¤§åŒºåŸŸæ•°)ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $R$ å’Œ $C$ã€‚

æ¥ä¸‹æ¥ $R$ è¡Œï¼Œæ¯è¡ŒåŒ…å« $C$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®Œæ•´çš„äºŒç»´çŸ©é˜µã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¯å®Œæˆçš„æœ€é•¿æ»‘é›ªé•¿åº¦ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤R,Câ‰¤300$,

$0â‰¤çŸ©é˜µä¸­æ•´æ•°â‰¤10000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
5 5
1 2 3 4 5
16 17 18 19 6
15 24 25 20 7
14 23 22 21 8
13 12 11 10 9
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
25
```

> **è§£æ**

**è®°å¿†åŒ–æœç´¢** æ€è·¯ï¼š**dp + dfs**ï¼Œåœ¨æœç´¢åŸºç¡€ä¸Šï¼Œç”¨ä¸€å¼ è¡¨æŠŠæœç´¢è¿‡çš„èŠ‚ç‚¹å­˜èµ·æ¥ã€‚éœ€è¦ç”¨æ—¶ç›´æ¥è®¿é—®è¡¨ï¼Œå®ç°**å‰ªæ**çš„æ•ˆæœã€‚

åœ¨æœ¬é¢˜ä¸­ï¼Œåˆ¤æ–­å½“å‰ä½ç½®çš„ `f[x][y]` æ˜¯å¦å·²è¢«è®¡ç®—è¿‡ï¼Œå¦‚æœè®¡ç®—è¿‡ï¼Œåˆ™ä¸è®¡ç®—ï¼Œç›´æ¥è¿”å› `f[x][y]`ã€‚

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 310;
int n, m; // ç½‘æ ¼æ»‘é›ªåœºçš„è¡Œå’Œåˆ—
int g[N][N]; // æ»‘é›ªåœºå„ä¸ªä½ç½®çš„é«˜åº¦ 
int f[N][N]; // f[i][j] è¡¨ç¤ºä»ç‚¹ (i,j) å¼€å§‹çš„æœ€é•¿æ»‘é›ªè·ç¦»ã€‚åˆå§‹åŒ–ä¸º -1 
int dx[4] = {-1, 0, 1, 0}, dy[4] = {0, 1, 0, -1}; // ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ 
int dp(int x, int y) // è®°å¿†åŒ–æœç´¢ï¼Œ dp æˆ– dfs 
{
    int &v = f[x][y]; // å°æŠ€å·§ï¼šæŠŠ f[x][y] ç®€åŒ–æˆäº† v ï¼Œå¦‚æœ v å‘ç”Ÿå˜åŒ–ï¼Œ f[x][y] ä¹Ÿä¼šéšä¹‹å˜åŒ–
    if (v != -1) return v; // å¦‚æœå·²ç»è®¿é—®è¿‡äº†ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç­”æ¡ˆ
    v = 1; // è‹¥æœªè®¿é—®è¿‡ï¼Œå…ˆå°†æœ€é•¿è·ç¦»åˆå§‹åŒ–ä¸º 1 
    for (int i = 0; i < 4; i ++)
    {
        int nx = x + dx[i], ny = y + dy[i];
        if (nx >= 1 && nx <= n && ny >= 1 && ny <= m && g[x][y] > g[nx][ny]) // æ»¡è¶³:ä¸è¶Šç•Œï¼Œå¯æ»‘è¡Œ 
            v = max(v, dp(nx, ny) + 1);
    }
    return v;
}
int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i ++)
    {
    	for (int j = 1; j <= m; j ++)
    	{
    		cin >> g[i][j];
		}
	}     
    memset(f, -1, sizeof(f));
    int res = 0; // æœ€é•¿æ»‘é›ªè·ç¦» 
    for (int i = 1; i <= n; i ++) // éå†æ¯ä¸ªç‚¹ 
    {
    	for (int j = 1; j <= m; j ++)
    	{
    		res = max(res, dp(i, j));
		}
	}
	cout << res << endl;
    return 0;
}
```

# è´ªå¿ƒ

## 1. åŒºé—´é—®é¢˜

### 1.1 åŒºé—´é€‰ç‚¹

> **é¢˜ç›®**

ç»™å®š $N$ ä¸ªé—­åŒºé—´ $[a_i,b_i]$ï¼Œè¯·ä½ åœ¨æ•°è½´ä¸Šé€‰æ‹©å°½é‡å°‘çš„ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªåŒºé—´å†…è‡³å°‘åŒ…å«ä¸€ä¸ªé€‰å‡ºçš„ç‚¹ã€‚

è¾“å‡ºé€‰æ‹©çš„ç‚¹çš„æœ€å°æ•°é‡ã€‚

ä½äºåŒºé—´ç«¯ç‚¹ä¸Šçš„ç‚¹ä¹Ÿç®—ä½œåŒºé—´å†…ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºåŒºé—´æ•°ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $a_i,b_i$ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€éœ€çš„ç‚¹çš„æœ€å°æ•°é‡ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5,$
$âˆ’10^9â‰¤a_iâ‰¤b_iâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
-1 1
2 4
3 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

- å°†æ¯ä¸ªåŒºé—´æŒ‰**å³ç«¯ç‚¹**ä»å°åˆ°å¤§æ’åº
- ä»å‰å¾€åä¾æ¬¡æšä¸¾æ¯ä¸ªåŒºé—´
  - å¦‚æœå½“å‰åŒºé—´ä¸­å·²ç»åŒ…å«ç‚¹ï¼Œåˆ™ç›´æ¥è·³è¿‡
  - å¦åˆ™ï¼Œé€‰æ‹©å½“å‰åŒºé—´çš„**å³ç«¯ç‚¹**

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 100010;
int n;
struct Range
{
    int l, r;
}range[N];
bool cmp(Range a, Range b)
{
	return a.r < b.r;
}
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++)
	{
		cin >> range[i].l >> range[i].r;
	}
    sort(range, range + n, cmp);
    int res = 0, ed = -2e9;
    for (int i = 0; i < n; i ++)
        if (range[i].l > ed) // è‹¥è¯¥åŒºé—´å·¦ç«¯ç‚¹éƒ½å¤§äºé€‰ä¸­çš„ç‚¹ï¼Œåˆ™é€‰ä¸­çš„ç‚¹æ— æ³•è¦†ç›–è¯¥åŒºé—´ï¼Œåˆ™ä»¥è¯¥åŒºé—´çš„å³ç«¯ç‚¹ä½œä¸ºæ–°çš„é€‰ä¸­çš„ç‚¹
        {
            res ++; // æ‰€éœ€è¦çš„ç‚¹å¢åŠ ä¸€ä¸ª
            ed = range[i].r;
        }
    cout << res << endl;
    return 0;
}
```

### 1.2 æœ€å¤§ä¸ç›¸äº¤åŒºé—´æ•°é‡

> **é¢˜ç›®**

ç»™å®š $N$ ä¸ªé—­åŒºé—´ $[a_i,b_i]$ï¼Œè¯·ä½ åœ¨æ•°è½´ä¸Šé€‰æ‹©è‹¥å¹²åŒºé—´ï¼Œä½¿å¾—é€‰ä¸­çš„åŒºé—´ä¹‹é—´äº’ä¸ç›¸äº¤ï¼ˆåŒ…æ‹¬ç«¯ç‚¹ï¼‰ã€‚

è¾“å‡ºå¯é€‰å–åŒºé—´çš„æœ€å¤§æ•°é‡ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºåŒºé—´æ•°ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $a_i,b_i$ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¯é€‰å–åŒºé—´çš„æœ€å¤§æ•°é‡ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5,$
$âˆ’10^9â‰¤aiâ‰¤biâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
-1 1
2 4
3 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

- å°†æ¯ä¸ªåŒºé—´æŒ‰**å³ç«¯ç‚¹**ä»å°åˆ°å¤§æ’åº
- ä»å‰å¾€åä¾æ¬¡æšä¸¾æ¯ä¸ªåŒºé—´
  - å¦‚æœè¯¥åŒºé—´å’Œä¸Šä¸€ä¸ªé€‰çš„åŒºé—´æœ‰é‡åˆï¼Œåˆ™è·³è¿‡
  - å¦‚æœå’Œä¸Šä¸€ä¸ªé€‰çš„åŒºé—´æ²¡æœ‰é‡åˆï¼Œåˆ™é€‰å–è¯¥åŒºé—´

> **ä»£ç æ¨¡æ¿**

```c++
// ä»£ç åŒ1.1 åŒºé—´é€‰ç‚¹
#include<bits/stdc++.h> 
using namespace std;
const int N = 100010;
int n;
struct Range
{
    int l, r;
}range[N];
bool cmp(Range a, Range b)
{
	return a.r < b.r;
}
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++)
	{
		cin >> range[i].l >> range[i].r;
	}
    sort(range, range + n, cmp);
    int res = 0, ed = -2e9;
    for (int i = 0; i < n; i ++)
        if (range[i].l > ed) // è¯¥åŒºé—´å’Œä¸Šä¸€ä¸ªé€‰çš„åŒºé—´æ²¡æœ‰é‡åˆ
        {
            res ++; // åˆ™ä¸ºä¸€ä¸ªæ–°çš„åŒºé—´
            ed = range[i].r;
        }
    cout << res << endl;
    return 0;
}
```

### 1.3 åŒºé—´åˆ†ç»„

> **é¢˜ç›®**

ç»™å®š $N$ ä¸ªé—­åŒºé—´ $[a_i,b_i]$ï¼Œè¯·ä½ å°†è¿™äº›åŒºé—´åˆ†æˆè‹¥å¹²ç»„ï¼Œä½¿å¾—æ¯ç»„å†…éƒ¨çš„åŒºé—´ä¸¤ä¸¤ä¹‹é—´ï¼ˆåŒ…æ‹¬ç«¯ç‚¹ï¼‰æ²¡æœ‰äº¤é›†ï¼Œå¹¶ä½¿å¾—ç»„æ•°å°½å¯èƒ½å°ã€‚

è¾“å‡ºæœ€å°ç»„æ•°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºåŒºé—´æ•°ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $a_i,b_i$ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°ç»„æ•°ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5,$
$âˆ’10^9â‰¤a_iâ‰¤b_iâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
-1 1
2 4
3 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

- å°†æ‰€æœ‰åŒºé—´æŒ‰ç…§**å·¦ç«¯ç‚¹**ä»å°åˆ°å¤§æ’åº

- ä»å‰å¾€åå¤„ç†æ¯ä¸ªåŒºé—´

  - åˆ¤æ–­èƒ½å¦å°†å…¶æ”¾å…¥æŸä¸ªç°æœ‰çš„ç»„ï¼ˆåŒºé—´ç»„ï¼‰ä¸­ï¼ˆæ ¹æ®**æ–°åŒºé—´çš„å·¦ç«¯ç‚¹**å’Œ**å³ç«¯ç‚¹æœ€å°çš„ç»„çš„æœ€å³ç«¯ç‚¹ï¼ˆå³ä¸ºæœ€å°ç»„çš„æœ€å³ç«¯ç‚¹ï¼‰**åˆ¤æ–­ï¼‰
    $$
    range[i].l > Group_{min}r_{max} \quad èƒ½æ”¾è¿›ç°æœ‰çš„ç»„ \\
    range[i].l â‰¤ Group_{min}r_{max} \quad ä¸èƒ½æ”¾è¿›ç°æœ‰çš„ç»„
    $$

    - å¦‚æœä¸å­˜åœ¨èƒ½æ”¾è¿›çš„ç»„ï¼Œåˆ™å¼€æ–°çš„ç»„ï¼Œç„¶åå°†å…¶æ”¾è¿›å»
    - å¦‚æœå­˜åœ¨è¿™æ ·çš„ç»„ï¼Œå°†å…¶æ”¾è¿›å»ï¼Œå¹¶æ›´æ–°å½“å‰ç»„çš„ $max\_r$

```basic
/*-----------------------.
| â€”â€”â€”â€”â€”â€”                 |	 åŒºé—´ 1
|         â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |	 åŒºé—´ 2
`-----------------------*/
                        â†‘
                 /*---------- --.
                 | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |	åŒºé—´ 3
                 `-------------*/
                  â†‘
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h> 
using namespace std;
const int N = 100010;
int n;
struct Range
{
    int l, r;
}range[N];
bool cmp(Range x, Range y) // æŒ‰ç…§åŒºé—´å·¦ç«¯ç‚¹ä»å°åˆ°å¤§æ’åº
{
	return x.l < y.l;
}
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++)
    {
        int l, r;
        cin >> l >> r;
        range[i] = {l, r};
    }
    sort(range, range + n, cmp);
    priority_queue<int, vector<int>, greater<int>> heap; // å®šä¹‰ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ï¼Œheap.top()ä¸ºé˜Ÿåˆ—é¡¶éƒ¨çš„å…ƒç´ ã€‚å› ä¸ºå®šä¹‰äº† greater<int>ï¼Œæ‰€ä»¥ heap.top() ä¸ºæœ€å°å€¼ï¼Œä»é¡¶éƒ¨åˆ°åº•éƒ¨å•è°ƒé€’å¢ 
    for (int i = 0; i < n; i ++)
    {
        Range temp = range[i];
        // heap ä¸­çš„å…ƒç´ ä¸ºå„ä¸ªç»„çš„å³ç«¯ç‚¹ï¼ŒæŒ‰ç…§ä»å°åˆ°å¤§æ’åº
        // heap.top() ä¸ºå‰ä¸€ä¸ªç»„çš„å³ç«¯ç‚¹æœ€å°å€¼ï¼Œtemp.l ä¸ºæ–°åŒºé—´çš„å·¦ç«¯ç‚¹ 
        if (heap.empty() || heap.top() >= temp.l) heap.push(temp.r); // å †ä¸ºç©ºæˆ–è€…ä¸èƒ½æ”¾è¿›ç»„é‡Œï¼Œåˆ™å¼€æ–°çš„ç»„ 
        else // å¯ä»¥æ”¾è¿›å‰ä¸€ä¸ªç»„ 
        {
            heap.pop(); // popä¸€ä¸ªï¼Œå†pushä¸€ä¸ªï¼Œæ—¢ä¿è¯ç»„çš„å³ç«¯ç‚¹å¾—ä»¥æ›´æ–°ï¼Œä¹Ÿä¿è¯äº†heapä¸­å…ƒç´ ä¸ªæ•°å³ä¸ºç»„çš„æ•°é‡ 
            heap.push(temp.r);
        }
    }
    cout << heap.size() << endl; // heapä¸­å…ƒç´ ä¸ªæ•°å³ä¸ºç»„çš„æ•°é‡
    return 0;
}
```

### 1.4 åŒºé—´è¦†ç›–

> **é¢˜ç›®**

ç»™å®š $N$ ä¸ªé—­åŒºé—´ $[a_i,b_i]$ ä»¥åŠä¸€ä¸ªçº¿æ®µåŒºé—´ $[s,t]$ï¼Œè¯·ä½ é€‰æ‹©å°½é‡å°‘çš„åŒºé—´ï¼Œå°†æŒ‡å®šçº¿æ®µåŒºé—´å®Œå…¨è¦†ç›–ã€‚

è¾“å‡ºæœ€å°‘åŒºé—´æ•°ï¼Œå¦‚æœæ— æ³•å®Œå…¨è¦†ç›–åˆ™è¾“å‡º $âˆ’1$ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $s$ å’Œ $t$ï¼Œè¡¨ç¤ºç»™å®šçº¿æ®µåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚

ç¬¬äºŒè¡ŒåŒ…å«æ•´æ•° $N$ï¼Œè¡¨ç¤ºç»™å®šåŒºé—´æ•°ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $a_i,b_i$ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€éœ€æœ€å°‘åŒºé—´æ•°ã€‚

å¦‚æœæ— è§£ï¼Œåˆ™è¾“å‡º $âˆ’1$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤10^5,$
$âˆ’10^9â‰¤a_iâ‰¤b_iâ‰¤10^9,$
$âˆ’10^9â‰¤sâ‰¤tâ‰¤10^9$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
1 5
3
-1 3
2 4
3 5
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

- å°†æ‰€æœ‰åŒºé—´æŒ‰**å·¦ç«¯ç‚¹**ä»å°åˆ°å¤§æ’åº
- ä»å‰å¾€åä¾æ¬¡æšä¸¾æ¯ä¸ªåŒºé—´ï¼Œåœ¨**æ‰€æœ‰**èƒ½è¦†ç›– `start` çš„åŒºé—´ä¸­ï¼Œé€‰æ‹©**å³ç«¯ç‚¹æœ€å¤§**çš„åŒºé—´ï¼Œç„¶åå°† `start` æ›´æ–°æˆå³ç«¯ç‚¹çš„æœ€å¤§å€¼

```basic
    |------------------------|
    â†‘start                   â†‘end
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
		â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
			â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
```

> **ä»£ç æ¨¡æ¿**

```c++
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n;
struct Range
{
    int l, r;
}range[N];
bool cmp(Range x, Range y)
{
	return x.l < y.l;
}
int main()
{
    int st, ed;
    cin >> st >> ed;
    cin >> n;
    for (int i = 0; i < n; i ++ )
    {
        int l, r;
        cin >> l >> r;
        range[i] = {l, r};
    }
    sort(range, range + n, cmp); // å·¦ç«¯ç‚¹ä»å°åˆ°å¤§æ’åº 
    int res = 0; // æ‰€éœ€è¦çš„æœ€å°‘åŒºé—´æ•° 
    bool success = false; // æˆåŠŸè¦†ç›–ä¸å¦ 
    for (int i = 0; i < n; i ++)
    {
        int j = i, r = -2e9;
        while (j < n && range[j].l <= st) // j < n æ˜¯é˜²æ­¢è¶Šç•Œï¼›åé¢æ˜¯å½“å‰åŒºé—´å·¦ç«¯ç‚¹å°äºç­‰äº start 
        { // ç¬¦åˆä¸Šè¿°è¦æ±‚çš„ï¼Œå…¨éƒ¨éå†ä¸€é 
            r = max(r, range[j].r); // é€‰æ‹©å³ç«¯ç‚¹æœ€å¤§çš„åŒºé—´ 
            j ++ ; // j æŒ‡é’ˆåç§»ä¸€ä½ 
        }
        if (r < st) // æ‰€æœ‰åŒºé—´éƒ½æ— æ³•è¦†ç›– st çš„æƒ…å†µ 
        {
            res = -1;
            break;
        }
        res ++ ; // æ‰€éœ€è¦çš„åŒºé—´æ•° ++ 
        if (r >= ed) // ç›®æ ‡çº¿æ®µåŒºé—´å·²ç»å…¨éƒ¨è¢«è¦†ç›– 
        {
            success = true;
            break;
        }
        st = r; // æ›´æ–° start ä¸ºå³ç«¯ç‚¹æœ€å¤§å€¼ 
        i = j - 1; // [0,j - 1]å·åŒºé—´éƒ½éå†ç»“æŸäº†ï¼Œä¸‹ä¸€ä¸ªéœ€è¦éå† j å·åŒºé—´ã€‚ä½†æ˜¯å¤–å±‚ for å¾ªç¯é©¬ä¸Šè¿˜è¦æŠŠ i ++ï¼Œæ‰€ä»¥ i éœ€è¦èµ‹å€¼ä¸º j - 1
    }
    if (!success) res = -1;
    cout << res << endl;
    return 0;
}
```

## 2. Huffmanæ ‘

### 2.1 åˆå¹¶æœå­

> **é¢˜ç›®**

åœ¨ä¸€ä¸ªæœå›­é‡Œï¼Œè¾¾è¾¾å·²ç»å°†æ‰€æœ‰çš„æœå­æ‰“äº†ä¸‹æ¥ï¼Œè€Œä¸”æŒ‰æœå­çš„ä¸åŒç§ç±»åˆ†æˆäº†ä¸åŒçš„å †ã€‚

è¾¾è¾¾å†³å®šæŠŠæ‰€æœ‰çš„æœå­åˆæˆä¸€å †ã€‚

æ¯ä¸€æ¬¡åˆå¹¶ï¼Œè¾¾è¾¾å¯ä»¥æŠŠä¸¤å †æœå­åˆå¹¶åˆ°ä¸€èµ·ï¼Œæ¶ˆè€—çš„ä½“åŠ›ç­‰äºä¸¤å †æœå­çš„é‡é‡ä¹‹å’Œã€‚

å¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„æœå­ç»è¿‡ $nâˆ’1$ æ¬¡åˆå¹¶ä¹‹åï¼Œå°±åªå‰©ä¸‹ä¸€å †äº†ã€‚

è¾¾è¾¾åœ¨åˆå¹¶æœå­æ—¶æ€»å…±æ¶ˆè€—çš„ä½“åŠ›ç­‰äºæ¯æ¬¡åˆå¹¶æ‰€è€—ä½“åŠ›ä¹‹å’Œã€‚

å› ä¸ºè¿˜è¦èŠ±å¤§åŠ›æ°”æŠŠè¿™äº›æœå­æ¬å›å®¶ï¼Œæ‰€ä»¥è¾¾è¾¾åœ¨åˆå¹¶æœå­æ—¶è¦å°½å¯èƒ½åœ°èŠ‚çœä½“åŠ›ã€‚

å‡å®šæ¯ä¸ªæœå­é‡é‡éƒ½ä¸º $1$ï¼Œå¹¶ä¸”å·²çŸ¥æœå­çš„ç§ç±»æ•°å’Œæ¯ç§æœå­çš„æ•°ç›®ï¼Œä½ çš„ä»»åŠ¡æ˜¯è®¾è®¡å‡ºåˆå¹¶çš„æ¬¡åºæ–¹æ¡ˆï¼Œä½¿è¾¾è¾¾è€—è´¹çš„ä½“åŠ›æœ€å°‘ï¼Œå¹¶è¾“å‡ºè¿™ä¸ªæœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚

ä¾‹å¦‚æœ‰ $3$ ç§æœå­ï¼Œæ•°ç›®ä¾æ¬¡ä¸º $1ï¼Œ2ï¼Œ9$ã€‚

å¯ä»¥å…ˆå°† $1ã€2$ å †åˆå¹¶ï¼Œæ–°å †æ•°ç›®ä¸º $3$ï¼Œè€—è´¹ä½“åŠ›ä¸º $3$ã€‚

æ¥ç€ï¼Œå°†æ–°å †ä¸åŸå…ˆçš„ç¬¬ä¸‰å †åˆå¹¶ï¼Œåˆå¾—åˆ°æ–°çš„å †ï¼Œæ•°ç›®ä¸º $12$ï¼Œè€—è´¹ä½“åŠ›ä¸º $12$ã€‚

æ‰€ä»¥è¾¾è¾¾æ€»å…±è€—è´¹ä½“åŠ›$=3+12=15$ã€‚

å¯ä»¥è¯æ˜ $15$ ä¸ºæœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚

**è¾“å…¥æ ¼å¼**

è¾“å…¥åŒ…æ‹¬ä¸¤è¡Œï¼Œç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•° $n$ï¼Œè¡¨ç¤ºæœå­çš„ç§ç±»æ•°ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•°ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼Œç¬¬ $i$ ä¸ªæ•´æ•° $a_i$ æ˜¯ç¬¬ $i$ ç§æœå­çš„æ•°ç›®ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºåŒ…æ‹¬ä¸€è¡Œï¼Œè¿™ä¸€è¡ŒåªåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€å°çš„ä½“åŠ›è€—è´¹å€¼ã€‚

è¾“å…¥æ•°æ®ä¿è¯è¿™ä¸ªå€¼å°äº $2^{31}$ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤nâ‰¤10000,$
$1â‰¤a_iâ‰¤20000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3 
1 2 9 
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
15
```

> **è§£æ**

**ç®—æ³•æ€æƒ³**ï¼šè´ªå¿ƒç®—æ³•ï¼Œå“ˆå¤«æ›¼æ ‘

**ä½¿ç”¨çš„æ•°æ®ç»“æ„**ï¼šå°æ ¹å †

ç»™å®šNä¸ªæƒå€¼ä½œä¸ºNä¸ªå¶å­ç»“ç‚¹ï¼Œæ„é€ ä¸€æ£µäºŒå‰æ ‘ï¼Œè‹¥è¯¥æ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦è¾¾åˆ°æœ€å°ï¼Œç§°è¿™æ ·çš„äºŒå‰æ ‘ä¸ºæœ€ä¼˜äºŒå‰æ ‘ï¼Œä¹Ÿç§°ä¸º**å“ˆå¤«æ›¼æ ‘**(Huffman Tree)ã€‚å“ˆå¤«æ›¼æ ‘æ˜¯å¸¦æƒè·¯å¾„é•¿åº¦æœ€çŸ­çš„æ ‘ï¼Œæƒå€¼è¾ƒå¤§çš„ç»“ç‚¹ç¦»æ ¹è¾ƒè¿‘ã€‚æ„é€ è¿‡ç¨‹å¦‚ä¸‹ï¼š

- åˆå§‹åŒ–ï¼šå°†å­—ç¬¦åŠå…¶é¢‘ç‡ä½œä¸ºèŠ‚ç‚¹æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ã€‚
- æ„å»ºæ ‘ï¼šé‡å¤å–å‡ºä¸¤ä¸ªé¢‘ç‡æœ€å°èŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹ï¼ˆé¢‘ç‡ä¸ºä¸¤è€…ä¹‹å’Œï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸ºæ–°èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œå†å°†æ–°èŠ‚ç‚¹æ”¾å›é˜Ÿåˆ—ï¼Œç›´è‡³åªå‰©ä¸€ä¸ªèŠ‚ç‚¹ã€‚
- ç”Ÿæˆç¼–ç ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå·¦å­èŠ‚ç‚¹åˆ†é…â€œ0â€ï¼Œå³å­èŠ‚ç‚¹åˆ†é…â€œ1â€ï¼Œå¶å­èŠ‚ç‚¹çš„è·¯å¾„åºåˆ—å³ä¸ºå­—ç¬¦ç¼–ç ã€‚

```mermaid
graph TB
1((1))---21((8))---31((3))---41((1))
21--- n((5))
31--- n1((2))
1((21))---22((13))---n2((6))
22---32((7))
```

> **ä»£ç æ¨¡æ¿**

```cpp
#include<bits/stdc++.h>
using namespace std;
int main()
{
    int n;
    cin >> n;
    // ä½¿ç”¨å°æ ¹å †ç»´æŠ¤æ‰€æœ‰æœå­ï¼Œæ¯æ¬¡å¼¹å‡ºå †é¡¶çš„ä¸¤å †æœå­ï¼Œå¹¶å°†å…¶åˆå¹¶ï¼Œåˆå¹¶ä¹‹åå°†ä¸¤å †é‡é‡ä¹‹å’Œå†æ¬¡æ’å…¥å°æ ¹å †ä¸­
    priority_queue<int, vector<int>, greater<int>> heap;
    while (n --)
    {
        int x;
        cin >> x;
        heap.push(x);
    }
    int res = 0;
    while (heap.size() > 1) // åªæœ‰åˆå¹¶æˆä¸€å †åï¼Œheap.size() æ‰ == 1ã€‚å¦åˆ™ç»§ç»­åˆå¹¶ 
    {
        int a = heap.top(); heap.pop();
        int b = heap.top(); heap.pop();
        res += a + b;
        heap.push(a + b); // å°†åˆå¹¶åçš„æ–°å…ƒç´ åŠ å…¥å“ˆå¤«æ›¼æ ‘ 
    }
    cout << res << endl;
    return 0;
}
```

## 3. ç»å¯¹å€¼ä¸ç­‰å¼

### 3.1 è´§ä»“é€‰å€

> **é¢˜ç›®**

åœ¨ä¸€æ¡æ•°è½´ä¸Šæœ‰ $N$ å®¶å•†åº—ï¼Œå®ƒä»¬çš„åæ ‡åˆ†åˆ«ä¸º $A_1âˆ¼A_N$ã€‚

ç°åœ¨éœ€è¦åœ¨æ•°è½´ä¸Šå»ºç«‹ä¸€å®¶è´§ä»“ï¼Œæ¯å¤©æ¸…æ™¨ï¼Œä»è´§ä»“åˆ°æ¯å®¶å•†åº—éƒ½è¦è¿é€ä¸€è½¦å•†å“ã€‚

ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæ±‚æŠŠè´§ä»“å»ºåœ¨ä½•å¤„ï¼Œå¯ä»¥ä½¿å¾—è´§ä»“åˆ°æ¯å®¶å•†åº—çš„è·ç¦»ä¹‹å’Œæœ€å°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $N$ã€‚

ç¬¬äºŒè¡Œ $N$ ä¸ªæ•´æ•° $A_1âˆ¼A_N$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè·ç¦»ä¹‹å’Œçš„æœ€å°å€¼ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤100000,$
$0â‰¤A_iâ‰¤40000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
4
6 2 9 1
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
12
```

> **è§£æ**

$|x-a|+|x-b|â‰¥|a-b|$
$$
|a_1-x|+|a_2-x|+â€¦+|a_n-x| \\
=(|a_1-x|+|a_n-x|)+(|a_2-x|+|a_{n-1}-x|)+â€¦ \\
â‰¥|a_n-a_1|+|a_{n-1}-a_2|+â€¦ \qquad å½“ä¸”ä»…å½“xä½äºæœ€ä¸­é—´çš„ä¸¤ä¸ªåŒºé—´å†…æ—¶,ç­‰å·æˆç«‹
$$

- è‹¥ $n$ ä¸ºå¥‡æ•°ï¼Œåˆ™ $x$ å’Œä¸­ä½æ•° $a[\frac{n}{2}]$ é‡åˆå³å¯
- è‹¥ $n$ ä¸ºå¶æ•°ï¼Œåˆ™ $x$ ä½äº $[a[\frac{n}{2}-1],a[\frac{n}{2}]]$ ä¹‹é—´ä»»ä¸€ä½ç½®å³å¯

è¿™é‡Œæ–¹ä¾¿èµ·è§ï¼Œéƒ½å– $a[\frac{n}{2}]$

> **ä»£ç æ¨¡æ¿**

```cpp
#include<bits/stdc++.h>
using namespace std;
const int N = 100010;
int n;
int a[N];
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++) cin >> a[i];
    sort(a, a + n);
    int res = 0;
    for (int i = 0; i < n; i ++) res += abs(a[i] - a[n >> 1]);
    cout << res << endl;
    return 0;
}
```

## 4. æ¨å…¬å¼

### 4.1 è€æ‚æŠ€çš„ç‰›

> **é¢˜ç›®**

å†œæ°‘çº¦ç¿°çš„ $N$ å¤´å¥¶ç‰›ï¼ˆç¼–å·ä¸º $1..N$ï¼‰è®¡åˆ’é€ƒè·‘å¹¶åŠ å…¥é©¬æˆå›¢ï¼Œä¸ºæ­¤å®ƒä»¬å†³å®šç»ƒä¹ è¡¨æ¼”æ‚æŠ€ã€‚

å¥¶ç‰›ä»¬ä¸æ˜¯éå¸¸æœ‰åˆ›æ„ï¼Œåªæå‡ºäº†ä¸€ä¸ªæ‚æŠ€è¡¨æ¼”ï¼š

å ç½—æ±‰ï¼Œè¡¨æ¼”æ—¶ï¼Œå¥¶ç‰›ä»¬ç«™åœ¨å½¼æ­¤çš„èº«ä¸Šï¼Œå½¢æˆä¸€ä¸ªé«˜é«˜çš„å‚ç›´å †å ã€‚

å¥¶ç‰›ä»¬æ­£åœ¨è¯•å›¾æ‰¾åˆ°è‡ªå·±åœ¨è¿™ä¸ªå †å ä¸­åº”è¯¥æ‰€å¤„çš„ä½ç½®é¡ºåºã€‚

è¿™ $N$ å¤´å¥¶ç‰›ä¸­çš„æ¯ä¸€å¤´éƒ½æœ‰ç€è‡ªå·±çš„é‡é‡ $W_i$ ä»¥åŠè‡ªå·±çš„å¼ºå£®ç¨‹åº¦ $S_i$ã€‚

ä¸€å¤´ç‰›æ”¯æ’‘ä¸ä½çš„å¯èƒ½æ€§å–å†³äºå®ƒå¤´ä¸Šæ‰€æœ‰ç‰›çš„æ€»é‡é‡ï¼ˆä¸åŒ…æ‹¬å®ƒè‡ªå·±ï¼‰å‡å»å®ƒçš„èº«ä½“å¼ºå£®ç¨‹åº¦çš„å€¼ï¼Œç°åœ¨ç§°è¯¥æ•°å€¼ä¸ºé£é™©å€¼ï¼Œé£é™©å€¼è¶Šå¤§ï¼Œè¿™åªç‰›æ’‘ä¸ä½çš„å¯èƒ½æ€§è¶Šé«˜ã€‚

æ‚¨çš„ä»»åŠ¡æ˜¯ç¡®å®šå¥¶ç‰›çš„æ’åºï¼Œä½¿å¾—æ‰€æœ‰å¥¶ç‰›çš„é£é™©å€¼ä¸­çš„æœ€å¤§å€¼å°½å¯èƒ½çš„å°ã€‚

**è¾“å…¥æ ¼å¼**

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $N$ï¼Œè¡¨ç¤ºå¥¶ç‰›æ•°é‡ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºç‰›çš„é‡é‡å’Œå¼ºå£®ç¨‹åº¦ï¼Œç¬¬ $i$ è¡Œè¡¨ç¤ºç¬¬ $i$ å¤´ç‰›çš„é‡é‡ $W_i$ ä»¥åŠå®ƒçš„å¼ºå£®ç¨‹åº¦ $S_i$ã€‚

**è¾“å‡ºæ ¼å¼**

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å¤§é£é™©å€¼çš„æœ€å°å¯èƒ½å€¼ã€‚

**æ•°æ®èŒƒå›´**

$1â‰¤Nâ‰¤50000,$
$1â‰¤Wiâ‰¤10,000,$
$1â‰¤Siâ‰¤1,000,000,000$

**è¾“å…¥æ ·ä¾‹ï¼š**

```
3
10 3
2 5
3 3
```

**è¾“å‡ºæ ·ä¾‹ï¼š**

```
2
```

> **è§£æ**

è®¾æ¯åªå¥¶ç‰›é‡é‡ä¸º $w$ ï¼Œèƒ½åŠ›ä¸º $s$ ï¼Œå‡è®¾å ç½—æ±‰å¦‚ä¸‹ï¼ˆ$w_1,s_1$ åœ¨æœ€**ä¸Š**é¢ï¼‰ï¼š
$$
w_1,s_1 \\
w_2,s_2 \\
â€¦ \\
w_i,s_i \\
w_{i+1},s_{i+1} \\
â€¦ \\
w_n,s_n
$$
ç°åœ¨äº¤æ¢ç¬¬ $i$ å¤´å¥¶ç‰›å’Œç¬¬ $i+1$ å¤´å¥¶ç‰›çš„é¡ºåºï¼Œäº¤æ¢å‰åè¿™ä¸¤å¤´å¥¶ç‰›çš„**é£é™©å€¼**å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

|               | äº¤æ¢å‰              | äº¤æ¢å                      |
| ------------- | ------------------- | --------------------------- |
| ç¬¬ $i$ å¤´ç‰›   | $w_1+â€¦+w_{i-1}-s_i$ | $w_1+â€¦+w_{i-1}+w_{i+1}-s_i$ |
| ç¬¬ $i+1$ å¤´ç‰› | $w_1+â€¦+w_i-s_{i+1}$ | $w_1+â€¦+w_{i-1}-s_{i+1}$     |

**åªæ¯”è¾ƒå¤§å°**çš„è¯ï¼Œä¸Šè¿°è¡¨æ ¼ä¸­ä¸¤å¤´å¥¶ç‰›çš„é£é™©å€¼å¯ä»¥ç®€åŒ–ä¸ºï¼š

|               | äº¤æ¢å‰        | äº¤æ¢å        |
| ------------- | ------------- | ------------- |
| ç¬¬ $i$ å¤´ç‰›   | $-s_i$        | $w_{i+1}-s_i$ |
| ç¬¬ $i+1$ å¤´ç‰› | $w_i-s_{i+1}$ | $-s_{i+1}$    |

æ‰€ä»¥æ¯”è¾ƒ $w_i-s_{i+1}$ å’Œ $w_{i+1}-s_i$ ä¸¤ä¸ªå€¼çš„å¤§å°å…³ç³»ï¼š

è‹¥ $w_i-s_{i+1}ï¼w_{i+1}-s_i$ ï¼Œåˆ™**è¡¨ç¤ºäº¤æ¢å‰é£é™©æœ€å¤§å€¼æ›´å¤§ï¼Œæ‰€ä»¥éœ€è¦äº¤æ¢**ã€‚ç§»é¡¹å¾—ï¼š

$w_i+s_iï¼w_{i+1}+s_{i+1}$

æ•´ç†å¾—ï¼š
$$
w_i+s_iï¼w_{i+1}+s_{i+1} \quad äº¤æ¢å‰é£é™©æœ€å¤§å€¼æ›´å¤§ï¼Œæ‰€ä»¥éœ€è¦äº¤æ¢ \\
w_i+s_iï¼œw_{i+1}+s_{i+1} \quad äº¤æ¢åé£é™©æœ€å¤§å€¼æ›´å¤§ï¼Œæ‰€ä»¥ä¸éœ€è¦äº¤æ¢
$$
æ¯æ¬¡å¿…è¦çš„äº¤æ¢åï¼Œå±€éƒ¨çš„é£é™©æœ€å¤§å€¼éƒ½ä¼šæ›´å°ï¼Œä¹Ÿå°±æ˜¯æ›´ä¼˜ã€‚

**æ‰€ä»¥è¦æŒ‰ç…§æ¯å¤´å¥¶ç‰›çš„ $w+s$ ä»å°åˆ°å¤§æ’åº**ã€‚ä»ç½—æ±‰é¡¶å‘ä¸‹æ–¹ä¾æ¬¡éå†ï¼Œå¯»æ‰¾é£é™©å€¼çš„æœ€å¤§å€¼

> **ä»£ç æ¨¡æ¿**

```cpp
#include<bits/stdc++.h>
using namespace std;
typedef pair<int, int> PII;
const int N = 50010;
int n;
PII cow[N];
int main()
{
    cin >> n;
    for (int i = 0; i < n; i ++)
    {
        int w, s;
        cin >> w >> s;
        cow[i] = {w + s, w};
    }
    sort(cow, cow + n); // é»˜è®¤æŒ‰ç…§ cow[i].first ä»å°åˆ°å¤§æ’åº 
    int res = -2e9, sum = 0;
    for (int i = 0; i < n; i ++) // è‡ªç½—æ±‰é¡¶å‘ä¸‹éå† 
    {
        int s = cow[i].first - cow[i].second; // å¾—åˆ°æ¯å¤´å¥¶ç‰›çš„ s ï¼Œå³èƒ½åŠ›å€¼ 
		int w = cow[i].second;
        res = max(res, sum - s); // res ä¸ºæœ€å¤§é£é™©ï¼Œsum ä¸ºå¤´é¡¶æ‰€æœ‰å¥¶ç‰›çš„é‡é‡ï¼Œs ä¸ºèƒ½åŠ›å€¼ 
        sum += w;
    }
    cout << res << endl;
    return 0;
}
```

# STL

<img src="/figs/STL" alt="STL" style="zoom: 67%;" />

------

